<!DOCTYPE html>
<html prefix="og: http://ogp.me/ns# article: http://ogp.me/ns/article# " lang="en">
<head>
<meta charset="utf-8">
<meta name="description" content="Thomas House's Personal Website">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Thomas House's Personal Website</title>
<link href="../assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<link href="https://fonts.googleapis.com/css?family=Playfair+Display:700,900" rel="stylesheet">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="alternate" type="application/rss+xml" title="RSS" hreflang="en" href="../rss.xml">
<link rel="canonical" href="https://personalpages.manchester.ac.uk/staff/thomas.house/blog/">
<link rel="next" href="index-1.html" type="text/html">
<!--[if lt IE 9]><script src="../assets/js/html5.js"></script><![endif]--><script>window.twttr = (function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0],
    t = window.twttr || {};
  if (d.getElementById(id)) return t;
  js = d.createElement(s);
  js.id = id;
  js.src = "https://platform.twitter.com/widgets.js";
  fjs.parentNode.insertBefore(js, fjs);
 
  t._e = [];
  t.ready = function(f) {
    t._e.push(f);
  };
 
  return t;
}(document, "script", "twitter-wjs"));</script><style type="text/css"> @import "assets/css/custom.css"; </style>
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Header and menu bar -->
<div class="container">
      <header class="blog-header py-3"><div class="row nbb-header align-items-center">
          <div class="col-md-3 col-xs-2 col-sm-2" style="width: auto;">
            <button class="navbar-toggler navbar-light bg-light nbb-navbar-toggler" type="button" data-toggle="collapse" data-target=".bs-nav-collapsible" aria-controls="bs-navbar" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse bs-nav-collapsible bootblog4-search-form-holder">
                
            </div>
        </div>
          <div class="col-md-6 col-xs-10 col-sm-10 bootblog4-brand" style="width: auto;">
            <a class="navbar-brand blog-header-logo text-dark" href="../">

            <span id="blog-title">Thomas House's Personal Website</span>
        </a>
          </div>
            <div class="col-md-3 justify-content-end align-items-center bs-nav-collapsible collapse flex-collapse bootblog4-right-nav">
            <nav class="navbar navbar-light bg-white"><ul class="navbar-nav bootblog4-right-nav"></ul></nav>
</div>
    </div>
</header><nav class="navbar navbar-expand-md navbar-light bg-white static-top"><div class="collapse navbar-collapse bs-nav-collapsible" id="bs-navbar">
            <ul class="navbar-nav nav-fill d-flex w-100">
<li class="nav-item">
<a href="../about.html" class="nav-link">About</a>
                </li>
<li class="nav-item">
<a href="#" class="nav-link">Blog</a>
                </li>
<li class="nav-item">
<a href="../research.html" class="nav-link">Research</a>
                </li>
<li class="nav-item">
<a href="../teaching.html" class="nav-link">Teaching</a>
                </li>
<li class="nav-item">
<a href="../publications.html" class="nav-link">Publications</a>
                </li>
<li class="nav-item">
<a href="../group.html" class="nav-link">Group</a>

                
            </li>
</ul>
</div>
<!-- /.navbar-collapse -->
</nav>
</div>

<div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        
        
        
    
        

    
        
    <div class="postindex">
            <article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="../posts/treatment-of-boundaries-in-markov-chain-monte-carlo.html" class="u-url">Treatment of boundaries in Markov chain Monte Carlo</a></h1>
                <div class="metadata">
                    <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                        Thomas House
                    </span></p>
            <p class="dateline">
            <a href="../posts/treatment-of-boundaries-in-markov-chain-monte-carlo.html" rel="bookmark">
            <time class="published dt-published" datetime="2025-04-14T14:35:10Z" itemprop="datePublished" title="2025-04-14 14:35">2025-04-14 14:35</time></a>
            </p>
                </div>
            </header><div class="e-content entry-content">
                    <p>I have been asked by multiple students what to do with MCMC at
boundaries, in particular how to treat proposals that lie outside the
support of the target. Suppose we have a vector of parameters
<span class="math">\(\theta\)</span> and want to target a density (proportional to)
<span class="math">\(\pi(\theta)\)</span> using a proposal distribution
<span class="math">\(q(\theta'|\theta)\)</span>. In MCMC, we seek to define a Markov process
in discrete time, <span class="math">\((\theta_0, \theta_1, \ldots, \theta_N)\)</span> that
has stationary distribution with density <span class="math">\(\pi\)</span>. In the Metropolis
Hastings scheme, the law of such a process is that at step <span class="math">\(m\)</span>,
when the state of the system is <span class="math">\(\theta_m\)</span>, we pick a proposed new
value <span class="math">\(\tilde{\theta}\)</span> with density <span class="math">\(q(\cdot | \theta_m)\)</span>,
then</p>
<div class="math">
\begin{equation*}
\mathrm{Pr}(\theta_{m+1} = \tilde{\theta}) = \mathrm{max}\left( 1, \frac{\pi(\tilde{\theta}) q(\theta | \tilde{\theta})}{\pi(\theta)q(\tilde{\theta} | \theta)}\right) \, , \quad
\mathrm{Pr}(\theta_{m+1} = \theta_{m}) = 1 - \mathrm{Pr}(\theta_{m+1} = \tilde{\theta}) \, . \quad (\dagger)
\end{equation*}
</div>
<p>The natural question is, if there is somewhere we can
propose but not move (e.g.¬†because the likelihood is not defined) then
what should be done?</p>
<p>Let us consider one parameter, a probability <span class="math">\(p\in [0,1]\)</span>, with a
density <span class="math">\(\pi(p) = \mathrm{Uniform}(0,1)\)</span>, and a proposal
distribution <span class="math">\(q(p'|p) = \mathcal{N}(p'|p,1)\)</span>. We will run chains
of length <span class="math">\(N=10^7\)</span>.</p>
<div class="cell docutils container">
<div class="code"><pre class="code r"><a id="rest_code_5cdefb3b281e470a8e64fce75b634db6-1" name="rest_code_5cdefb3b281e470a8e64fce75b634db6-1" href="../posts/treatment-of-boundaries-in-markov-chain-monte-carlo.html#rest_code_5cdefb3b281e470a8e64fce75b634db6-1"></a><span class="n">N</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="m">10000000</span>
<a id="rest_code_5cdefb3b281e470a8e64fce75b634db6-2" name="rest_code_5cdefb3b281e470a8e64fce75b634db6-2" href="../posts/treatment-of-boundaries-in-markov-chain-monte-carlo.html#rest_code_5cdefb3b281e470a8e64fce75b634db6-2"></a><span class="n">output</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">matrix</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="n">ncol</span><span class="o">=</span><span class="m">2</span><span class="p">,</span><span class="n">nrow</span><span class="o">=</span><span class="n">N</span><span class="p">)</span>
<a id="rest_code_5cdefb3b281e470a8e64fce75b634db6-3" name="rest_code_5cdefb3b281e470a8e64fce75b634db6-3" href="../posts/treatment-of-boundaries-in-markov-chain-monte-carlo.html#rest_code_5cdefb3b281e470a8e64fce75b634db6-3"></a><span class="n">sig</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="m">1</span>
</pre></div>
</div>
<p>In the first chain (‚ÄòKeep picking‚Äô) we will keep proposing new values
until one is within the allowed region</p>
<div class="cell docutils container">
<div class="code"><pre class="code r"><a id="rest_code_bdddc0f2423e4d6bb739ea37db2f9d62-1" name="rest_code_bdddc0f2423e4d6bb739ea37db2f9d62-1" href="../posts/treatment-of-boundaries-in-markov-chain-monte-carlo.html#rest_code_bdddc0f2423e4d6bb739ea37db2f9d62-1"></a><span class="n">p</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="m">0.5</span>
<a id="rest_code_bdddc0f2423e4d6bb739ea37db2f9d62-2" name="rest_code_bdddc0f2423e4d6bb739ea37db2f9d62-2" href="../posts/treatment-of-boundaries-in-markov-chain-monte-carlo.html#rest_code_bdddc0f2423e4d6bb739ea37db2f9d62-2"></a><span class="kr">for</span><span class="p">(</span><span class="n">m</span><span class="w"> </span><span class="kr">in</span><span class="w"> </span><span class="m">1</span><span class="o">:</span><span class="n">N</span><span class="p">){</span>
<a id="rest_code_bdddc0f2423e4d6bb739ea37db2f9d62-3" name="rest_code_bdddc0f2423e4d6bb739ea37db2f9d62-3" href="../posts/treatment-of-boundaries-in-markov-chain-monte-carlo.html#rest_code_bdddc0f2423e4d6bb739ea37db2f9d62-3"></a><span class="w">  </span><span class="n">pprop</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="m">-1</span>
<a id="rest_code_bdddc0f2423e4d6bb739ea37db2f9d62-4" name="rest_code_bdddc0f2423e4d6bb739ea37db2f9d62-4" href="../posts/treatment-of-boundaries-in-markov-chain-monte-carlo.html#rest_code_bdddc0f2423e4d6bb739ea37db2f9d62-4"></a><span class="w">  </span><span class="kr">while</span><span class="p">((</span><span class="n">pprop</span><span class="o">&lt;</span><span class="m">0</span><span class="p">)</span><span class="o">|</span><span class="p">(</span><span class="n">pprop</span><span class="o">&gt;</span><span class="m">1</span><span class="p">)){</span>
<a id="rest_code_bdddc0f2423e4d6bb739ea37db2f9d62-5" name="rest_code_bdddc0f2423e4d6bb739ea37db2f9d62-5" href="../posts/treatment-of-boundaries-in-markov-chain-monte-carlo.html#rest_code_bdddc0f2423e4d6bb739ea37db2f9d62-5"></a><span class="w">    </span><span class="n">pprop</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nf">rnorm</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="n">mean</span><span class="o">=</span><span class="m">0</span><span class="p">,</span><span class="n">sd</span><span class="o">=</span><span class="n">sig</span><span class="p">)</span>
<a id="rest_code_bdddc0f2423e4d6bb739ea37db2f9d62-6" name="rest_code_bdddc0f2423e4d6bb739ea37db2f9d62-6" href="../posts/treatment-of-boundaries-in-markov-chain-monte-carlo.html#rest_code_bdddc0f2423e4d6bb739ea37db2f9d62-6"></a><span class="w">  </span><span class="p">}</span>
<a id="rest_code_bdddc0f2423e4d6bb739ea37db2f9d62-7" name="rest_code_bdddc0f2423e4d6bb739ea37db2f9d62-7" href="../posts/treatment-of-boundaries-in-markov-chain-monte-carlo.html#rest_code_bdddc0f2423e4d6bb739ea37db2f9d62-7"></a><span class="w">  </span><span class="n">p</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">pprop</span>
<a id="rest_code_bdddc0f2423e4d6bb739ea37db2f9d62-8" name="rest_code_bdddc0f2423e4d6bb739ea37db2f9d62-8" href="../posts/treatment-of-boundaries-in-markov-chain-monte-carlo.html#rest_code_bdddc0f2423e4d6bb739ea37db2f9d62-8"></a><span class="w">  </span><span class="n">output</span><span class="p">[</span><span class="n">m</span><span class="p">,</span><span class="m">1</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">p</span>
<a id="rest_code_bdddc0f2423e4d6bb739ea37db2f9d62-9" name="rest_code_bdddc0f2423e4d6bb739ea37db2f9d62-9" href="../posts/treatment-of-boundaries-in-markov-chain-monte-carlo.html#rest_code_bdddc0f2423e4d6bb739ea37db2f9d62-9"></a><span class="p">}</span>
</pre></div>
</div>
<p>In the second chain (‚ÄòReject‚Äô) we will reject proposals outside the
region and remain at the position the proposal was made.</p>
<div class="cell docutils container">
<div class="code"><pre class="code r"><a id="rest_code_e629a30745e444e7adea67974bf7d431-1" name="rest_code_e629a30745e444e7adea67974bf7d431-1" href="../posts/treatment-of-boundaries-in-markov-chain-monte-carlo.html#rest_code_e629a30745e444e7adea67974bf7d431-1"></a><span class="n">p</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="m">0.5</span>
<a id="rest_code_e629a30745e444e7adea67974bf7d431-2" name="rest_code_e629a30745e444e7adea67974bf7d431-2" href="../posts/treatment-of-boundaries-in-markov-chain-monte-carlo.html#rest_code_e629a30745e444e7adea67974bf7d431-2"></a><span class="kr">for</span><span class="p">(</span><span class="n">m</span><span class="w"> </span><span class="kr">in</span><span class="w"> </span><span class="m">1</span><span class="o">:</span><span class="n">N</span><span class="p">){</span>
<a id="rest_code_e629a30745e444e7adea67974bf7d431-3" name="rest_code_e629a30745e444e7adea67974bf7d431-3" href="../posts/treatment-of-boundaries-in-markov-chain-monte-carlo.html#rest_code_e629a30745e444e7adea67974bf7d431-3"></a><span class="w">  </span><span class="n">pprop</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nf">rnorm</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="n">mean</span><span class="o">=</span><span class="m">0</span><span class="p">,</span><span class="n">sd</span><span class="o">=</span><span class="n">sig</span><span class="p">)</span>
<a id="rest_code_e629a30745e444e7adea67974bf7d431-4" name="rest_code_e629a30745e444e7adea67974bf7d431-4" href="../posts/treatment-of-boundaries-in-markov-chain-monte-carlo.html#rest_code_e629a30745e444e7adea67974bf7d431-4"></a><span class="w">  </span><span class="kr">if</span><span class="p">((</span><span class="n">pprop</span><span class="o">&gt;=</span><span class="m">0</span><span class="p">)</span><span class="o">&amp;</span><span class="p">(</span><span class="n">pprop</span><span class="o">&lt;=</span><span class="m">1</span><span class="p">)){</span>
<a id="rest_code_e629a30745e444e7adea67974bf7d431-5" name="rest_code_e629a30745e444e7adea67974bf7d431-5" href="../posts/treatment-of-boundaries-in-markov-chain-monte-carlo.html#rest_code_e629a30745e444e7adea67974bf7d431-5"></a><span class="w">    </span><span class="n">p</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">pprop</span>
<a id="rest_code_e629a30745e444e7adea67974bf7d431-6" name="rest_code_e629a30745e444e7adea67974bf7d431-6" href="../posts/treatment-of-boundaries-in-markov-chain-monte-carlo.html#rest_code_e629a30745e444e7adea67974bf7d431-6"></a><span class="w">  </span><span class="p">}</span>
<a id="rest_code_e629a30745e444e7adea67974bf7d431-7" name="rest_code_e629a30745e444e7adea67974bf7d431-7" href="../posts/treatment-of-boundaries-in-markov-chain-monte-carlo.html#rest_code_e629a30745e444e7adea67974bf7d431-7"></a><span class="w">  </span><span class="n">output</span><span class="p">[</span><span class="n">m</span><span class="p">,</span><span class="m">2</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">p</span>
<a id="rest_code_e629a30745e444e7adea67974bf7d431-8" name="rest_code_e629a30745e444e7adea67974bf7d431-8" href="../posts/treatment-of-boundaries-in-markov-chain-monte-carlo.html#rest_code_e629a30745e444e7adea67974bf7d431-8"></a><span class="p">}</span>
</pre></div>
</div>
<p>Now look at some plots</p>
<div class="cell docutils container">
<div class="code"><pre class="code r"><a id="rest_code_f50cf8942fdc48a9afcd3dce94d1847f-1" name="rest_code_f50cf8942fdc48a9afcd3dce94d1847f-1" href="../posts/treatment-of-boundaries-in-markov-chain-monte-carlo.html#rest_code_f50cf8942fdc48a9afcd3dce94d1847f-1"></a><span class="nf">hist</span><span class="p">(</span><span class="n">output</span><span class="p">[,</span><span class="m">1</span><span class="p">],</span><span class="w"> </span><span class="n">breaks</span><span class="o">=</span><span class="nf">seq</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">1</span><span class="p">,</span><span class="m">0.1</span><span class="p">),</span><span class="w"> </span><span class="n">freq</span><span class="o">=</span><span class="kc">FALSE</span><span class="p">,</span><span class="w"> </span><span class="n">ylim</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">1.2</span><span class="p">),</span>
<a id="rest_code_f50cf8942fdc48a9afcd3dce94d1847f-2" name="rest_code_f50cf8942fdc48a9afcd3dce94d1847f-2" href="../posts/treatment-of-boundaries-in-markov-chain-monte-carlo.html#rest_code_f50cf8942fdc48a9afcd3dce94d1847f-2"></a><span class="w">     </span><span class="n">xlab</span><span class="o">=</span><span class="s">'p'</span><span class="p">,</span><span class="w"> </span><span class="n">main</span><span class="o">=</span><span class="s">'Keep picking'</span><span class="p">)</span>
</pre></div>
<div class="cell-output-display docutils container">
<img alt="../unnamed-chunk-4-1.png" src="../unnamed-chunk-4-1.png" style="width: 672px;">
</div>
<div class="code"><pre class="code r"><a id="rest_code_7c084d1b0dbe47e48728a252d4d6d302-1" name="rest_code_7c084d1b0dbe47e48728a252d4d6d302-1" href="../posts/treatment-of-boundaries-in-markov-chain-monte-carlo.html#rest_code_7c084d1b0dbe47e48728a252d4d6d302-1"></a><span class="nf">hist</span><span class="p">(</span><span class="n">output</span><span class="p">[,</span><span class="m">2</span><span class="p">],</span><span class="w"> </span><span class="n">breaks</span><span class="o">=</span><span class="nf">seq</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">1</span><span class="p">,</span><span class="m">0.1</span><span class="p">),</span><span class="w"> </span><span class="n">freq</span><span class="o">=</span><span class="kc">FALSE</span><span class="p">,</span><span class="w"> </span><span class="n">ylim</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">1.2</span><span class="p">),</span>
<a id="rest_code_7c084d1b0dbe47e48728a252d4d6d302-2" name="rest_code_7c084d1b0dbe47e48728a252d4d6d302-2" href="../posts/treatment-of-boundaries-in-markov-chain-monte-carlo.html#rest_code_7c084d1b0dbe47e48728a252d4d6d302-2"></a><span class="w">     </span><span class="n">xlab</span><span class="o">=</span><span class="s">'p'</span><span class="p">,</span><span class="w"> </span><span class="n">main</span><span class="o">=</span><span class="s">'Reject'</span><span class="p">)</span>
</pre></div>
<div class="cell-output-display docutils container">
<img alt="../unnamed-chunk-4-2.png" src="../unnamed-chunk-4-2.png" style="width: 672px;">
</div>
<div class="code"><pre class="code r"><a id="rest_code_b9e83daeb0174c61a2d0ff2826a6ca00-1" name="rest_code_b9e83daeb0174c61a2d0ff2826a6ca00-1" href="../posts/treatment-of-boundaries-in-markov-chain-monte-carlo.html#rest_code_b9e83daeb0174c61a2d0ff2826a6ca00-1"></a><span class="nf">ts.plot</span><span class="p">(</span><span class="n">output</span><span class="p">[</span><span class="m">1</span><span class="o">:</span><span class="m">500</span><span class="p">,</span><span class="m">1</span><span class="p">],</span><span class="n">gpars</span><span class="o">=</span><span class="nf">list</span><span class="p">(</span><span class="n">xlab</span><span class="o">=</span><span class="s">"m"</span><span class="p">,</span><span class="w"> </span><span class="n">ylab</span><span class="o">=</span><span class="s">"p"</span><span class="p">))</span>
</pre></div>
<div class="cell-output-display docutils container">
<img alt="../unnamed-chunk-4-3.png" src="../unnamed-chunk-4-3.png" style="width: 672px;">
</div>
<div class="code"><pre class="code r"><a id="rest_code_ac6ad6391eb44c72afb88c7eabcf348a-1" name="rest_code_ac6ad6391eb44c72afb88c7eabcf348a-1" href="../posts/treatment-of-boundaries-in-markov-chain-monte-carlo.html#rest_code_ac6ad6391eb44c72afb88c7eabcf348a-1"></a><span class="nf">ts.plot</span><span class="p">(</span><span class="n">output</span><span class="p">[</span><span class="m">1</span><span class="o">:</span><span class="m">500</span><span class="p">,</span><span class="m">2</span><span class="p">],</span><span class="n">gpars</span><span class="o">=</span><span class="nf">list</span><span class="p">(</span><span class="n">xlab</span><span class="o">=</span><span class="s">"m"</span><span class="p">,</span><span class="w"> </span><span class="n">ylab</span><span class="o">=</span><span class="s">"p"</span><span class="p">))</span>
</pre></div>
<div class="cell-output-display docutils container">
<img alt="../unnamed-chunk-4-4.png" src="../unnamed-chunk-4-4.png" style="width: 672px;">
</div>
</div>
<p>What we see is that the first approach, the trace plot looks
superficially ‚Äòbetter‚Äô, but the output is biased. From the
Metropolis-Hastings algorith as specified in <span class="math">\((\dagger)\)</span> this is what we
would expect; mathematically, we can interpret the ‚ÄòReject‚Äô approach as
taking <span class="math">\(\pi(\theta&lt;0) = \pi(\theta&gt;1) = 0\)</span>, while the ‚ÄòKeep
picking‚Äô approach the proposal distribution effectively becomes a
truncated normal. Such a truncated normal could be evaluated as the
<span class="math">\(q(\cdot|\cdot)\)</span> in <span class="math">\((\dagger)\)</span>, and this might be a good algorithm,
but the na√Øve implementation introduces bias.</p>
                </div>
            </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="../posts/seasonality-and-immunity.html" class="u-url">Seasonality and Immunity</a></h1>
                <div class="metadata">
                    <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                        Thomas House
                    </span></p>
            <p class="dateline">
            <a href="../posts/seasonality-and-immunity.html" rel="bookmark">
            <time class="published dt-published" datetime="2021-08-18T18:33:04Z" itemprop="datePublished" title="2021-08-18 18:33">2021-08-18 18:33</time></a>
            </p>
                </div>
            </header><div class="e-content entry-content">
                    <p><strong>Note:</strong> This blogpost was conceptualised in mid-2021, and should be public
late in 2023. With the problems going on at ùïè (formerly Twitter), it's struck
me that putting any such content on a website that I control probably has its
advantages, so I hope to use this site more going forwards.</p>
<img alt="Spring being pushed, with displacement z from equilibrium" class="align-right" src="../spring.jpg" style="width: 240px;"><p>So let's start by considering a weight on a spring as pictured - this is going
to give us a physical 'model' of disease dynamics for an endemic infection. The
weight on the spring is a distance <span class="raw-html">\(z(t)\)</span> from the point at which
the system would be at rest. There are three forces acting on the weight:</p>
<ul class="simple">
<li><p>The spring pulls it towards equilibrium, to a first approximation,
proportionally to its spring constant giving a force contribution
<span class="raw-html">\(-k z\)</span>;</p></li>
<li><p>As the weight moves, friction dissipates kinetic energy giving a force
contribution <span class="raw-html">\(-\nu \dot{z}\)</span>;</p></li>
<li><p>A human is pushing at the weight giving a time-dependent force contribution
<span class="raw-html">\(\varphi(t)\)</span>.</p></li>
</ul>
<p>Now, dredging up our high-school physics we remember that Newton's equation is
<span class="raw-html">\(F = ma\)</span>. Noting that acceleration is the second derivative of
position so that <span class="raw-html">\(a = \ddot{z}\)</span> and combining the three force
contributions above we get <span class="raw-html">\[-kz - \nu \dot{z} + \varphi(t) = m
\ddot{z}\, .\]</span> Dredging still further, we might remember that momentum is
<span class="raw-html">\(p = m\dot{z}\)</span>, which gives us dynamics <span class="raw-html">\[\dot{z} =
\frac{1}{m} p \, , \qquad \dot{p} = -kz - \frac{\nu}{m} p + \varphi(t) \, .
\qquad \mathrm{(1)} \]</span></p>
<p>Next, let us consider an SIRS model with forcing, <span class="raw-html">\[\dot{S} = \omega
R - \beta(t) S I \, , \quad\ \dot{I} = \beta(t) S I - \gamma I \, , \quad
\dot{R} = \gamma I - \omega R \, .\]</span> This models a system where individuals move
from susceptible to infections upon contact with other infectious individuals,
then recover, and after that immunity wanes and they become susceptible again.
The rate <span class="raw-html">\(\beta(t)\)</span> depending on time is supposed to capture
different exogenous events: schools opening and closing; new vaccines; new
variants; policy changes; and all sorts of other complexity. If you want to
experiment with these equations numerically, check out <a class="reference external" href="https://github.com/thomasallanhouse/covid19-incidence/blob/main/bmj.ipynb">this Jupyter notebook</a>
that I make available on GitHub.</p>
<p>This set of equations does not have a general closed form, but we can look for
an approximate one using the Ansatz <span class="raw-html">\[S(t) = S_* + \epsilon x(t) \,
, \quad\ I(t) = I_* + \epsilon y(t) \, , \quad R(t) = N - S(t) - I(t) \, ,
\quad \beta(t) = \beta_* + \epsilon \phi(t) \, .\]</span> We want this to correspond
to a fixed point of the dynamical system when <span class="raw-html">\(\epsilon = 0\)</span>,
leading to the equations <span class="raw-html">\[0 = \omega (N - S_* - I_*) - \beta_* S_*
I_* \, , \qquad\ 0 = \beta_* S_* I_* - \gamma I_* \, .\]</span> These have a solution
when <span class="raw-html">\(S_* = N, I_* = 0\)</span> that is unstable if the disease can go endemic,
i.e. when <span class="raw-html">\(\mathcal{R}_0 = \beta_*/\gamma &gt; 1 \)</span>; the other fixed
point is when <span class="raw-html">\(S_* = 1/\mathcal{R}_0\)</span>, which I hope to blog
about later. The expression for the expected number of infectives
<span class="raw-html">\(I_*\)</span> at endemicity is more complex; feel free to derive it for
fun!  For our purposes here, we are interested in what we obtain at first order
in <span class="raw-html">\(\epsilon\)</span>, which gives us <span class="raw-html">\[\dot{x} = - \omega x -
\omega y - \beta_* x I_* - \beta_* S_* y - \phi S_* I_* +
\mathcal{O}(\epsilon^2)  \, , \qquad\ \dot{y} = \beta_* x I_* + \beta_* S_* y +
\phi S_* I_* - \gamma y  + \mathcal{O}(\epsilon^2) \, .  \qquad \mathrm{(2)}
\]</span></p>
<p>OK, so take a breath. Now, with a bit of work, we can write both equations (1)
and (2) (neglecting quadratic terms in <span class="raw-html">\(\epsilon\)</span>) above in the
form of a two-dimensional vector differential equation
<span class="raw-html">\[\dot{\mathbf{v}} = \boldsymbol{J} \mathbf{v} + \mathbf{F}(t) \, ,
\qquad \mathrm{(3)} \]</span> where <span class="raw-html">\(\mathbf{v}\)</span> is a vector containing
the dynamical variables - <span class="raw-html">\((z,p)\)</span> for the spring and
<span class="raw-html">\((x,y)\)</span> for the SIRS model - <span class="raw-html">\(\boldsymbol{J}\)</span> is a
matrix depending on rate constants, and <span class="raw-html">\(\mathbf{F}(t)\)</span> is a
vector function of time. Some readers will note that the details of the
versions of (3) derived from (1) and (2) are not quite the same, but also that
equation (3) takes the same structure under the linear transformation
<span class="raw-html">\[\tilde{\mathbf{v}} = \boldsymbol{T} \mathbf{v} \, ,\quad
\tilde{\boldsymbol{J}} = \boldsymbol{T}\boldsymbol{J}\boldsymbol{T}^{-1} \,
,\quad \tilde{\mathbf{F}} = \boldsymbol{T} \mathbf{F} \, . \]</span> They might also
have fun trying to work with (3) via matrix integrating factor, Eigensystem
analysis, or maybe Fourier transform.</p>
<p>So, that was quite fiddly (although not much beyond high-school level
mathematics apart from the last bit). But the TL;DR is this: imagine all the
complexity that you can generate by bouncing a weight up and down. If your taps
line up just right with the how the spring behaves, you can get regular
oscillations, but it's not difficult to make the weight jump irregularly all
over the place. And this is exactly what we can see with an endemic disease:
there's no guarantee that oscillatory behaviour will be regular or predictable.</p>
<p>Now, for many diseases that are better established, we do indeed see relatively
regular annual peaks, although predicting the exact timing and height of these
even for very well studied diseases like influenza is not currently possible.
But most experts think that the relative regularity of influenza compared to
COVID arises because the exogenous forces are mainly annual events like school
holidays, people moving in and outdoors with the weather, and maybe even a
direct bio-physical impact of the weather, with evolutionary events generally
having a less dramatic impact on disease transmission than they do for COVID.</p>
<p>Because evolution is hard to predict, it's not clear that COVID will become
more like influenza. Or even that it would be a good thing if it did. The
purpose of this post, however, was to help explain why its unpredictability is
at least somewhat predictable.</p>
                </div>
            </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="../posts/why-zero-is-so-hard.html" class="u-url">Why Zero is so Hard</a></h1>
                <div class="metadata">
                    <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                        Thomas House
                    </span></p>
            <p class="dateline">
            <a href="../posts/why-zero-is-so-hard.html" rel="bookmark">
            <time class="published dt-published" datetime="2020-08-10T21:18:21Z" itemprop="datePublished" title="2020-08-10 21:18">2020-08-10 21:18</time></a>
            </p>
                </div>
            </header><div class="e-content entry-content">
                    <p>The post on herd immunity on this blog discussed mitigation policies. Since
then, the world has moved on somewhat, and many people are talking about
long-term suppression of COVID-19, so how long might that take?</p>
<p>Suppose we have <span class="raw-html">\(N\)</span> current COVID infections, the reproduction
number is <span class="raw-html">\(R\)</span>, the duration of infection is <span class="raw-html">\(T\)</span> and
we want to know the time <span class="raw-html">\(t\)</span> until the probability that there are
zero cases is <span class="raw-html">\(p\)</span>.</p>
<p>If we model this as a Markovian birth-death chain, then the analytical result
for the time at which the given probability of extinction is reached is:
<span class="raw-html">\[t(p,N,R) = \frac{T}{R-1} \ln\left( \frac{p^{1/N} - 1}{R p^{1/N} - 1}\right) \; . \]</span></p>
<p>Results from this equation are shown in the Figure if we take 10 days from
infection to recovery; unfortunately, we need years with the reproduction number
less than one to get appreciable probabilities of of extinction. Of course, the
Markovian birth-death chain is too simple to be a realistic model of COVID. In
particular:</p>
<ul class="simple">
<li><p>More infection happens several days after infection than in the initial days,
introducing additional delays;</p></li>
<li><p>Some population subgroups may have an effective reproduction number above 1;</p></li>
<li><p>There will be imported cases from outside;</p></li>
<li><p>There is variability in individual susceptibility and infectiousness;</p></li>
<li><p>Contact patterns are complex and heterogeneous.</p></li>
</ul>
<p>These will influence the time to zero cases in different ways; but the 'inconvenient
truth' is that it takes an extremely long time to get to zero cases even if
<span class="raw-html">\(R\)</span> can be kept below one indefinitely.</p>
<figure style="width: 600px"><a class="reference external image-reference" href="../covext2.png"><img alt="Times until the a given probability of extinction" src="../covext2.png"></a>
<figcaption><p>Times until the a given probability of extinction as a function of the
initial number of cases and the reproduction number. Contour lines
correspond to 1, 2, 3, 5 and 10 years.</p>
</figcaption></figure>
</div>
            </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="../posts/modelling-herd-immunity.html" class="u-url">Modelling Herd Immunity</a></h1>
                <div class="metadata">
                    <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                        Thomas House
                    </span></p>
            <p class="dateline">
            <a href="../posts/modelling-herd-immunity.html" rel="bookmark">
            <time class="published dt-published" datetime="2020-03-14T09:54:38Z" itemprop="datePublished" title="2020-03-14 09:54">2020-03-14 09:54</time></a>
            </p>
                </div>
            </header><div class="e-content entry-content">
                    <p>The current coronavirus outbreak (COVID-19) has raised questions about herd
immunity, social distancing measures, and the relationship between these. In
particular, at time of writing the following Tweet has thousands of retweets
and likes.</p>
<p><span class="raw-html"><blockquote class="twitter-tweet">
<p lang="en" dir="ltr">‚ÄúWith the number of known <a href="https://twitter.com/hashtag/coronavirus?src=hash&amp;ref_src=twsrc%5Etfw">#coronavirus</a> cases today in South Korea, Italy, Iran, France, Spain and the US, Wuhan was already in lockdown.‚Äù<br><br>Read why every day we wait to make decisions is costlier that‚Äôs the previous:<a href="https://t.co/6hX74wiZgF">https://t.co/6hX74wiZgF</a></p>‚Äî Tomas Pueyo (@tomaspueyo) <a href="https://twitter.com/tomaspueyo/status/1237421094912397314?ref_src=twsrc%5Etfw">March 10, 2020</a>
</blockquote> <script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script></span></p>
<p>I think that this presents an incomplete picture of the policy considerations.</p>
<img alt="Before herd immunity" class="align-left" src="../Herd.png" style="width: 240px;"><img alt="After herd immunity" class="align-right" src="../Herd2.png" style="width: 240px;"><p>To see why, let us start by defining the most important concept in epidemic
modelling, the basic reproduction number <span class="raw-html">\(R_0\)</span>. This is equal to
the average number of infections caused by a case early in the epidemic, so that
for <span class="raw-html">\(R_0 = 3\)</span>, the early transmission tree might look something like
the cartoon on the left. This exhibits the exponential growth that is so worrying
at present. We have first one case, then three, then nine, then 27, then ...</p>
<p>Now suppose that immunity has been built up, either through vaccination or by
illness followed by recovery, so that two thirds of people are immune. This
means that each case will have three contacts that would have caused infection
in the absence of immunity, but on average two of these will be immune and so
the situation looks more like the cartoon on the right. We say that the
reproduction number is reduced from its basic value to <span class="raw-html">\(R_t = 1\)</span>.</p>
<p>While the individuals in the cartoon with a crossed out arrow pointing towards
them are literally immune, the people that they would have infected benefit
from <strong>herd immunity</strong>. They can be infected if exposed, but will not be. This
is particularly beneficial to the people who are particularly vulnerable to the
disease, who might die if they catch it. The general formula for herd immunity
is that when over <span class="raw-html">\((1 - (1/R_0))\times 100\%\)</span> of the population
is immune, then the epidemic will start to die out.</p>
<p>Now suppose we simulate a more realistic scenario. The Python code for this is
at the bottom of this post, and it is much simpler than the models that are
typically used to guide policy, but captures the basic phenomena of interest.
In particular, we suppose that we can reduce transmission through social
distancing measures like closing schools and workplaces, but that this is only
possible for three weeks. This represents the fact that the costs of not
educating children and not doing other activities can become quite large over
time, and in some cases can lead to levels death and illness that could exceed
those due to the unchecked epidemic. Running the epidemic model with these
interventions gives the following results for cases at a given moment and total
cases over time.</p>
<img alt="../output_5.png" src="../output_5.png"><p>It seems that the Tweet was right - look at the difference the early intervention
makes! But now let us zoom out of the graph; then the picture looks like the below.</p>
<img alt="../output_6_0.png" src="../output_6_0.png"><p>In fact, the later intervention dramatically reduces the burden on the healthcare
system, cutting in half the maximum numbers ill and potentially needing treatment
at any one time, and significantly reduces the final number infected, which the
earlier interventions fail to do.</p>
<p>The reason that this happens is that social distancing measures do not lead to herd
immunity, so once they are lifted the epidemic starts again. In the absence of a
vaccine, it is therefore meaningless to speak about whether a policy 'aims' to get
herd immunity or not, since every country in the world will reach herd immunity
unless it is able to implement social distancing for an indefinite period of time.</p>
<p>What mitigation policies should aim to do, therefore, is to reach herd immunity
with the minimal human cost. This will be extremely difficult, and at every
stage we will be dealing with large uncertainties. I would not want to be the
person who ultimately made the policy decisions. But to say that early
interventions are always better is incorrect.</p>
<div class="code"><pre class="code ipython3"><a id="rest_code_a60b412ba835495c84442a608a58c6ec-1" name="rest_code_a60b412ba835495c84442a608a58c6ec-1" href="../posts/modelling-herd-immunity.html#rest_code_a60b412ba835495c84442a608a58c6ec-1"></a><span class="c1"># Pull in libraries needed</span>
<a id="rest_code_a60b412ba835495c84442a608a58c6ec-2" name="rest_code_a60b412ba835495c84442a608a58c6ec-2" href="../posts/modelling-herd-immunity.html#rest_code_a60b412ba835495c84442a608a58c6ec-2"></a><span class="o">%</span><span class="k">matplotlib</span> inline
<a id="rest_code_a60b412ba835495c84442a608a58c6ec-3" name="rest_code_a60b412ba835495c84442a608a58c6ec-3" href="../posts/modelling-herd-immunity.html#rest_code_a60b412ba835495c84442a608a58c6ec-3"></a><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<a id="rest_code_a60b412ba835495c84442a608a58c6ec-4" name="rest_code_a60b412ba835495c84442a608a58c6ec-4" href="../posts/modelling-herd-immunity.html#rest_code_a60b412ba835495c84442a608a58c6ec-4"></a><span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">integrate</span>
<a id="rest_code_a60b412ba835495c84442a608a58c6ec-5" name="rest_code_a60b412ba835495c84442a608a58c6ec-5" href="../posts/modelling-herd-immunity.html#rest_code_a60b412ba835495c84442a608a58c6ec-5"></a><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</pre></div>
<div class="code"><pre class="code ipython3"><a id="rest_code_50ccf7005e66491dbad8d1af960e52e0-1" name="rest_code_50ccf7005e66491dbad8d1af960e52e0-1" href="../posts/modelling-herd-immunity.html#rest_code_50ccf7005e66491dbad8d1af960e52e0-1"></a><span class="c1"># Represent the basic dynamics</span>
<a id="rest_code_50ccf7005e66491dbad8d1af960e52e0-2" name="rest_code_50ccf7005e66491dbad8d1af960e52e0-2" href="../posts/modelling-herd-immunity.html#rest_code_50ccf7005e66491dbad8d1af960e52e0-2"></a><span class="k">def</span> <span class="nf">odefun</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">beta0</span><span class="p">,</span><span class="n">betat</span><span class="p">,</span><span class="n">t0</span><span class="p">,</span><span class="n">t1</span><span class="p">,</span><span class="n">sigma</span><span class="p">,</span><span class="n">gamma</span><span class="p">):</span>
<a id="rest_code_50ccf7005e66491dbad8d1af960e52e0-3" name="rest_code_50ccf7005e66491dbad8d1af960e52e0-3" href="../posts/modelling-herd-immunity.html#rest_code_50ccf7005e66491dbad8d1af960e52e0-3"></a>    <span class="n">dx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<a id="rest_code_50ccf7005e66491dbad8d1af960e52e0-4" name="rest_code_50ccf7005e66491dbad8d1af960e52e0-4" href="../posts/modelling-herd-immunity.html#rest_code_50ccf7005e66491dbad8d1af960e52e0-4"></a>    <span class="k">if</span> <span class="p">((</span><span class="n">t</span><span class="o">&gt;=</span><span class="n">t0</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">t</span><span class="o">&lt;=</span><span class="n">t1</span><span class="p">)):</span>
<a id="rest_code_50ccf7005e66491dbad8d1af960e52e0-5" name="rest_code_50ccf7005e66491dbad8d1af960e52e0-5" href="../posts/modelling-herd-immunity.html#rest_code_50ccf7005e66491dbad8d1af960e52e0-5"></a>        <span class="n">beta</span> <span class="o">=</span> <span class="n">betat</span>
<a id="rest_code_50ccf7005e66491dbad8d1af960e52e0-6" name="rest_code_50ccf7005e66491dbad8d1af960e52e0-6" href="../posts/modelling-herd-immunity.html#rest_code_50ccf7005e66491dbad8d1af960e52e0-6"></a>    <span class="k">else</span><span class="p">:</span>
<a id="rest_code_50ccf7005e66491dbad8d1af960e52e0-7" name="rest_code_50ccf7005e66491dbad8d1af960e52e0-7" href="../posts/modelling-herd-immunity.html#rest_code_50ccf7005e66491dbad8d1af960e52e0-7"></a>        <span class="n">beta</span> <span class="o">=</span> <span class="n">beta0</span>
<a id="rest_code_50ccf7005e66491dbad8d1af960e52e0-8" name="rest_code_50ccf7005e66491dbad8d1af960e52e0-8" href="../posts/modelling-herd-immunity.html#rest_code_50ccf7005e66491dbad8d1af960e52e0-8"></a>    <span class="n">dx</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">beta</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">+</span> <span class="n">x</span><span class="p">[</span><span class="mi">4</span><span class="p">])</span>
<a id="rest_code_50ccf7005e66491dbad8d1af960e52e0-9" name="rest_code_50ccf7005e66491dbad8d1af960e52e0-9" href="../posts/modelling-herd-immunity.html#rest_code_50ccf7005e66491dbad8d1af960e52e0-9"></a>    <span class="n">dx</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">beta</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">+</span> <span class="n">x</span><span class="p">[</span><span class="mi">4</span><span class="p">])</span> <span class="o">-</span> <span class="n">sigma</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<a id="rest_code_50ccf7005e66491dbad8d1af960e52e0-10" name="rest_code_50ccf7005e66491dbad8d1af960e52e0-10" href="../posts/modelling-herd-immunity.html#rest_code_50ccf7005e66491dbad8d1af960e52e0-10"></a>    <span class="n">dx</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">sigma</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">sigma</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
<a id="rest_code_50ccf7005e66491dbad8d1af960e52e0-11" name="rest_code_50ccf7005e66491dbad8d1af960e52e0-11" href="../posts/modelling-herd-immunity.html#rest_code_50ccf7005e66491dbad8d1af960e52e0-11"></a>    <span class="n">dx</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="n">sigma</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">-</span> <span class="n">gamma</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
<a id="rest_code_50ccf7005e66491dbad8d1af960e52e0-12" name="rest_code_50ccf7005e66491dbad8d1af960e52e0-12" href="../posts/modelling-herd-immunity.html#rest_code_50ccf7005e66491dbad8d1af960e52e0-12"></a>    <span class="n">dx</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="n">gamma</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">-</span> <span class="n">gamma</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span>
<a id="rest_code_50ccf7005e66491dbad8d1af960e52e0-13" name="rest_code_50ccf7005e66491dbad8d1af960e52e0-13" href="../posts/modelling-herd-immunity.html#rest_code_50ccf7005e66491dbad8d1af960e52e0-13"></a>    <span class="n">dx</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="n">gamma</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span>
<a id="rest_code_50ccf7005e66491dbad8d1af960e52e0-14" name="rest_code_50ccf7005e66491dbad8d1af960e52e0-14" href="../posts/modelling-herd-immunity.html#rest_code_50ccf7005e66491dbad8d1af960e52e0-14"></a>    <span class="k">return</span> <span class="n">dx</span>
</pre></div>
<div class="code"><pre class="code ipython3"><a id="rest_code_235f3c6356b64e44a3496d2d004cdec2-1" name="rest_code_235f3c6356b64e44a3496d2d004cdec2-1" href="../posts/modelling-herd-immunity.html#rest_code_235f3c6356b64e44a3496d2d004cdec2-1"></a><span class="c1"># Parameters of the model</span>
<a id="rest_code_235f3c6356b64e44a3496d2d004cdec2-2" name="rest_code_235f3c6356b64e44a3496d2d004cdec2-2" href="../posts/modelling-herd-immunity.html#rest_code_235f3c6356b64e44a3496d2d004cdec2-2"></a><span class="n">N</span> <span class="o">=</span> <span class="mf">6.7e7</span> <span class="c1"># Total population</span>
<a id="rest_code_235f3c6356b64e44a3496d2d004cdec2-3" name="rest_code_235f3c6356b64e44a3496d2d004cdec2-3" href="../posts/modelling-herd-immunity.html#rest_code_235f3c6356b64e44a3496d2d004cdec2-3"></a><span class="n">i0</span> <span class="o">=</span> <span class="mf">1e-4</span> <span class="c1"># 0.5*Proportion of the population infected on day 0</span>
<a id="rest_code_235f3c6356b64e44a3496d2d004cdec2-4" name="rest_code_235f3c6356b64e44a3496d2d004cdec2-4" href="../posts/modelling-herd-immunity.html#rest_code_235f3c6356b64e44a3496d2d004cdec2-4"></a><span class="n">tlast</span> <span class="o">=</span> <span class="mf">365.0</span> <span class="c1"># Consider a year</span>
<a id="rest_code_235f3c6356b64e44a3496d2d004cdec2-5" name="rest_code_235f3c6356b64e44a3496d2d004cdec2-5" href="../posts/modelling-herd-immunity.html#rest_code_235f3c6356b64e44a3496d2d004cdec2-5"></a><span class="n">latent_period</span> <span class="o">=</span> <span class="mf">5.0</span> <span class="c1"># Days between being infected and becoming infectious</span>
<a id="rest_code_235f3c6356b64e44a3496d2d004cdec2-6" name="rest_code_235f3c6356b64e44a3496d2d004cdec2-6" href="../posts/modelling-herd-immunity.html#rest_code_235f3c6356b64e44a3496d2d004cdec2-6"></a><span class="n">infectious_period</span> <span class="o">=</span> <span class="mf">7.0</span> <span class="c1"># Days infectious</span>
<a id="rest_code_235f3c6356b64e44a3496d2d004cdec2-7" name="rest_code_235f3c6356b64e44a3496d2d004cdec2-7" href="../posts/modelling-herd-immunity.html#rest_code_235f3c6356b64e44a3496d2d004cdec2-7"></a><span class="n">R0</span> <span class="o">=</span> <span class="mf">2.5</span> <span class="c1"># Basic reproduction number in the absence of interventions</span>
<a id="rest_code_235f3c6356b64e44a3496d2d004cdec2-8" name="rest_code_235f3c6356b64e44a3496d2d004cdec2-8" href="../posts/modelling-herd-immunity.html#rest_code_235f3c6356b64e44a3496d2d004cdec2-8"></a><span class="n">Rt</span> <span class="o">=</span> <span class="mf">0.75</span> <span class="c1"># Reproduction number in the presence of interventions</span>
<a id="rest_code_235f3c6356b64e44a3496d2d004cdec2-9" name="rest_code_235f3c6356b64e44a3496d2d004cdec2-9" href="../posts/modelling-herd-immunity.html#rest_code_235f3c6356b64e44a3496d2d004cdec2-9"></a><span class="n">tend</span> <span class="o">=</span> <span class="mf">21.0</span> <span class="c1"># Number of days of interventions</span>
</pre></div>
<div class="code"><pre class="code ipython3"><a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-1" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-1" href="../posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-1"></a><span class="n">beta0</span> <span class="o">=</span> <span class="n">R0</span> <span class="o">/</span> <span class="n">infectious_period</span>
<a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-2" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-2" href="../posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-2"></a><span class="n">betat</span> <span class="o">=</span> <span class="n">Rt</span> <span class="o">/</span> <span class="n">infectious_period</span>
<a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-3" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-3" href="../posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-3"></a><span class="n">sigma</span> <span class="o">=</span> <span class="mf">2.0</span> <span class="o">/</span> <span class="n">latent_period</span>
<a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-4" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-4" href="../posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-4"></a><span class="n">gamma</span> <span class="o">=</span> <span class="mf">2.0</span> <span class="o">/</span> <span class="n">infectious_period</span>
<a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-5" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-5" href="../posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-5"></a>
<a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-6" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-6" href="../posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-6"></a><span class="n">t0ran</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mi">100</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mf">52.5</span><span class="p">,</span> <span class="mi">65</span><span class="p">])</span>
<a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-7" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-7" href="../posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-7"></a>
<a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-8" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-8" href="../posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-8"></a><span class="k">def</span> <span class="nf">mylab</span><span class="p">(</span><span class="n">t</span><span class="p">):</span>
<a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-9" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-9" href="../posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-9"></a>    <span class="k">if</span> <span class="n">t</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
<a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-10" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-10" href="../posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-10"></a>        <span class="k">return</span> <span class="s2">"Start at "</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="o">+</span> <span class="s2">" days"</span>
<a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-11" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-11" href="../posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-11"></a>    <span class="k">else</span><span class="p">:</span>
<a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-12" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-12" href="../posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-12"></a>        <span class="k">return</span> <span class="s2">"Baseline"</span>
<a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-13" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-13" href="../posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-13"></a>
<a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-14" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-14" href="../posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-14"></a><span class="n">sol</span><span class="o">=</span><span class="p">[]</span>
<a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-15" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-15" href="../posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-15"></a><span class="k">for</span> <span class="n">tt</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">t0ran</span><span class="p">)):</span>
<a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-16" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-16" href="../posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-16"></a>    <span class="n">sol</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">integrate</span><span class="o">.</span><span class="n">solve_ivp</span><span class="p">(</span><span class="k">lambda</span> <span class="n">t</span><span class="p">,</span><span class="n">x</span><span class="p">:</span> <span class="n">odefun</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">beta0</span><span class="p">,</span><span class="n">betat</span><span class="p">,</span><span class="n">t0ran</span><span class="p">[</span><span class="n">tt</span><span class="p">],</span><span class="n">t0ran</span><span class="p">[</span><span class="n">tt</span><span class="p">]</span><span class="o">+</span><span class="n">tend</span><span class="p">,</span><span class="n">sigma</span><span class="p">,</span><span class="n">gamma</span><span class="p">),</span>
<a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-17" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-17" href="../posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-17"></a>                              <span class="p">(</span><span class="mf">0.0</span><span class="p">,</span><span class="n">tlast</span><span class="p">),</span>
<a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-18" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-18" href="../posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-18"></a>                              <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.0</span><span class="o">-</span><span class="mf">2.0</span><span class="o">*</span><span class="n">i0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="n">i0</span><span class="p">,</span> <span class="n">i0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]),</span>
<a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-19" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-19" href="../posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-19"></a>                              <span class="s1">'RK45'</span><span class="p">,</span>
<a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-20" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-20" href="../posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-20"></a>                              <span class="n">atol</span><span class="o">=</span><span class="mf">1e-8</span><span class="p">,</span>
<a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-21" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-21" href="../posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-21"></a>                              <span class="n">rtol</span><span class="o">=</span><span class="mf">1e-9</span><span class="p">))</span>
</pre></div>
<div class="code"><pre class="code ipython3"><a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-1" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-1" href="../posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-1"></a><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-2" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-2" href="../posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-2"></a><span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-3" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-3" href="../posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-3"></a><span class="k">for</span> <span class="n">tt</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">t0ran</span><span class="p">)):</span>
<a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-4" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-4" href="../posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-4"></a>    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">sol</span><span class="p">[</span><span class="n">tt</span><span class="p">]</span><span class="o">.</span><span class="n">t</span><span class="p">,</span><span class="n">N</span><span class="o">*</span><span class="p">(</span><span class="n">sol</span><span class="p">[</span><span class="n">tt</span><span class="p">]</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">+</span> <span class="n">sol</span><span class="p">[</span><span class="n">tt</span><span class="p">]</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="mi">4</span><span class="p">])</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">mylab</span><span class="p">(</span><span class="n">t0ran</span><span class="p">[</span><span class="n">tt</span><span class="p">]))</span>
<a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-5" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-5" href="../posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-5"></a><span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">([</span><span class="mi">30</span><span class="p">,</span><span class="mi">70</span><span class="p">])</span>
<a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-6" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-6" href="../posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-6"></a><span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mf">7e6</span><span class="p">])</span>
<a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-7" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-7" href="../posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-7"></a><span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">'Time (days)'</span><span class="p">)</span>
<a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-8" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-8" href="../posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-8"></a><span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">'Number of infectious cases'</span><span class="p">)</span>
<a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-9" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-9" href="../posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-9"></a><span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-10" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-10" href="../posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-10"></a><span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-11" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-11" href="../posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-11"></a><span class="k">for</span> <span class="n">tt</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">t0ran</span><span class="p">)):</span>
<a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-12" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-12" href="../posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-12"></a>    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">sol</span><span class="p">[</span><span class="n">tt</span><span class="p">]</span><span class="o">.</span><span class="n">t</span><span class="p">,</span><span class="n">N</span><span class="o">*</span><span class="n">sol</span><span class="p">[</span><span class="n">tt</span><span class="p">]</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">mylab</span><span class="p">(</span><span class="n">t0ran</span><span class="p">[</span><span class="n">tt</span><span class="p">]))</span>
<a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-13" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-13" href="../posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-13"></a><span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">'Time (days)'</span><span class="p">)</span>
<a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-14" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-14" href="../posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-14"></a><span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">'Cumulative infections'</span><span class="p">)</span>
<a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-15" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-15" href="../posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-15"></a><span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-16" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-16" href="../posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-16"></a><span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">([</span><span class="mi">30</span><span class="p">,</span><span class="mi">70</span><span class="p">])</span>
<a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-17" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-17" href="../posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-17"></a><span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mf">1e7</span><span class="p">])</span>
<a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-18" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-18" href="../posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-18"></a><span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-19" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-19" href="../posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-19"></a><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
<div class="code"><pre class="code ipython3"><a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-1" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-1" href="../posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-1"></a><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-2" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-2" href="../posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-2"></a><span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-3" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-3" href="../posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-3"></a><span class="k">for</span> <span class="n">tt</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">t0ran</span><span class="p">)):</span>
<a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-4" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-4" href="../posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-4"></a>    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">sol</span><span class="p">[</span><span class="n">tt</span><span class="p">]</span><span class="o">.</span><span class="n">t</span><span class="p">,</span><span class="n">N</span><span class="o">*</span><span class="p">(</span><span class="n">sol</span><span class="p">[</span><span class="n">tt</span><span class="p">]</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">+</span> <span class="n">sol</span><span class="p">[</span><span class="n">tt</span><span class="p">]</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="mi">4</span><span class="p">])</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">mylab</span><span class="p">(</span><span class="n">t0ran</span><span class="p">[</span><span class="n">tt</span><span class="p">]))</span>
<a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-5" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-5" href="../posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-5"></a><span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="n">tlast</span><span class="p">])</span>
<a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-6" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-6" href="../posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-6"></a><span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mf">1.2e7</span><span class="p">])</span>
<a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-7" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-7" href="../posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-7"></a><span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">'Time (days)'</span><span class="p">)</span>
<a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-8" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-8" href="../posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-8"></a><span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">'Number of infectious cases'</span><span class="p">)</span>
<a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-9" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-9" href="../posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-9"></a><span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-10" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-10" href="../posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-10"></a><span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-11" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-11" href="../posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-11"></a><span class="k">for</span> <span class="n">tt</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">t0ran</span><span class="p">)):</span>
<a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-12" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-12" href="../posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-12"></a>    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">sol</span><span class="p">[</span><span class="n">tt</span><span class="p">]</span><span class="o">.</span><span class="n">t</span><span class="p">,</span><span class="n">N</span><span class="o">*</span><span class="n">sol</span><span class="p">[</span><span class="n">tt</span><span class="p">]</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">mylab</span><span class="p">(</span><span class="n">t0ran</span><span class="p">[</span><span class="n">tt</span><span class="p">]))</span>
<a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-13" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-13" href="../posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-13"></a><span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">'Time (days)'</span><span class="p">)</span>
<a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-14" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-14" href="../posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-14"></a><span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">'Cumulative infections'</span><span class="p">)</span>
<a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-15" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-15" href="../posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-15"></a><span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-16" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-16" href="../posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-16"></a><span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="n">tlast</span><span class="p">])</span>
<a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-17" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-17" href="../posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-17"></a><span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mf">6.2e7</span><span class="p">])</span>
<a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-18" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-18" href="../posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-18"></a><span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-19" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-19" href="../posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-19"></a><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
                </div>
            </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="../posts/semester-1-2018.html" class="u-url">Semester 1 2018</a></h1>
                <div class="metadata">
                    <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                        Thomas House
                    </span></p>
            <p class="dateline">
            <a href="../posts/semester-1-2018.html" rel="bookmark">
            <time class="published dt-published" datetime="2018-12-21T10:30:44Z" itemprop="datePublished" title="2018-12-21 10:30">2018-12-21 10:30</time></a>
            </p>
                </div>
            </header><div class="e-content entry-content">
                    <p>This table gives a rough idea of where I was in Semester 1, 2018; I'm putting
it here mainly in case I need to re-use the HTML.</p>
<p><span class="raw-html"><div align="center">
<table class="timetable">
<tr>
<th class="timetable"></th>
<th class="timetable">09:00 </th>
<th class="timetable">10:00 </th>
<th class="timetable">11:00 </th>
<th class="timetable">12:00 </th>
<th class="timetable">13:00 </th>
<th class="timetable">14:00 </th>
<th class="timetable">15:00 </th>
</tr>
<tr>
<th class="timetable">¬†<br>MON<br>¬†</th>
<td class="timetable freehour">¬†</td> <!--  9:00 -->
<td class="timetable" colspan="2">
Statstics and Machine Learning 1<br><em>Lecture</em> <br>
Simon Building: 4.47<br>
</td>
<td class="timetable freehour">¬†</td>
<td class="timetable freehour">¬†</td> <!--  1:00 -->
<td class="timetable" colspan="2">
Statstics and Machine Learning 1<br><em>Computer Class</em> <br>
Ellen Wilkinson: B3.3<br>
</td>
</tr>
<tr>
<th class="timetable">¬†<br>TUES<br>¬†</th>
<td class="timetable freehour">¬†</td>      <!--  9:00 -->
<td class="timetable freehour">¬†</td>      <!--  10:00 -->
<td class="timetable freehour">¬†</td>      <!--  11:00 -->
<td class="timetable">
SQUIDS<br><em>Seminar</em><br>
Frank Adams 1<br>
</td>
<td class="timetable freehour">¬†</td>      <!--  1:00 -->
<td class="timetable freehour">¬†</td>      <!--  2:00 -->
<td class="timetable freehour">¬†</td>      <!--  3:00 -->
</tr>
<tr>
<th class="timetable">¬†<br>WEDS<br>¬†</th>
<td class="timetable freehour">¬†</td>      <!--  9:00 -->
<td class="timetable" colspan="2">
Multivariate Statistics<br><em>Lecture</em><br>
University Place 3.213
</td>
<td class="timetable">
IM(PA):CT!<br><em>Seminar</em><br>
Frank Adams 1<br>
</td>
<td class="timetable freehour">¬†</td> <!--  1:00 -->
<td class="timetable freehour">¬†</td> <!--  2:00 -->
<td class="timetable freehour">¬†</td> <!--  3:00 -->
</tr>
<tr>
<th class="timetable">¬†<br>THURS<br>¬†</th>
<td class="timetable freehour">¬†</td> <!--  9:00 -->
<td class="timetable freehour">¬†</td> <!-- 10:00 -->
<td class="timetable freehour">¬†</td> <!-- 11:00 -->
<td class="timetable freehour">¬†</td> <!-- 12:00 -->
<td class="timetable freehour">¬†</td> <!--  1:00 -->
<td class="timetable freehour">¬†</td> <!--  2:00 -->
<td class="timetable freehour">¬†</td> <!--  3:00 -->
</tr>
<tr>
<th class="timetable">¬†<br>FRI<br>¬†</th>
<td class="timetable">
Multivariate Statistics<br><em>Lecture</em><br>
University Place 3.214
</td>
<td class="timetable">
Multivariate Statistics<br><em>Tutorial</em><br>
University Place 3.214
</td>
<td class="timetable" colspan="2">
Office Hours<br><em>(11.30-12.30 guaranteed)</em><br>
Alan Turing Building 1.114
</td>
<td class="timetable">
Calculus and Vectors<br><em>Group 14 Supervision</em><br>
Alan Turing Building G.108
</td>
<td class="timetable freehour">¬†</td> <!--  2:00 -->
<td class="timetable">
Calculus and Vectors<br><em>Group 38 Supervision</em><br>
Alan Turing Building G.221A
</td>
</tr>
</table>
</div></span></p>
                </div>
            </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="../posts/opportunities-in-manchester.html" class="u-url">Opportunities in Manchester</a></h1>
                <div class="metadata">
                    <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                        Thomas House
                    </span></p>
            <p class="dateline">
            <a href="../posts/opportunities-in-manchester.html" rel="bookmark">
            <time class="published dt-published" datetime="2018-11-12T12:06:21Z" itemprop="datePublished" title="2018-11-12 12:06">2018-11-12 12:06</time></a>
            </p>
                </div>
            </header><div class="e-content entry-content">
                    <img alt="Mathematical Epidemiologists 2018" class="align-right" src="../group_2018.jpg" style="width: 360px;"><p>There are various opportunities to work in areas related to Mathematical
Epidemiology in Manchester at present - a recent meeting of our lively and
growing group is shown, please get in touch if you're interested!</p>
<section id="phd"><h2>PhD:</h2>
<p><a class="reference external" href="https://www.findaphd.com/search/projectdetails.aspx?PJID=80395">Understanding and Mitigating Against Organ Damage from Radiotherapy using
Statistical Learning from Large Cohort Data</a> (Deadline
Friday 16 November) is a PhD programme looking at methods for cancer
radiotherapy data with the world-leading group at the Christie Hospital.</p>
<p><a class="reference external" href="https://www.turing.ac.uk/phd-at-turing">Alan Turing Institute PhD Programme</a> -
Lorenzo Pellis, Ian Hall and I are Alan Turing Institute Fellows and can support
applications to this scheme.</p>
</section><section id="postdocotral"><h2>Postdocotral:</h2>
<p><a class="reference external" href="https://www.jobs.manchester.ac.uk/internal/displayjob.aspx?jobid=16284">Dame Kathleen Ollerenshaw Fellowships</a>
(Deadline 23 November) are 5 year postdoctoral positions leading on to tenure.</p>
</section><section id="faculty"><h2>Faculty:</h2>
<p>There are also two open Faculty positions:
<a class="reference external" href="https://www.jobs.ac.uk/job/BOA591/lecturer-senior-lecturer-or-reader-in-applied-mathematics">Lecturer, Senior Lecturer or Reader in Applied Mathematics</a>
and
<a class="reference external" href="https://www.jobs.ac.uk/job/BOA582/lecturer-in-mathematical-finance-mathematical-statistics">Lecturer in Mathematical Finance / Mathematical Statistics</a>
(Deadline 11 January).</p>
</section>
</div>
            </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="../posts/caffeine-in-pregnancy-weak-identifiability-and-working-with-the-media.html" class="u-url">Caffeine in Pregnancy, Weak Identifiability, and Working with the Media</a></h1>
                <div class="metadata">
                    <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                        Thomas House
                    </span></p>
            <p class="dateline">
            <a href="../posts/caffeine-in-pregnancy-weak-identifiability-and-working-with-the-media.html" rel="bookmark">
            <time class="published dt-published" datetime="2018-04-25T12:19:27Z" itemprop="datePublished" title="2018-04-25 12:19">2018-04-25 12:19</time></a>
            </p>
                </div>
            </header><div class="e-content entry-content">
                    <p>A recent <a class="reference external" href="http://bmjopen.bmj.com/content/8/3/e018895/">Paper in BMJ Open</a>
deals with the question of maternal caffeine intake and childhood obesity.</p>
<p>I worked with the Science Media Centre to produce a <a class="reference external" href="http://www.sciencemediacentre.org/expert-reaction-to-study-looking-at-caffeine-in-pregnancy-and-weight-gain-in-children/">Press Release</a> in which I made
the comment:</p>
<blockquote>
<p>"This study makes the headline claim that in a population of over 50,000
mother-child pairs, caffeine intake is positively associated with risk of
childhood obesity.  Let us make a ‚Äòback of the envelope‚Äô calculation on one
of the outcome measures using the cup of instant coffee per day as a measure
of the mother‚Äôs caffeine intake.</p>
<p>If we take 100 children whose mother group had the lowest caffeine intake (1
cup or less) then at age three, around 11 will be obese; in the next group
(1-4 cups) there will be one additional obese child (12 in total); in the
next (4-6 cups) there will be an additional two (14 in total) and in the
group with highest caffeine intake (6 or more cups) there will be an
additional three (17 in total).</p>
<p>The main problem with the study is that
maternal caffeine intake is strongly correlated with other relevant factors,
and so these should be controlled for.  In the authors‚Äô statistical analyses,
the ‚Äòbest fit‚Äô models they‚Äôve used suggest around half of the additional
cases of obesity in children of age 3 are explained by caffeine rather than,
say, calorie intake of mothers.  But since the caffeine and calorie intake
are correlated, the existence of a ‚Äòbest fit‚Äô model with equal weighting on
both means we actually can‚Äôt say whether a model looking at just calorie
intake of mothers would be an equally good explanation of child obesity.  It
also says nothing about whether including a new explanatory measure, such as
the child‚Äôs calorie intake, would change the model.</p>
<p>As such, the evidence
provided in the study for a causal effect is extremely weak and the statement
from the authors that 'complete avoidance might actually be advisable' seems
unjustified, particularly when we consider the effects that such a
restriction might have on wellbeing of mothers."</p>
</blockquote>
<p>This story was quite widely covered, but most papers took the same approach as
<a class="reference external" href="https://inews.co.uk/news/health/pregnant-women-babies-caffeine-consumption-overweight/">iNews</a>
and only quoted my main conclusion, but not the reasoning.</p>
<p>So let's consider a simple exaple that exhibits the main problem, in particular
the following contingency table. This is much smaller than the original study,
but the same phenomenon is exhibited by larger populations with more
explanatory factors:</p>
<table><tbody>
<tr>
<td colspan="2" rowspan="2"></td>
<td colspan="4"><p>Caffeine Intake</p></td>
</tr>
<tr>
<td colspan="2"><p>Low</p></td>
<td colspan="2"><p>High</p></td>
</tr>
<tr>
<td rowspan="4"><p>Calorie
Intake</p></td>
<td rowspan="2"><p>Low</p></td>
<td><p>Healthy</p></td>
<td><p>Overweight</p></td>
<td><p>Healthy</p></td>
<td><p>Overweight</p></td>
</tr>
<tr>
<td><p>63</p></td>
<td><p>7</p></td>
<td><p>3</p></td>
<td><p>2</p></td>
</tr>
<tr>
<td rowspan="2"><p>High</p></td>
<td><p>Healthy</p></td>
<td><p>Overweight</p></td>
<td><p>Healthy</p></td>
<td><p>Overweight</p></td>
</tr>
<tr>
<td><p>2</p></td>
<td><p>3</p></td>
<td><p>5</p></td>
<td><p>15</p></td>
</tr>
</tbody></table>
<p>Note that 68% of the high caffeine group is overweight, while only 13% of the
low caffeine group is, but we note that calorie intake may be an issue so let
us perform logistic regression as the authors did, letting
<span class="raw-html">\[\mathrm{Pr}(\mathrm{Overweight}) = 1/(1+ \mathrm{exp}(-\beta_0
- \beta_1 \times \mathrm{HighCalorie} - \beta_2 \times \mathrm{HighCaffeine})) \mathrm{ ,}\]</span>
where <span class="raw-html">\(\beta_0\)</span> is the intercept, <span class="raw-html">\(\beta_1\)</span> is the
log odds due to calories and <span class="raw-html">\(\beta_2\)</span> is the log odds due to
caffeine. Setting the intercept at its maximum likelihood value, the maximum
likelihood values for the other parameters are shown as the cross below, which
attributes roughly equal importance to the two factors:</p>
<img alt="Likelihood surface" src="../likelihood.png" style="width: 400px;"><p>Behind this cross is a shaded region with intensity equal to the likelihood of
different parameter combinations - and we note that there is still a reasonable
amount of shading in the area where <span class="raw-html">\(\beta_2 \approx 0\)</span>. This is
a special case of a general phenomenon called weak identifiability, and it is
something <a class="reference external" href="http://rsif.royalsocietypublishing.org/content/13/121/20160279/">I've done a bit of work on</a> - there
are various ways to deal with this, but its presence is the reason that
evidence for a causal effect is weak in the original study.</p>
                </div>
            </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="../posts/visualising-the-wishart-distribution.html" class="u-url">Visualising the Wishart Distribution</a></h1>
                <div class="metadata">
                    <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                        Thomas House
                    </span></p>
            <p class="dateline">
            <a href="../posts/visualising-the-wishart-distribution.html" rel="bookmark">
            <time class="published dt-published" datetime="2017-12-08T12:08:22Z" itemprop="datePublished" title="2017-12-08 12:08">2017-12-08 12:08</time></a>
            </p>
                </div>
            </header><div class="e-content entry-content">
                    <p>This semester, I have been teaching Multivariate Statistics, and one isse that comes up is how to think
about the Wishart distribution, which generalises the <span class="raw-html">\(\chi^2 \)</span> distribution. This has
probability density function</p>
<p><span class="raw-html">$$ f_{\chi^2_k}(x) = \frac{1}{2\,\Gamma\!\left(\frac{k}{2}\right)} \left(\frac{x}{2}\right)^{\frac{k}{2}-1} {\rm e}^{-\frac{x}{2}} . $$</span></p>
<p>To visualise this at different degrees of freedom <span class="raw-html">\(k \)</span>, we use the following Python code.</p>
<div class="code"><pre class="code ipython3"><a id="rest_code_81efedfac39441e3b3ff970c0031d6ad-1" name="rest_code_81efedfac39441e3b3ff970c0031d6ad-1" href="../posts/visualising-the-wishart-distribution.html#rest_code_81efedfac39441e3b3ff970c0031d6ad-1"></a><span class="o">%</span><span class="k">matplotlib</span> inline
<a id="rest_code_81efedfac39441e3b3ff970c0031d6ad-2" name="rest_code_81efedfac39441e3b3ff970c0031d6ad-2" href="../posts/visualising-the-wishart-distribution.html#rest_code_81efedfac39441e3b3ff970c0031d6ad-2"></a><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<a id="rest_code_81efedfac39441e3b3ff970c0031d6ad-3" name="rest_code_81efedfac39441e3b3ff970c0031d6ad-3" href="../posts/visualising-the-wishart-distribution.html#rest_code_81efedfac39441e3b3ff970c0031d6ad-3"></a><span class="kn">import</span> <span class="nn">scipy.stats</span> <span class="k">as</span> <span class="nn">st</span>
<a id="rest_code_81efedfac39441e3b3ff970c0031d6ad-4" name="rest_code_81efedfac39441e3b3ff970c0031d6ad-4" href="../posts/visualising-the-wishart-distribution.html#rest_code_81efedfac39441e3b3ff970c0031d6ad-4"></a><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<a id="rest_code_81efedfac39441e3b3ff970c0031d6ad-5" name="rest_code_81efedfac39441e3b3ff970c0031d6ad-5" href="../posts/visualising-the-wishart-distribution.html#rest_code_81efedfac39441e3b3ff970c0031d6ad-5"></a><span class="kn">from</span> <span class="nn">mpl_toolkits.mplot3d</span> <span class="kn">import</span> <span class="n">Axes3D</span>
</pre></div>
<div class="code"><pre class="code ipython3"><a id="rest_code_3d31a68eeecd430b9d94ef668b0d27bf-1" name="rest_code_3d31a68eeecd430b9d94ef668b0d27bf-1" href="../posts/visualising-the-wishart-distribution.html#rest_code_3d31a68eeecd430b9d94ef668b0d27bf-1"></a><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
<a id="rest_code_3d31a68eeecd430b9d94ef668b0d27bf-2" name="rest_code_3d31a68eeecd430b9d94ef668b0d27bf-2" href="../posts/visualising-the-wishart-distribution.html#rest_code_3d31a68eeecd430b9d94ef668b0d27bf-2"></a><span class="n">Sig1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mf">0.75</span><span class="p">],[</span><span class="mf">0.75</span><span class="p">,</span><span class="mi">2</span><span class="p">]])</span>
<a id="rest_code_3d31a68eeecd430b9d94ef668b0d27bf-3" name="rest_code_3d31a68eeecd430b9d94ef668b0d27bf-3" href="../posts/visualising-the-wishart-distribution.html#rest_code_3d31a68eeecd430b9d94ef668b0d27bf-3"></a><span class="n">n</span><span class="o">=</span><span class="mi">1000</span>
</pre></div>
<div class="code"><pre class="code ipython3"><a id="rest_code_cc3ae6870b534a5eb55e0d2447174adb-1" name="rest_code_cc3ae6870b534a5eb55e0d2447174adb-1" href="../posts/visualising-the-wishart-distribution.html#rest_code_cc3ae6870b534a5eb55e0d2447174adb-1"></a><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
<a id="rest_code_cc3ae6870b534a5eb55e0d2447174adb-2" name="rest_code_cc3ae6870b534a5eb55e0d2447174adb-2" href="../posts/visualising-the-wishart-distribution.html#rest_code_cc3ae6870b534a5eb55e0d2447174adb-2"></a><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
<a id="rest_code_cc3ae6870b534a5eb55e0d2447174adb-3" name="rest_code_cc3ae6870b534a5eb55e0d2447174adb-3" href="../posts/visualising-the-wishart-distribution.html#rest_code_cc3ae6870b534a5eb55e0d2447174adb-3"></a><span class="n">colors</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">Accent</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
<a id="rest_code_cc3ae6870b534a5eb55e0d2447174adb-4" name="rest_code_cc3ae6870b534a5eb55e0d2447174adb-4" href="../posts/visualising-the-wishart-distribution.html#rest_code_cc3ae6870b534a5eb55e0d2447174adb-4"></a><span class="n">i</span><span class="o">=</span><span class="mi">0</span>
<a id="rest_code_cc3ae6870b534a5eb55e0d2447174adb-5" name="rest_code_cc3ae6870b534a5eb55e0d2447174adb-5" href="../posts/visualising-the-wishart-distribution.html#rest_code_cc3ae6870b534a5eb55e0d2447174adb-5"></a><span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">10</span><span class="p">):</span>
<a id="rest_code_cc3ae6870b534a5eb55e0d2447174adb-6" name="rest_code_cc3ae6870b534a5eb55e0d2447174adb-6" href="../posts/visualising-the-wishart-distribution.html#rest_code_cc3ae6870b534a5eb55e0d2447174adb-6"></a>    <span class="n">c</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">chi2</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">k</span><span class="p">);</span>
<a id="rest_code_cc3ae6870b534a5eb55e0d2447174adb-7" name="rest_code_cc3ae6870b534a5eb55e0d2447174adb-7" href="../posts/visualising-the-wishart-distribution.html#rest_code_cc3ae6870b534a5eb55e0d2447174adb-7"></a>    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">c</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">'k = '</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<a id="rest_code_cc3ae6870b534a5eb55e0d2447174adb-8" name="rest_code_cc3ae6870b534a5eb55e0d2447174adb-8" href="../posts/visualising-the-wishart-distribution.html#rest_code_cc3ae6870b534a5eb55e0d2447174adb-8"></a>    <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
<a id="rest_code_cc3ae6870b534a5eb55e0d2447174adb-9" name="rest_code_cc3ae6870b534a5eb55e0d2447174adb-9" href="../posts/visualising-the-wishart-distribution.html#rest_code_cc3ae6870b534a5eb55e0d2447174adb-9"></a><span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<a id="rest_code_cc3ae6870b534a5eb55e0d2447174adb-10" name="rest_code_cc3ae6870b534a5eb55e0d2447174adb-10" href="../posts/visualising-the-wishart-distribution.html#rest_code_cc3ae6870b534a5eb55e0d2447174adb-10"></a><span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="mf">0.5</span><span class="p">))</span>
<a id="rest_code_cc3ae6870b534a5eb55e0d2447174adb-11" name="rest_code_cc3ae6870b534a5eb55e0d2447174adb-11" href="../posts/visualising-the-wishart-distribution.html#rest_code_cc3ae6870b534a5eb55e0d2447174adb-11"></a><span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">'x'</span><span class="p">)</span>
<a id="rest_code_cc3ae6870b534a5eb55e0d2447174adb-12" name="rest_code_cc3ae6870b534a5eb55e0d2447174adb-12" href="../posts/visualising-the-wishart-distribution.html#rest_code_cc3ae6870b534a5eb55e0d2447174adb-12"></a><span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">'f(x)'</span><span class="p">)</span>
<a id="rest_code_cc3ae6870b534a5eb55e0d2447174adb-13" name="rest_code_cc3ae6870b534a5eb55e0d2447174adb-13" href="../posts/visualising-the-wishart-distribution.html#rest_code_cc3ae6870b534a5eb55e0d2447174adb-13"></a><span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</pre></div>
<img alt="../output_2_1.png" src="../output_2_1.png"><p>The Wishart emerges when we make <span class="raw-html">\(k \)</span> observations each with <span class="raw-html">\(p \)</span> variables; the
sampling distribution for the covariance matrix of these data if the population is multivariate normal is
Wishart and has probability density function</p>
<p><span class="raw-html">$$ f_{\mathcal{W}_p(k,\boldsymbol{\Sigma})}(\boldsymbol{V}) = \frac{\mathrm{det}(\boldsymbol{V})^{\frac{k - p - 1}{2}}}{2^{ \frac{k p}{2} } \mathrm{det}(\boldsymbol{\Sigma})^\frac{k}{2} \Gamma_p\!\left(\frac{k}{2} \right)} \exp\left( -\frac12 \mathrm{Tr}(\boldsymbol{\Sigma}^{-1} \boldsymbol{V}) \right) . $$</span></p>
<p>In general, this cannot be visualised, but for the <span class="raw-html">\(p=2 \)</span> case, one option is to pick random
numbers from this distribution and then produce a three-dimensional scatter plot of these. The code and results
below show that this can be seen as behaving somewhat like the chi-squared distribution that it generalises as
the degrees of freedom <span class="raw-html">\(k \)</span> are increased.</p>
<div class="code"><pre class="code ipython3"><a id="rest_code_2a204a6d0b0b40ddb307802c80ca763c-1" name="rest_code_2a204a6d0b0b40ddb307802c80ca763c-1" href="../posts/visualising-the-wishart-distribution.html#rest_code_2a204a6d0b0b40ddb307802c80ca763c-1"></a><span class="n">x</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<a id="rest_code_2a204a6d0b0b40ddb307802c80ca763c-2" name="rest_code_2a204a6d0b0b40ddb307802c80ca763c-2" href="../posts/visualising-the-wishart-distribution.html#rest_code_2a204a6d0b0b40ddb307802c80ca763c-2"></a><span class="n">y</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<a id="rest_code_2a204a6d0b0b40ddb307802c80ca763c-3" name="rest_code_2a204a6d0b0b40ddb307802c80ca763c-3" href="../posts/visualising-the-wishart-distribution.html#rest_code_2a204a6d0b0b40ddb307802c80ca763c-3"></a><span class="n">z</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<a id="rest_code_2a204a6d0b0b40ddb307802c80ca763c-4" name="rest_code_2a204a6d0b0b40ddb307802c80ca763c-4" href="../posts/visualising-the-wishart-distribution.html#rest_code_2a204a6d0b0b40ddb307802c80ca763c-4"></a><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">n</span><span class="p">):</span>
<a id="rest_code_2a204a6d0b0b40ddb307802c80ca763c-5" name="rest_code_2a204a6d0b0b40ddb307802c80ca763c-5" href="../posts/visualising-the-wishart-distribution.html#rest_code_2a204a6d0b0b40ddb307802c80ca763c-5"></a>    <span class="n">M</span><span class="o">=</span><span class="n">st</span><span class="o">.</span><span class="n">wishart</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">scale</span><span class="o">=</span><span class="n">Sig1</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<a id="rest_code_2a204a6d0b0b40ddb307802c80ca763c-6" name="rest_code_2a204a6d0b0b40ddb307802c80ca763c-6" href="../posts/visualising-the-wishart-distribution.html#rest_code_2a204a6d0b0b40ddb307802c80ca763c-6"></a>    <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">M</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<a id="rest_code_2a204a6d0b0b40ddb307802c80ca763c-7" name="rest_code_2a204a6d0b0b40ddb307802c80ca763c-7" href="../posts/visualising-the-wishart-distribution.html#rest_code_2a204a6d0b0b40ddb307802c80ca763c-7"></a>    <span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">M</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
<a id="rest_code_2a204a6d0b0b40ddb307802c80ca763c-8" name="rest_code_2a204a6d0b0b40ddb307802c80ca763c-8" href="../posts/visualising-the-wishart-distribution.html#rest_code_2a204a6d0b0b40ddb307802c80ca763c-8"></a>    <span class="n">z</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">M</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<a id="rest_code_2a204a6d0b0b40ddb307802c80ca763c-9" name="rest_code_2a204a6d0b0b40ddb307802c80ca763c-9" href="../posts/visualising-the-wishart-distribution.html#rest_code_2a204a6d0b0b40ddb307802c80ca763c-9"></a><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<a id="rest_code_2a204a6d0b0b40ddb307802c80ca763c-10" name="rest_code_2a204a6d0b0b40ddb307802c80ca763c-10" href="../posts/visualising-the-wishart-distribution.html#rest_code_2a204a6d0b0b40ddb307802c80ca763c-10"></a><span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="s1">'3d'</span><span class="p">)</span>
<a id="rest_code_2a204a6d0b0b40ddb307802c80ca763c-11" name="rest_code_2a204a6d0b0b40ddb307802c80ca763c-11" href="../posts/visualising-the-wishart-distribution.html#rest_code_2a204a6d0b0b40ddb307802c80ca763c-11"></a><span class="n">ax</span><span class="o">.</span><span class="n">scatter3D</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">'o'</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="n">z</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">'seismic'</span><span class="p">)</span>
<a id="rest_code_2a204a6d0b0b40ddb307802c80ca763c-12" name="rest_code_2a204a6d0b0b40ddb307802c80ca763c-12" href="../posts/visualising-the-wishart-distribution.html#rest_code_2a204a6d0b0b40ddb307802c80ca763c-12"></a><span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">'V11'</span><span class="p">)</span>
<a id="rest_code_2a204a6d0b0b40ddb307802c80ca763c-13" name="rest_code_2a204a6d0b0b40ddb307802c80ca763c-13" href="../posts/visualising-the-wishart-distribution.html#rest_code_2a204a6d0b0b40ddb307802c80ca763c-13"></a><span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">'V22'</span><span class="p">)</span>
<a id="rest_code_2a204a6d0b0b40ddb307802c80ca763c-14" name="rest_code_2a204a6d0b0b40ddb307802c80ca763c-14" href="../posts/visualising-the-wishart-distribution.html#rest_code_2a204a6d0b0b40ddb307802c80ca763c-14"></a><span class="n">ax</span><span class="o">.</span><span class="n">set_zlabel</span><span class="p">(</span><span class="s1">'V12=V21'</span><span class="p">)</span>
<a id="rest_code_2a204a6d0b0b40ddb307802c80ca763c-15" name="rest_code_2a204a6d0b0b40ddb307802c80ca763c-15" href="../posts/visualising-the-wishart-distribution.html#rest_code_2a204a6d0b0b40ddb307802c80ca763c-15"></a><span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="mi">30</span><span class="p">))</span>
<a id="rest_code_2a204a6d0b0b40ddb307802c80ca763c-16" name="rest_code_2a204a6d0b0b40ddb307802c80ca763c-16" href="../posts/visualising-the-wishart-distribution.html#rest_code_2a204a6d0b0b40ddb307802c80ca763c-16"></a><span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="mi">70</span><span class="p">))</span>
<a id="rest_code_2a204a6d0b0b40ddb307802c80ca763c-17" name="rest_code_2a204a6d0b0b40ddb307802c80ca763c-17" href="../posts/visualising-the-wishart-distribution.html#rest_code_2a204a6d0b0b40ddb307802c80ca763c-17"></a><span class="n">ax</span><span class="o">.</span><span class="n">set_zlim</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="mi">30</span><span class="p">))</span>
<a id="rest_code_2a204a6d0b0b40ddb307802c80ca763c-18" name="rest_code_2a204a6d0b0b40ddb307802c80ca763c-18" href="../posts/visualising-the-wishart-distribution.html#rest_code_2a204a6d0b0b40ddb307802c80ca763c-18"></a><span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
<img alt="../output_3_0.png" src="../output_3_0.png"><div class="code"><pre class="code ipython3"><a id="rest_code_a676d237e9c8464d88906f5cf10f4924-1" name="rest_code_a676d237e9c8464d88906f5cf10f4924-1" href="../posts/visualising-the-wishart-distribution.html#rest_code_a676d237e9c8464d88906f5cf10f4924-1"></a><span class="n">x</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<a id="rest_code_a676d237e9c8464d88906f5cf10f4924-2" name="rest_code_a676d237e9c8464d88906f5cf10f4924-2" href="../posts/visualising-the-wishart-distribution.html#rest_code_a676d237e9c8464d88906f5cf10f4924-2"></a><span class="n">y</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<a id="rest_code_a676d237e9c8464d88906f5cf10f4924-3" name="rest_code_a676d237e9c8464d88906f5cf10f4924-3" href="../posts/visualising-the-wishart-distribution.html#rest_code_a676d237e9c8464d88906f5cf10f4924-3"></a><span class="n">z</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<a id="rest_code_a676d237e9c8464d88906f5cf10f4924-4" name="rest_code_a676d237e9c8464d88906f5cf10f4924-4" href="../posts/visualising-the-wishart-distribution.html#rest_code_a676d237e9c8464d88906f5cf10f4924-4"></a><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">n</span><span class="p">):</span>
<a id="rest_code_a676d237e9c8464d88906f5cf10f4924-5" name="rest_code_a676d237e9c8464d88906f5cf10f4924-5" href="../posts/visualising-the-wishart-distribution.html#rest_code_a676d237e9c8464d88906f5cf10f4924-5"></a>    <span class="n">M</span><span class="o">=</span><span class="n">st</span><span class="o">.</span><span class="n">wishart</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="n">scale</span><span class="o">=</span><span class="n">Sig1</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<a id="rest_code_a676d237e9c8464d88906f5cf10f4924-6" name="rest_code_a676d237e9c8464d88906f5cf10f4924-6" href="../posts/visualising-the-wishart-distribution.html#rest_code_a676d237e9c8464d88906f5cf10f4924-6"></a>    <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">M</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<a id="rest_code_a676d237e9c8464d88906f5cf10f4924-7" name="rest_code_a676d237e9c8464d88906f5cf10f4924-7" href="../posts/visualising-the-wishart-distribution.html#rest_code_a676d237e9c8464d88906f5cf10f4924-7"></a>    <span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">M</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
<a id="rest_code_a676d237e9c8464d88906f5cf10f4924-8" name="rest_code_a676d237e9c8464d88906f5cf10f4924-8" href="../posts/visualising-the-wishart-distribution.html#rest_code_a676d237e9c8464d88906f5cf10f4924-8"></a>    <span class="n">z</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">M</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<a id="rest_code_a676d237e9c8464d88906f5cf10f4924-9" name="rest_code_a676d237e9c8464d88906f5cf10f4924-9" href="../posts/visualising-the-wishart-distribution.html#rest_code_a676d237e9c8464d88906f5cf10f4924-9"></a><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<a id="rest_code_a676d237e9c8464d88906f5cf10f4924-10" name="rest_code_a676d237e9c8464d88906f5cf10f4924-10" href="../posts/visualising-the-wishart-distribution.html#rest_code_a676d237e9c8464d88906f5cf10f4924-10"></a><span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="s1">'3d'</span><span class="p">)</span>
<a id="rest_code_a676d237e9c8464d88906f5cf10f4924-11" name="rest_code_a676d237e9c8464d88906f5cf10f4924-11" href="../posts/visualising-the-wishart-distribution.html#rest_code_a676d237e9c8464d88906f5cf10f4924-11"></a><span class="n">ax</span><span class="o">.</span><span class="n">scatter3D</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">'o'</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="n">z</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">'seismic'</span><span class="p">)</span>
<a id="rest_code_a676d237e9c8464d88906f5cf10f4924-12" name="rest_code_a676d237e9c8464d88906f5cf10f4924-12" href="../posts/visualising-the-wishart-distribution.html#rest_code_a676d237e9c8464d88906f5cf10f4924-12"></a><span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">'V11'</span><span class="p">)</span>
<a id="rest_code_a676d237e9c8464d88906f5cf10f4924-13" name="rest_code_a676d237e9c8464d88906f5cf10f4924-13" href="../posts/visualising-the-wishart-distribution.html#rest_code_a676d237e9c8464d88906f5cf10f4924-13"></a><span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">'V22'</span><span class="p">)</span>
<a id="rest_code_a676d237e9c8464d88906f5cf10f4924-14" name="rest_code_a676d237e9c8464d88906f5cf10f4924-14" href="../posts/visualising-the-wishart-distribution.html#rest_code_a676d237e9c8464d88906f5cf10f4924-14"></a><span class="n">ax</span><span class="o">.</span><span class="n">set_zlabel</span><span class="p">(</span><span class="s1">'V12=V21'</span><span class="p">)</span>
<a id="rest_code_a676d237e9c8464d88906f5cf10f4924-15" name="rest_code_a676d237e9c8464d88906f5cf10f4924-15" href="../posts/visualising-the-wishart-distribution.html#rest_code_a676d237e9c8464d88906f5cf10f4924-15"></a><span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="mi">30</span><span class="p">))</span>
<a id="rest_code_a676d237e9c8464d88906f5cf10f4924-16" name="rest_code_a676d237e9c8464d88906f5cf10f4924-16" href="../posts/visualising-the-wishart-distribution.html#rest_code_a676d237e9c8464d88906f5cf10f4924-16"></a><span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="mi">70</span><span class="p">))</span>
<a id="rest_code_a676d237e9c8464d88906f5cf10f4924-17" name="rest_code_a676d237e9c8464d88906f5cf10f4924-17" href="../posts/visualising-the-wishart-distribution.html#rest_code_a676d237e9c8464d88906f5cf10f4924-17"></a><span class="n">ax</span><span class="o">.</span><span class="n">set_zlim</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="mi">30</span><span class="p">))</span>
<a id="rest_code_a676d237e9c8464d88906f5cf10f4924-18" name="rest_code_a676d237e9c8464d88906f5cf10f4924-18" href="../posts/visualising-the-wishart-distribution.html#rest_code_a676d237e9c8464d88906f5cf10f4924-18"></a><span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
<img alt="../output_4_0.png" src="../output_4_0.png"><div class="code"><pre class="code ipython3"><a id="rest_code_76116a44a2574bca8e27ed73d13dd183-1" name="rest_code_76116a44a2574bca8e27ed73d13dd183-1" href="../posts/visualising-the-wishart-distribution.html#rest_code_76116a44a2574bca8e27ed73d13dd183-1"></a><span class="n">x</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<a id="rest_code_76116a44a2574bca8e27ed73d13dd183-2" name="rest_code_76116a44a2574bca8e27ed73d13dd183-2" href="../posts/visualising-the-wishart-distribution.html#rest_code_76116a44a2574bca8e27ed73d13dd183-2"></a><span class="n">y</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<a id="rest_code_76116a44a2574bca8e27ed73d13dd183-3" name="rest_code_76116a44a2574bca8e27ed73d13dd183-3" href="../posts/visualising-the-wishart-distribution.html#rest_code_76116a44a2574bca8e27ed73d13dd183-3"></a><span class="n">z</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<a id="rest_code_76116a44a2574bca8e27ed73d13dd183-4" name="rest_code_76116a44a2574bca8e27ed73d13dd183-4" href="../posts/visualising-the-wishart-distribution.html#rest_code_76116a44a2574bca8e27ed73d13dd183-4"></a><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">n</span><span class="p">):</span>
<a id="rest_code_76116a44a2574bca8e27ed73d13dd183-5" name="rest_code_76116a44a2574bca8e27ed73d13dd183-5" href="../posts/visualising-the-wishart-distribution.html#rest_code_76116a44a2574bca8e27ed73d13dd183-5"></a>    <span class="n">M</span><span class="o">=</span><span class="n">st</span><span class="o">.</span><span class="n">wishart</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="n">scale</span><span class="o">=</span><span class="n">Sig1</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<a id="rest_code_76116a44a2574bca8e27ed73d13dd183-6" name="rest_code_76116a44a2574bca8e27ed73d13dd183-6" href="../posts/visualising-the-wishart-distribution.html#rest_code_76116a44a2574bca8e27ed73d13dd183-6"></a>    <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">M</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<a id="rest_code_76116a44a2574bca8e27ed73d13dd183-7" name="rest_code_76116a44a2574bca8e27ed73d13dd183-7" href="../posts/visualising-the-wishart-distribution.html#rest_code_76116a44a2574bca8e27ed73d13dd183-7"></a>    <span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">M</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
<a id="rest_code_76116a44a2574bca8e27ed73d13dd183-8" name="rest_code_76116a44a2574bca8e27ed73d13dd183-8" href="../posts/visualising-the-wishart-distribution.html#rest_code_76116a44a2574bca8e27ed73d13dd183-8"></a>    <span class="n">z</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">M</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<a id="rest_code_76116a44a2574bca8e27ed73d13dd183-9" name="rest_code_76116a44a2574bca8e27ed73d13dd183-9" href="../posts/visualising-the-wishart-distribution.html#rest_code_76116a44a2574bca8e27ed73d13dd183-9"></a><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<a id="rest_code_76116a44a2574bca8e27ed73d13dd183-10" name="rest_code_76116a44a2574bca8e27ed73d13dd183-10" href="../posts/visualising-the-wishart-distribution.html#rest_code_76116a44a2574bca8e27ed73d13dd183-10"></a><span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="s1">'3d'</span><span class="p">)</span>
<a id="rest_code_76116a44a2574bca8e27ed73d13dd183-11" name="rest_code_76116a44a2574bca8e27ed73d13dd183-11" href="../posts/visualising-the-wishart-distribution.html#rest_code_76116a44a2574bca8e27ed73d13dd183-11"></a><span class="n">ax</span><span class="o">.</span><span class="n">scatter3D</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">'o'</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="n">z</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">'seismic'</span><span class="p">)</span>
<a id="rest_code_76116a44a2574bca8e27ed73d13dd183-12" name="rest_code_76116a44a2574bca8e27ed73d13dd183-12" href="../posts/visualising-the-wishart-distribution.html#rest_code_76116a44a2574bca8e27ed73d13dd183-12"></a><span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">'V11'</span><span class="p">)</span>
<a id="rest_code_76116a44a2574bca8e27ed73d13dd183-13" name="rest_code_76116a44a2574bca8e27ed73d13dd183-13" href="../posts/visualising-the-wishart-distribution.html#rest_code_76116a44a2574bca8e27ed73d13dd183-13"></a><span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">'V22'</span><span class="p">)</span>
<a id="rest_code_76116a44a2574bca8e27ed73d13dd183-14" name="rest_code_76116a44a2574bca8e27ed73d13dd183-14" href="../posts/visualising-the-wishart-distribution.html#rest_code_76116a44a2574bca8e27ed73d13dd183-14"></a><span class="n">ax</span><span class="o">.</span><span class="n">set_zlabel</span><span class="p">(</span><span class="s1">'V12=V21'</span><span class="p">)</span>
<a id="rest_code_76116a44a2574bca8e27ed73d13dd183-15" name="rest_code_76116a44a2574bca8e27ed73d13dd183-15" href="../posts/visualising-the-wishart-distribution.html#rest_code_76116a44a2574bca8e27ed73d13dd183-15"></a><span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="mi">30</span><span class="p">))</span>
<a id="rest_code_76116a44a2574bca8e27ed73d13dd183-16" name="rest_code_76116a44a2574bca8e27ed73d13dd183-16" href="../posts/visualising-the-wishart-distribution.html#rest_code_76116a44a2574bca8e27ed73d13dd183-16"></a><span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="mi">70</span><span class="p">))</span>
<a id="rest_code_76116a44a2574bca8e27ed73d13dd183-17" name="rest_code_76116a44a2574bca8e27ed73d13dd183-17" href="../posts/visualising-the-wishart-distribution.html#rest_code_76116a44a2574bca8e27ed73d13dd183-17"></a><span class="n">ax</span><span class="o">.</span><span class="n">set_zlim</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="mi">30</span><span class="p">))</span>
<a id="rest_code_76116a44a2574bca8e27ed73d13dd183-18" name="rest_code_76116a44a2574bca8e27ed73d13dd183-18" href="../posts/visualising-the-wishart-distribution.html#rest_code_76116a44a2574bca8e27ed73d13dd183-18"></a><span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
<img alt="../output_5_0.png" src="../output_5_0.png">
</div>
            </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="../posts/mathematics-of-memes.html" class="u-url">Mathematics of Memes</a></h1>
                <div class="metadata">
                    <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                        Thomas House
                    </span></p>
            <p class="dateline">
            <a href="../posts/mathematics-of-memes.html" rel="bookmark">
            <time class="published dt-published" datetime="2017-09-20T12:38:56Z" itemprop="datePublished" title="2017-09-20 12:38">2017-09-20 12:38</time></a>
            </p>
                </div>
            </header><div class="e-content entry-content">
                    <p>Models of epidemics can be adapted to consider the spread of internet Memes - for more information see
the University <a class="reference external" href="http://www.manchester.ac.uk/discover/news/the-maths-behind-memes-why-numbers-could-help-us-predict-an-internet-sensation/">Press Release</a>.
Below is a figure showing some of these Memes 'in the wild'! We hope that the work will be possible to extend
to more substantial health-related behaviours, but Memes provide a relatively pure signal of the kind
of social influence that must be accounted for in such contexts, and as such are a good way to develop methods.</p>
<figure style="width: 480px"><img alt="Memes considered in the paper" src="../fig1.png"></figure><p>I also recently gave a talk at the local Galois Group (undergraduate mathematics) on the work:</p>
<p><span class="raw-html"><iframe src="//www.slideshare.net/slideshow/embed_code/key/oXVVGDFwrTNyQv" width="595" height="485" frameborder="0" marginwidth="0" marginheight="0" scrolling="no" style="border:1px solid #CCC; border-width:1px; margin-bottom:5px; max-width: 100%;" allowfullscreen> </iframe> <div style="margin-bottom:5px"> <strong> <a href="//www.slideshare.net/secret/oXVVGDFwrTNyQv" title="The Mathematics of Memes" target="_blank">The Mathematics of Memes</a> </strong> from <strong><a href="https://www.slideshare.net/ThomasHouse5" target="_blank">Thomas House</a></strong> </div></span></p>
                </div>
            </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="../posts/operationalising-modern-mathematical-epidemiology.html" class="u-url">Operationalising Modern Mathematical Epidemiology</a></h1>
                <div class="metadata">
                    <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                        Thomas House
                    </span></p>
            <p class="dateline">
            <a href="../posts/operationalising-modern-mathematical-epidemiology.html" rel="bookmark">
            <time class="published dt-published" datetime="2017-03-08T10:36:43Z" itemprop="datePublished" title="2017-03-08 10:36">2017-03-08 10:36</time></a>
            </p>
                </div>
            </header><div class="e-content entry-content">
                    <p>This month Liz Buckingham-Jeffery is joining me and Tim Kinyanjui to complete
the team for the EPSRC-funded project <em>Operationalising Modern Mathematical
Epidemiology</em>, which is a Healthcare Technologies Impact Fellowship I hold
(picture of us all below). The project is about development of some recent
ideas at developed by mathematical scientists to generate benefits in the
healthcare system.  We have non-academic partners from three major Manchester
hospitals (Central Manchester, North Manchester and the Christie), Public
Health England's national Real-time Syndromic Surveillance group, and a data
analytics firm Spectra Analytics. The first papers from this project are
starting be be submitted, and we have an ambitious programme of research and
impact-related activity over the next couple of years to ensure that the
potential benefits to population health from theoretical developments are
realised.</p>
<img alt="Me, Liz and Tim" src="../th_ebj_tmk.jpg" style="width: 600px;">
</div>
            </article>
</div>
    
        <ul class="pager postindexpager clearfix">
<li class="next"><a href="index-1.html" rel="next">Older posts</a></li>
        </ul>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML" integrity="sha384-3lJUsx1TJHt7BA4udB5KPnDrlkO8T6J6v/op7ui0BbCjvZ9WqV4Xm6DTP6kQ/iBH" crossorigin="anonymous"></script><script type="text/x-mathjax-config">
        MathJax.Hub.Config({tex2jax: {inlineMath: [['$latex ','$'], ['\\(','\\)']]}});
        </script><!--End of body content--><footer id="footer"></footer>
</div>
</div>


        <script src="../assets/js/all-nocdn.js"></script><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element){var i=element.getElementsByTagName('img')[0];return i===undefined?'':i.alt;}});
    </script>
</body>
</html>
