<?xml version="1.0" encoding="utf-8"?>
<?xml-stylesheet type="text/xsl" href="assets/xml/rss.xsl" media="all"?><rss version="2.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Thomas House's Personal Website</title><link>https://personalpages.manchester.ac.uk/staff/thomas.house/</link><description>Thomas House's Personal Website</description><atom:link href="https://personalpages.manchester.ac.uk/staff/thomas.house/rss.xml" rel="self" type="application/rss+xml"></atom:link><language>en</language><copyright>Contents ¬© 2023 &lt;a href="mailto:thomas.house@manchester.ac.uk"&gt;Thomas House&lt;/a&gt; </copyright><lastBuildDate>Wed, 27 Dec 2023 19:29:16 GMT</lastBuildDate><generator>Nikola (getnikola.com)</generator><docs>http://blogs.law.harvard.edu/tech/rss</docs><item><title>Seasonality and Immunity</title><link>https://personalpages.manchester.ac.uk/staff/thomas.house/posts/seasonality-and-immunity.html</link><dc:creator>Thomas House</dc:creator><description>&lt;p&gt;&lt;strong&gt;Note:&lt;/strong&gt; This blogpost was conceptualised in August 2021, and should be public
early in 2024. My attempts to do long-form outreach were somewhat put on hold
by work around the COVID pandemic. Anyway, with the problems going on atùïè(formerly Twitter), it's&lt;/p&gt;
&lt;img alt="Spring being pushed, with displacement z from equilibrium" class="align-right" src="https://personalpages.manchester.ac.uk/staff/thomas.house/spring.jpg" style="width: 240px;"&gt;
&lt;p&gt;So let's start by considering a weight on a spring as pictured - this is going to give us a physical 'model'
of disease dynamics for an endemic infection. The&lt;/p&gt;
&lt;p&gt;Now, &lt;span class="raw-html"&gt;\(F = ma\)&lt;/span&gt;, and so&lt;/p&gt;&lt;/body&gt;&lt;/html&gt;

&lt;img alt="Spring being pushed, with displacement z from equilibrium" class="align-right" src="https://personalpages.manchester.ac.uk/staff/thomas.house/spring.jpg" style="width: 240px;"&gt;
&lt;p&gt;So let's start by considering a weight on a spring as pictured - this is going to give us a physical 'model'
of disease dynamics for an endemic infection. The&lt;/p&gt;
&lt;p&gt;Now, &lt;span class="raw-html"&gt;\(F = ma\)&lt;/span&gt;, and so&lt;/p&gt;&lt;/body&gt;&lt;/html&gt;

&lt;p&gt;Now, &lt;span class="raw-html"&gt;\(F = ma\)&lt;/span&gt;, and so&lt;/p&gt;&lt;/body&gt;&lt;/html&gt;
</description><guid>https://personalpages.manchester.ac.uk/staff/thomas.house/posts/seasonality-and-immunity.html</guid><pubDate>Wed, 18 Aug 2021 18:33:04 GMT</pubDate></item><item><title>Why Zero is so Hard</title><link>https://personalpages.manchester.ac.uk/staff/thomas.house/posts/why-zero-is-so-hard.html</link><dc:creator>Thomas House</dc:creator><description>&lt;p&gt;The post on herd immunity on this blog discussed mitigation policies. Since
then, the world has moved on somewhat, and many people are talking about
long-term suppression of COVID-19, so how long might that take?&lt;/p&gt;
&lt;p&gt;Suppose we have &lt;span class="raw-html"&gt;\(N\)&lt;/span&gt; current COVID infections, the reproduction
number is &lt;span class="raw-html"&gt;\(R\)&lt;/span&gt;, the duration of infection is &lt;span class="raw-html"&gt;\(T\)&lt;/span&gt; and
we want to know the time &lt;span class="raw-html"&gt;\(t\)&lt;/span&gt; until the probability that there are
zero cases is &lt;span class="raw-html"&gt;\(p\)&lt;/span&gt;.&lt;/p&gt;
&lt;p&gt;If we model this as a Markovian birth-death chain, then the analytical result
for the time at which the given probability of extinction is reached is:
&lt;span class="raw-html"&gt;\[t(p,N,R) = \frac{T}{R-1} \ln\left( \frac{p^{1/N} - 1}{R p^{1/N} - 1}\right) \; . \]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;Results from this equation are shown in the Figure if we take 10 days from
infection to recovery; unfortunately, we need years with the reproduction number
less than one to get appreciable probabilities of of extinction. Of course, the
Markovian birth-death chain is too simple to be a realistic model of COVID. In
particular:&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;More infection happens several days after infection than in the initial days,
introducing additional delays;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Some population subgroups may have an effective reproduction number above 1;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;There will be imported cases from outside;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;There is variability in individual susceptibility and infectiousness;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Contact patterns are complex and heterogeneous.&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;These will influence the time to zero cases in different ways; but the 'inconvenient
truth' is that it takes an extremely long time to get to zero cases even if
&lt;span class="raw-html"&gt;\(R\)&lt;/span&gt; can be kept below one indefinitely.&lt;/p&gt;
&lt;figure style="width: 600px"&gt;
&lt;a class="reference external image-reference" href="https://personalpages.manchester.ac.uk/staff/thomas.house/covext2.png"&gt;&lt;img alt="Times until the a given probability of extinction" src="https://personalpages.manchester.ac.uk/staff/thomas.house/covext2.png"&gt;&lt;/a&gt;
&lt;figcaption&gt;
&lt;p&gt;Times until the a given probability of extinction as a function of the
initial number of cases and the reproduction number. Contour lines
correspond to 1, 2, 3, 5 and 10 years.&lt;/p&gt;
&lt;/figcaption&gt;
&lt;/figure&gt;&lt;/body&gt;&lt;/html&gt;

&lt;p&gt;Suppose we have &lt;span class="raw-html"&gt;\(N\)&lt;/span&gt; current COVID infections, the reproduction
number is &lt;span class="raw-html"&gt;\(R\)&lt;/span&gt;, the duration of infection is &lt;span class="raw-html"&gt;\(T\)&lt;/span&gt; and
we want to know the time &lt;span class="raw-html"&gt;\(t\)&lt;/span&gt; until the probability that there are
zero cases is &lt;span class="raw-html"&gt;\(p\)&lt;/span&gt;.&lt;/p&gt;
&lt;p&gt;If we model this as a Markovian birth-death chain, then the analytical result
for the time at which the given probability of extinction is reached is:
&lt;span class="raw-html"&gt;\[t(p,N,R) = \frac{T}{R-1} \ln\left( \frac{p^{1/N} - 1}{R p^{1/N} - 1}\right) \; . \]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;Results from this equation are shown in the Figure if we take 10 days from
infection to recovery; unfortunately, we need years with the reproduction number
less than one to get appreciable probabilities of of extinction. Of course, the
Markovian birth-death chain is too simple to be a realistic model of COVID. In
particular:&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;More infection happens several days after infection than in the initial days,
introducing additional delays;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Some population subgroups may have an effective reproduction number above 1;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;There will be imported cases from outside;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;There is variability in individual susceptibility and infectiousness;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Contact patterns are complex and heterogeneous.&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;These will influence the time to zero cases in different ways; but the 'inconvenient
truth' is that it takes an extremely long time to get to zero cases even if
&lt;span class="raw-html"&gt;\(R\)&lt;/span&gt; can be kept below one indefinitely.&lt;/p&gt;
&lt;figure style="width: 600px"&gt;
&lt;a class="reference external image-reference" href="https://personalpages.manchester.ac.uk/staff/thomas.house/covext2.png"&gt;&lt;img alt="Times until the a given probability of extinction" src="https://personalpages.manchester.ac.uk/staff/thomas.house/covext2.png"&gt;&lt;/a&gt;
&lt;figcaption&gt;
&lt;p&gt;Times until the a given probability of extinction as a function of the
initial number of cases and the reproduction number. Contour lines
correspond to 1, 2, 3, 5 and 10 years.&lt;/p&gt;
&lt;/figcaption&gt;
&lt;/figure&gt;&lt;/body&gt;&lt;/html&gt;

&lt;p&gt;If we model this as a Markovian birth-death chain, then the analytical result
for the time at which the given probability of extinction is reached is:
&lt;span class="raw-html"&gt;\[t(p,N,R) = \frac{T}{R-1} \ln\left( \frac{p^{1/N} - 1}{R p^{1/N} - 1}\right) \; . \]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;Results from this equation are shown in the Figure if we take 10 days from
infection to recovery; unfortunately, we need years with the reproduction number
less than one to get appreciable probabilities of of extinction. Of course, the
Markovian birth-death chain is too simple to be a realistic model of COVID. In
particular:&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;More infection happens several days after infection than in the initial days,
introducing additional delays;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Some population subgroups may have an effective reproduction number above 1;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;There will be imported cases from outside;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;There is variability in individual susceptibility and infectiousness;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Contact patterns are complex and heterogeneous.&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;These will influence the time to zero cases in different ways; but the 'inconvenient
truth' is that it takes an extremely long time to get to zero cases even if
&lt;span class="raw-html"&gt;\(R\)&lt;/span&gt; can be kept below one indefinitely.&lt;/p&gt;
&lt;figure style="width: 600px"&gt;
&lt;a class="reference external image-reference" href="https://personalpages.manchester.ac.uk/staff/thomas.house/covext2.png"&gt;&lt;img alt="Times until the a given probability of extinction" src="https://personalpages.manchester.ac.uk/staff/thomas.house/covext2.png"&gt;&lt;/a&gt;
&lt;figcaption&gt;
&lt;p&gt;Times until the a given probability of extinction as a function of the
initial number of cases and the reproduction number. Contour lines
correspond to 1, 2, 3, 5 and 10 years.&lt;/p&gt;
&lt;/figcaption&gt;
&lt;/figure&gt;&lt;/body&gt;&lt;/html&gt;

&lt;p&gt;Results from this equation are shown in the Figure if we take 10 days from
infection to recovery; unfortunately, we need years with the reproduction number
less than one to get appreciable probabilities of of extinction. Of course, the
Markovian birth-death chain is too simple to be a realistic model of COVID. In
particular:&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;More infection happens several days after infection than in the initial days,
introducing additional delays;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Some population subgroups may have an effective reproduction number above 1;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;There will be imported cases from outside;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;There is variability in individual susceptibility and infectiousness;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Contact patterns are complex and heterogeneous.&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;These will influence the time to zero cases in different ways; but the 'inconvenient
truth' is that it takes an extremely long time to get to zero cases even if
&lt;span class="raw-html"&gt;\(R\)&lt;/span&gt; can be kept below one indefinitely.&lt;/p&gt;
&lt;figure style="width: 600px"&gt;
&lt;a class="reference external image-reference" href="https://personalpages.manchester.ac.uk/staff/thomas.house/covext2.png"&gt;&lt;img alt="Times until the a given probability of extinction" src="https://personalpages.manchester.ac.uk/staff/thomas.house/covext2.png"&gt;&lt;/a&gt;
&lt;figcaption&gt;
&lt;p&gt;Times until the a given probability of extinction as a function of the
initial number of cases and the reproduction number. Contour lines
correspond to 1, 2, 3, 5 and 10 years.&lt;/p&gt;
&lt;/figcaption&gt;
&lt;/figure&gt;&lt;/body&gt;&lt;/html&gt;

&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;More infection happens several days after infection than in the initial days,
introducing additional delays;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Some population subgroups may have an effective reproduction number above 1;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;There will be imported cases from outside;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;There is variability in individual susceptibility and infectiousness;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Contact patterns are complex and heterogeneous.&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;These will influence the time to zero cases in different ways; but the 'inconvenient
truth' is that it takes an extremely long time to get to zero cases even if
&lt;span class="raw-html"&gt;\(R\)&lt;/span&gt; can be kept below one indefinitely.&lt;/p&gt;
&lt;figure style="width: 600px"&gt;
&lt;a class="reference external image-reference" href="https://personalpages.manchester.ac.uk/staff/thomas.house/covext2.png"&gt;&lt;img alt="Times until the a given probability of extinction" src="https://personalpages.manchester.ac.uk/staff/thomas.house/covext2.png"&gt;&lt;/a&gt;
&lt;figcaption&gt;
&lt;p&gt;Times until the a given probability of extinction as a function of the
initial number of cases and the reproduction number. Contour lines
correspond to 1, 2, 3, 5 and 10 years.&lt;/p&gt;
&lt;/figcaption&gt;
&lt;/figure&gt;&lt;/body&gt;&lt;/html&gt;

&lt;p&gt;These will influence the time to zero cases in different ways; but the 'inconvenient
truth' is that it takes an extremely long time to get to zero cases even if
&lt;span class="raw-html"&gt;\(R\)&lt;/span&gt; can be kept below one indefinitely.&lt;/p&gt;
&lt;figure style="width: 600px"&gt;
&lt;a class="reference external image-reference" href="https://personalpages.manchester.ac.uk/staff/thomas.house/covext2.png"&gt;&lt;img alt="Times until the a given probability of extinction" src="https://personalpages.manchester.ac.uk/staff/thomas.house/covext2.png"&gt;&lt;/a&gt;
&lt;figcaption&gt;
&lt;p&gt;Times until the a given probability of extinction as a function of the
initial number of cases and the reproduction number. Contour lines
correspond to 1, 2, 3, 5 and 10 years.&lt;/p&gt;
&lt;/figcaption&gt;
&lt;/figure&gt;&lt;/body&gt;&lt;/html&gt;

&lt;figure style="width: 600px"&gt;
&lt;a class="reference external image-reference" href="https://personalpages.manchester.ac.uk/staff/thomas.house/covext2.png"&gt;&lt;img alt="Times until the a given probability of extinction" src="https://personalpages.manchester.ac.uk/staff/thomas.house/covext2.png"&gt;&lt;/a&gt;
&lt;figcaption&gt;
&lt;p&gt;Times until the a given probability of extinction as a function of the
initial number of cases and the reproduction number. Contour lines
correspond to 1, 2, 3, 5 and 10 years.&lt;/p&gt;
&lt;/figcaption&gt;
&lt;/figure&gt;&lt;/body&gt;&lt;/html&gt;
</description><guid>https://personalpages.manchester.ac.uk/staff/thomas.house/posts/why-zero-is-so-hard.html</guid><pubDate>Mon, 10 Aug 2020 21:18:21 GMT</pubDate></item><item><title>Modelling Herd Immunity</title><link>https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html</link><dc:creator>Thomas House</dc:creator><description>&lt;p&gt;The current coronavirus outbreak (COVID-19) has raised questions about herd
immunity, social distancing measures, and the relationship between these. In
particular, at time of writing the following Tweet has thousands of retweets
and likes.&lt;/p&gt;
&lt;p&gt;&lt;span class="raw-html"&gt;&lt;blockquote class="twitter-tweet"&gt;&lt;p lang="en" dir="ltr"&gt;‚ÄúWith the number of known &lt;a href="https://twitter.com/hashtag/coronavirus?src=hash&amp;amp;ref_src=twsrc%5Etfw"&gt;#coronavirus&lt;/a&gt; cases today in South Korea, Italy, Iran, France, Spain and the US, Wuhan was already in lockdown.‚Äù&lt;br&gt;&lt;br&gt;Read why every day we wait to make decisions is costlier that‚Äôs the previous:&lt;a href="https://t.co/6hX74wiZgF"&gt;https://t.co/6hX74wiZgF&lt;/a&gt;&lt;/p&gt;‚Äî Tomas Pueyo (@tomaspueyo) &lt;a href="https://twitter.com/tomaspueyo/status/1237421094912397314?ref_src=twsrc%5Etfw"&gt;March 10, 2020&lt;/a&gt;&lt;/blockquote&gt; &lt;script async src="https://platform.twitter.com/widgets.js" charset="utf-8"&gt;&lt;/script&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;I think that this presents an incomplete picture of the policy considerations.&lt;/p&gt;
&lt;img alt="Before herd immunity" class="align-left" src="https://personalpages.manchester.ac.uk/staff/thomas.house/Herd.png" style="width: 240px;"&gt;
&lt;img alt="After herd immunity" class="align-right" src="https://personalpages.manchester.ac.uk/staff/thomas.house/Herd2.png" style="width: 240px;"&gt;
&lt;p&gt;To see why, let us start by defining the most important concept in epidemic
modelling, the basic reproduction number &lt;span class="raw-html"&gt;\(R_0\)&lt;/span&gt;. This is equal to
the average number of infections caused by a case early in the epidemic, so that
for &lt;span class="raw-html"&gt;\(R_0 = 3\)&lt;/span&gt;, the early transmission tree might look something like
the cartoon on the left. This exhibits the exponential growth that is so worrying
at present. We have first one case, then three, then nine, then 27, then ...&lt;/p&gt;
&lt;p&gt;Now suppose that immunity has been built up, either through vaccination or by
illness followed by recovery, so that two thirds of people are immune. This
means that each case will have three contacts that would have caused infection
in the absence of immunity, but on average two of these will be immune and so
the situation looks more like the cartoon on the right. We say that the
reproduction number is reduced from its basic value to &lt;span class="raw-html"&gt;\(R_t = 1\)&lt;/span&gt;.&lt;/p&gt;
&lt;p&gt;While the individuals in the cartoon with a crossed out arrow pointing towards
them are literally immune, the people that they would have infected benefit
from &lt;strong&gt;herd immunity&lt;/strong&gt;. They can be infected if exposed, but will not be. This
is particularly beneficial to the people who are particularly vulnerable to the
disease, who might die if they catch it. The general formula for herd immunity
is that when over &lt;span class="raw-html"&gt;\((1 - (1/R_0))\times 100\%\)&lt;/span&gt; of the population
is immune, then the epidemic will start to die out.&lt;/p&gt;
&lt;p&gt;Now suppose we simulate a more realistic scenario. The Python code for this is
at the bottom of this post, and it is much simpler than the models that are
typically used to guide policy, but captures the basic phenomena of interest.
In particular, we suppose that we can reduce transmission through social
distancing measures like closing schools and workplaces, but that this is only
possible for three weeks. This represents the fact that the costs of not
educating children and not doing other activities can become quite large over
time, and in some cases can lead to levels death and illness that could exceed
those due to the unchecked epidemic. Running the epidemic model with these
interventions gives the following results for cases at a given moment and total
cases over time.&lt;/p&gt;
&lt;img alt="../output_5.png" src="https://personalpages.manchester.ac.uk/staff/thomas.house/output_5.png"&gt;
&lt;p&gt;It seems that the Tweet was right - look at the difference the early intervention
makes! But now let us zoom out of the graph; then the picture looks like the below.&lt;/p&gt;
&lt;img alt="../output_6_0.png" src="https://personalpages.manchester.ac.uk/staff/thomas.house/output_6_0.png"&gt;
&lt;p&gt;In fact, the later intervention dramatically reduces the burden on the healthcare
system, cutting in half the maximum numbers ill and potentially needing treatment
at any one time, and significantly reduces the final number infected, which the
earlier interventions fail to do.&lt;/p&gt;
&lt;p&gt;The reason that this happens is that social distancing measures do not lead to herd
immunity, so once they are lifted the epidemic starts again. In the absence of a
vaccine, it is therefore meaningless to speak about whether a policy 'aims' to get
herd immunity or not, since every country in the world will reach herd immunity
unless it is able to implement social distancing for an indefinite period of time.&lt;/p&gt;
&lt;p&gt;What mitigation policies should aim to do, therefore, is to reach herd immunity
with the minimal human cost. This will be extremely difficult, and at every
stage we will be dealing with large uncertainties. I would not want to be the
person who ultimately made the policy decisions. But to say that early
interventions are always better is incorrect.&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code ipython3"&gt;&lt;a id="rest_code_a60b412ba835495c84442a608a58c6ec-1" name="rest_code_a60b412ba835495c84442a608a58c6ec-1" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a60b412ba835495c84442a608a58c6ec-1"&gt;&lt;/a&gt;&lt;span class="c1"&gt;# Pull in libraries needed&lt;/span&gt;
&lt;a id="rest_code_a60b412ba835495c84442a608a58c6ec-2" name="rest_code_a60b412ba835495c84442a608a58c6ec-2" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a60b412ba835495c84442a608a58c6ec-2"&gt;&lt;/a&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="k"&gt;matplotlib&lt;/span&gt; inline
&lt;a id="rest_code_a60b412ba835495c84442a608a58c6ec-3" name="rest_code_a60b412ba835495c84442a608a58c6ec-3" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a60b412ba835495c84442a608a58c6ec-3"&gt;&lt;/a&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;numpy&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;np&lt;/span&gt;
&lt;a id="rest_code_a60b412ba835495c84442a608a58c6ec-4" name="rest_code_a60b412ba835495c84442a608a58c6ec-4" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a60b412ba835495c84442a608a58c6ec-4"&gt;&lt;/a&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;scipy&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;integrate&lt;/span&gt;
&lt;a id="rest_code_a60b412ba835495c84442a608a58c6ec-5" name="rest_code_a60b412ba835495c84442a608a58c6ec-5" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a60b412ba835495c84442a608a58c6ec-5"&gt;&lt;/a&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;matplotlib.pyplot&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;plt&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="code"&gt;&lt;pre class="code ipython3"&gt;&lt;a id="rest_code_50ccf7005e66491dbad8d1af960e52e0-1" name="rest_code_50ccf7005e66491dbad8d1af960e52e0-1" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_50ccf7005e66491dbad8d1af960e52e0-1"&gt;&lt;/a&gt;&lt;span class="c1"&gt;# Represent the basic dynamics&lt;/span&gt;
&lt;a id="rest_code_50ccf7005e66491dbad8d1af960e52e0-2" name="rest_code_50ccf7005e66491dbad8d1af960e52e0-2" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_50ccf7005e66491dbad8d1af960e52e0-2"&gt;&lt;/a&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;odefun&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;beta0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;betat&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;t0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;t1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;sigma&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;gamma&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_50ccf7005e66491dbad8d1af960e52e0-3" name="rest_code_50ccf7005e66491dbad8d1af960e52e0-3" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_50ccf7005e66491dbad8d1af960e52e0-3"&gt;&lt;/a&gt;    &lt;span class="n"&gt;dx&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;6&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_50ccf7005e66491dbad8d1af960e52e0-4" name="rest_code_50ccf7005e66491dbad8d1af960e52e0-4" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_50ccf7005e66491dbad8d1af960e52e0-4"&gt;&lt;/a&gt;    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;=&lt;/span&gt;&lt;span class="n"&gt;t0&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="ow"&gt;and&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;=&lt;/span&gt;&lt;span class="n"&gt;t1&lt;/span&gt;&lt;span class="p"&gt;)):&lt;/span&gt;
&lt;a id="rest_code_50ccf7005e66491dbad8d1af960e52e0-5" name="rest_code_50ccf7005e66491dbad8d1af960e52e0-5" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_50ccf7005e66491dbad8d1af960e52e0-5"&gt;&lt;/a&gt;        &lt;span class="n"&gt;beta&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;betat&lt;/span&gt;
&lt;a id="rest_code_50ccf7005e66491dbad8d1af960e52e0-6" name="rest_code_50ccf7005e66491dbad8d1af960e52e0-6" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_50ccf7005e66491dbad8d1af960e52e0-6"&gt;&lt;/a&gt;    &lt;span class="k"&gt;else&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a id="rest_code_50ccf7005e66491dbad8d1af960e52e0-7" name="rest_code_50ccf7005e66491dbad8d1af960e52e0-7" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_50ccf7005e66491dbad8d1af960e52e0-7"&gt;&lt;/a&gt;        &lt;span class="n"&gt;beta&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;beta0&lt;/span&gt;
&lt;a id="rest_code_50ccf7005e66491dbad8d1af960e52e0-8" name="rest_code_50ccf7005e66491dbad8d1af960e52e0-8" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_50ccf7005e66491dbad8d1af960e52e0-8"&gt;&lt;/a&gt;    &lt;span class="n"&gt;dx&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;beta&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_50ccf7005e66491dbad8d1af960e52e0-9" name="rest_code_50ccf7005e66491dbad8d1af960e52e0-9" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_50ccf7005e66491dbad8d1af960e52e0-9"&gt;&lt;/a&gt;    &lt;span class="n"&gt;dx&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;beta&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;sigma&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_50ccf7005e66491dbad8d1af960e52e0-10" name="rest_code_50ccf7005e66491dbad8d1af960e52e0-10" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_50ccf7005e66491dbad8d1af960e52e0-10"&gt;&lt;/a&gt;    &lt;span class="n"&gt;dx&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;sigma&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;sigma&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_50ccf7005e66491dbad8d1af960e52e0-11" name="rest_code_50ccf7005e66491dbad8d1af960e52e0-11" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_50ccf7005e66491dbad8d1af960e52e0-11"&gt;&lt;/a&gt;    &lt;span class="n"&gt;dx&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;sigma&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;gamma&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_50ccf7005e66491dbad8d1af960e52e0-12" name="rest_code_50ccf7005e66491dbad8d1af960e52e0-12" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_50ccf7005e66491dbad8d1af960e52e0-12"&gt;&lt;/a&gt;    &lt;span class="n"&gt;dx&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;gamma&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;gamma&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_50ccf7005e66491dbad8d1af960e52e0-13" name="rest_code_50ccf7005e66491dbad8d1af960e52e0-13" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_50ccf7005e66491dbad8d1af960e52e0-13"&gt;&lt;/a&gt;    &lt;span class="n"&gt;dx&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;gamma&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_50ccf7005e66491dbad8d1af960e52e0-14" name="rest_code_50ccf7005e66491dbad8d1af960e52e0-14" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_50ccf7005e66491dbad8d1af960e52e0-14"&gt;&lt;/a&gt;    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;dx&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="code"&gt;&lt;pre class="code ipython3"&gt;&lt;a id="rest_code_235f3c6356b64e44a3496d2d004cdec2-1" name="rest_code_235f3c6356b64e44a3496d2d004cdec2-1" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_235f3c6356b64e44a3496d2d004cdec2-1"&gt;&lt;/a&gt;&lt;span class="c1"&gt;# Parameters of the model&lt;/span&gt;
&lt;a id="rest_code_235f3c6356b64e44a3496d2d004cdec2-2" name="rest_code_235f3c6356b64e44a3496d2d004cdec2-2" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_235f3c6356b64e44a3496d2d004cdec2-2"&gt;&lt;/a&gt;&lt;span class="n"&gt;N&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;6.7e7&lt;/span&gt; &lt;span class="c1"&gt;# Total population&lt;/span&gt;
&lt;a id="rest_code_235f3c6356b64e44a3496d2d004cdec2-3" name="rest_code_235f3c6356b64e44a3496d2d004cdec2-3" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_235f3c6356b64e44a3496d2d004cdec2-3"&gt;&lt;/a&gt;&lt;span class="n"&gt;i0&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;1e-4&lt;/span&gt; &lt;span class="c1"&gt;# 0.5*Proportion of the population infected on day 0&lt;/span&gt;
&lt;a id="rest_code_235f3c6356b64e44a3496d2d004cdec2-4" name="rest_code_235f3c6356b64e44a3496d2d004cdec2-4" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_235f3c6356b64e44a3496d2d004cdec2-4"&gt;&lt;/a&gt;&lt;span class="n"&gt;tlast&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;365.0&lt;/span&gt; &lt;span class="c1"&gt;# Consider a year&lt;/span&gt;
&lt;a id="rest_code_235f3c6356b64e44a3496d2d004cdec2-5" name="rest_code_235f3c6356b64e44a3496d2d004cdec2-5" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_235f3c6356b64e44a3496d2d004cdec2-5"&gt;&lt;/a&gt;&lt;span class="n"&gt;latent_period&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;5.0&lt;/span&gt; &lt;span class="c1"&gt;# Days between being infected and becoming infectious&lt;/span&gt;
&lt;a id="rest_code_235f3c6356b64e44a3496d2d004cdec2-6" name="rest_code_235f3c6356b64e44a3496d2d004cdec2-6" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_235f3c6356b64e44a3496d2d004cdec2-6"&gt;&lt;/a&gt;&lt;span class="n"&gt;infectious_period&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;7.0&lt;/span&gt; &lt;span class="c1"&gt;# Days infectious&lt;/span&gt;
&lt;a id="rest_code_235f3c6356b64e44a3496d2d004cdec2-7" name="rest_code_235f3c6356b64e44a3496d2d004cdec2-7" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_235f3c6356b64e44a3496d2d004cdec2-7"&gt;&lt;/a&gt;&lt;span class="n"&gt;R0&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;2.5&lt;/span&gt; &lt;span class="c1"&gt;# Basic reproduction number in the absence of interventions&lt;/span&gt;
&lt;a id="rest_code_235f3c6356b64e44a3496d2d004cdec2-8" name="rest_code_235f3c6356b64e44a3496d2d004cdec2-8" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_235f3c6356b64e44a3496d2d004cdec2-8"&gt;&lt;/a&gt;&lt;span class="n"&gt;Rt&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;0.75&lt;/span&gt; &lt;span class="c1"&gt;# Reproduction number in the presence of interventions&lt;/span&gt;
&lt;a id="rest_code_235f3c6356b64e44a3496d2d004cdec2-9" name="rest_code_235f3c6356b64e44a3496d2d004cdec2-9" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_235f3c6356b64e44a3496d2d004cdec2-9"&gt;&lt;/a&gt;&lt;span class="n"&gt;tend&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;21.0&lt;/span&gt; &lt;span class="c1"&gt;# Number of days of interventions&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="code"&gt;&lt;pre class="code ipython3"&gt;&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-1" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-1" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-1"&gt;&lt;/a&gt;&lt;span class="n"&gt;beta0&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;R0&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="n"&gt;infectious_period&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-2" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-2" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-2"&gt;&lt;/a&gt;&lt;span class="n"&gt;betat&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Rt&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="n"&gt;infectious_period&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-3" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-3" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-3"&gt;&lt;/a&gt;&lt;span class="n"&gt;sigma&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;2.0&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="n"&gt;latent_period&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-4" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-4" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-4"&gt;&lt;/a&gt;&lt;span class="n"&gt;gamma&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;2.0&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="n"&gt;infectious_period&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-5" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-5" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-5"&gt;&lt;/a&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-6" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-6" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-6"&gt;&lt;/a&gt;&lt;span class="n"&gt;t0ran&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;array&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;100&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;40&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;52.5&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;65&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-7" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-7" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-7"&gt;&lt;/a&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-8" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-8" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-8"&gt;&lt;/a&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;mylab&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-9" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-9" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-9"&gt;&lt;/a&gt;    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-10" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-10" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-10"&gt;&lt;/a&gt;        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="s2"&gt;"Start at "&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="nb"&gt;str&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="s2"&gt;" days"&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-11" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-11" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-11"&gt;&lt;/a&gt;    &lt;span class="k"&gt;else&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-12" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-12" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-12"&gt;&lt;/a&gt;        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="s2"&gt;"Baseline"&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-13" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-13" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-13"&gt;&lt;/a&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-14" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-14" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-14"&gt;&lt;/a&gt;&lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;[]&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-15" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-15" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-15"&gt;&lt;/a&gt;&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;tt&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t0ran&lt;/span&gt;&lt;span class="p"&gt;)):&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-16" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-16" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-16"&gt;&lt;/a&gt;    &lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;append&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;integrate&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;solve_ivp&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;lambda&lt;/span&gt; &lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;odefun&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;beta0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;betat&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;t0ran&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;&lt;span class="n"&gt;t0ran&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="n"&gt;tend&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;sigma&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;gamma&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-17" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-17" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-17"&gt;&lt;/a&gt;                              &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;0.0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;tlast&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-18" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-18" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-18"&gt;&lt;/a&gt;                              &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;array&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="mf"&gt;1.0&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;2.0&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;i0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;0.0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;0.0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;i0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;i0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;0.0&lt;/span&gt;&lt;span class="p"&gt;]),&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-19" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-19" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-19"&gt;&lt;/a&gt;                              &lt;span class="s1"&gt;'RK45'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-20" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-20" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-20"&gt;&lt;/a&gt;                              &lt;span class="n"&gt;atol&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mf"&gt;1e-8&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-21" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-21" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-21"&gt;&lt;/a&gt;                              &lt;span class="n"&gt;rtol&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mf"&gt;1e-9&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="code"&gt;&lt;pre class="code ipython3"&gt;&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-1" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-1" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-1"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;figure&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;figsize&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-2" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-2" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-2"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;subplot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-3" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-3" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-3"&gt;&lt;/a&gt;&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;tt&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t0ran&lt;/span&gt;&lt;span class="p"&gt;)):&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-4" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-4" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-4"&gt;&lt;/a&gt;    &lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;plot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;T&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;label&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;mylab&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t0ran&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]))&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-5" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-5" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-5"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xlim&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="mi"&gt;30&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;70&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-6" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-6" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-6"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ylim&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mf"&gt;7e6&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-7" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-7" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-7"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'Time (days)'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-8" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-8" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-8"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ylabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'Number of infectious cases'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-9" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-9" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-9"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;legend&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-10" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-10" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-10"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;subplot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-11" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-11" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-11"&gt;&lt;/a&gt;&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;tt&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t0ran&lt;/span&gt;&lt;span class="p"&gt;)):&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-12" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-12" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-12"&gt;&lt;/a&gt;    &lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;plot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;T&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;label&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;mylab&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t0ran&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]))&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-13" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-13" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-13"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'Time (days)'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-14" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-14" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-14"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ylabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'Cumulative infections'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-15" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-15" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-15"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;legend&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-16" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-16" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-16"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xlim&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="mi"&gt;30&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;70&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-17" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-17" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-17"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ylim&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mf"&gt;1e7&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-18" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-18" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-18"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;tight_layout&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-19" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-19" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-19"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;show&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="code"&gt;&lt;pre class="code ipython3"&gt;&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-1" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-1" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-1"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;figure&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;figsize&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-2" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-2" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-2"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;subplot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-3" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-3" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-3"&gt;&lt;/a&gt;&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;tt&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t0ran&lt;/span&gt;&lt;span class="p"&gt;)):&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-4" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-4" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-4"&gt;&lt;/a&gt;    &lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;plot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;T&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;label&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;mylab&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t0ran&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]))&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-5" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-5" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-5"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xlim&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;tlast&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-6" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-6" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-6"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ylim&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mf"&gt;1.2e7&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-7" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-7" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-7"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'Time (days)'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-8" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-8" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-8"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ylabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'Number of infectious cases'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-9" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-9" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-9"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;legend&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-10" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-10" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-10"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;subplot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-11" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-11" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-11"&gt;&lt;/a&gt;&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;tt&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t0ran&lt;/span&gt;&lt;span class="p"&gt;)):&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-12" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-12" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-12"&gt;&lt;/a&gt;    &lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;plot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;T&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;label&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;mylab&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t0ran&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]))&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-13" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-13" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-13"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'Time (days)'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-14" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-14" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-14"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ylabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'Cumulative infections'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-15" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-15" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-15"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;legend&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-16" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-16" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-16"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xlim&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;tlast&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-17" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-17" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-17"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ylim&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mf"&gt;6.2e7&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-18" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-18" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-18"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;tight_layout&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-19" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-19" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-19"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;show&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;&lt;/body&gt;&lt;/html&gt;

&lt;p&gt;&lt;span class="raw-html"&gt;&lt;blockquote class="twitter-tweet"&gt;&lt;p lang="en" dir="ltr"&gt;‚ÄúWith the number of known &lt;a href="https://twitter.com/hashtag/coronavirus?src=hash&amp;amp;ref_src=twsrc%5Etfw"&gt;#coronavirus&lt;/a&gt; cases today in South Korea, Italy, Iran, France, Spain and the US, Wuhan was already in lockdown.‚Äù&lt;br&gt;&lt;br&gt;Read why every day we wait to make decisions is costlier that‚Äôs the previous:&lt;a href="https://t.co/6hX74wiZgF"&gt;https://t.co/6hX74wiZgF&lt;/a&gt;&lt;/p&gt;‚Äî Tomas Pueyo (@tomaspueyo) &lt;a href="https://twitter.com/tomaspueyo/status/1237421094912397314?ref_src=twsrc%5Etfw"&gt;March 10, 2020&lt;/a&gt;&lt;/blockquote&gt; &lt;script async src="https://platform.twitter.com/widgets.js" charset="utf-8"&gt;&lt;/script&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;I think that this presents an incomplete picture of the policy considerations.&lt;/p&gt;
&lt;img alt="Before herd immunity" class="align-left" src="https://personalpages.manchester.ac.uk/staff/thomas.house/Herd.png" style="width: 240px;"&gt;
&lt;img alt="After herd immunity" class="align-right" src="https://personalpages.manchester.ac.uk/staff/thomas.house/Herd2.png" style="width: 240px;"&gt;
&lt;p&gt;To see why, let us start by defining the most important concept in epidemic
modelling, the basic reproduction number &lt;span class="raw-html"&gt;\(R_0\)&lt;/span&gt;. This is equal to
the average number of infections caused by a case early in the epidemic, so that
for &lt;span class="raw-html"&gt;\(R_0 = 3\)&lt;/span&gt;, the early transmission tree might look something like
the cartoon on the left. This exhibits the exponential growth that is so worrying
at present. We have first one case, then three, then nine, then 27, then ...&lt;/p&gt;
&lt;p&gt;Now suppose that immunity has been built up, either through vaccination or by
illness followed by recovery, so that two thirds of people are immune. This
means that each case will have three contacts that would have caused infection
in the absence of immunity, but on average two of these will be immune and so
the situation looks more like the cartoon on the right. We say that the
reproduction number is reduced from its basic value to &lt;span class="raw-html"&gt;\(R_t = 1\)&lt;/span&gt;.&lt;/p&gt;
&lt;p&gt;While the individuals in the cartoon with a crossed out arrow pointing towards
them are literally immune, the people that they would have infected benefit
from &lt;strong&gt;herd immunity&lt;/strong&gt;. They can be infected if exposed, but will not be. This
is particularly beneficial to the people who are particularly vulnerable to the
disease, who might die if they catch it. The general formula for herd immunity
is that when over &lt;span class="raw-html"&gt;\((1 - (1/R_0))\times 100\%\)&lt;/span&gt; of the population
is immune, then the epidemic will start to die out.&lt;/p&gt;
&lt;p&gt;Now suppose we simulate a more realistic scenario. The Python code for this is
at the bottom of this post, and it is much simpler than the models that are
typically used to guide policy, but captures the basic phenomena of interest.
In particular, we suppose that we can reduce transmission through social
distancing measures like closing schools and workplaces, but that this is only
possible for three weeks. This represents the fact that the costs of not
educating children and not doing other activities can become quite large over
time, and in some cases can lead to levels death and illness that could exceed
those due to the unchecked epidemic. Running the epidemic model with these
interventions gives the following results for cases at a given moment and total
cases over time.&lt;/p&gt;
&lt;img alt="../output_5.png" src="https://personalpages.manchester.ac.uk/staff/thomas.house/output_5.png"&gt;
&lt;p&gt;It seems that the Tweet was right - look at the difference the early intervention
makes! But now let us zoom out of the graph; then the picture looks like the below.&lt;/p&gt;
&lt;img alt="../output_6_0.png" src="https://personalpages.manchester.ac.uk/staff/thomas.house/output_6_0.png"&gt;
&lt;p&gt;In fact, the later intervention dramatically reduces the burden on the healthcare
system, cutting in half the maximum numbers ill and potentially needing treatment
at any one time, and significantly reduces the final number infected, which the
earlier interventions fail to do.&lt;/p&gt;
&lt;p&gt;The reason that this happens is that social distancing measures do not lead to herd
immunity, so once they are lifted the epidemic starts again. In the absence of a
vaccine, it is therefore meaningless to speak about whether a policy 'aims' to get
herd immunity or not, since every country in the world will reach herd immunity
unless it is able to implement social distancing for an indefinite period of time.&lt;/p&gt;
&lt;p&gt;What mitigation policies should aim to do, therefore, is to reach herd immunity
with the minimal human cost. This will be extremely difficult, and at every
stage we will be dealing with large uncertainties. I would not want to be the
person who ultimately made the policy decisions. But to say that early
interventions are always better is incorrect.&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code ipython3"&gt;&lt;a id="rest_code_a60b412ba835495c84442a608a58c6ec-1" name="rest_code_a60b412ba835495c84442a608a58c6ec-1" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a60b412ba835495c84442a608a58c6ec-1"&gt;&lt;/a&gt;&lt;span class="c1"&gt;# Pull in libraries needed&lt;/span&gt;
&lt;a id="rest_code_a60b412ba835495c84442a608a58c6ec-2" name="rest_code_a60b412ba835495c84442a608a58c6ec-2" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a60b412ba835495c84442a608a58c6ec-2"&gt;&lt;/a&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="k"&gt;matplotlib&lt;/span&gt; inline
&lt;a id="rest_code_a60b412ba835495c84442a608a58c6ec-3" name="rest_code_a60b412ba835495c84442a608a58c6ec-3" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a60b412ba835495c84442a608a58c6ec-3"&gt;&lt;/a&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;numpy&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;np&lt;/span&gt;
&lt;a id="rest_code_a60b412ba835495c84442a608a58c6ec-4" name="rest_code_a60b412ba835495c84442a608a58c6ec-4" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a60b412ba835495c84442a608a58c6ec-4"&gt;&lt;/a&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;scipy&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;integrate&lt;/span&gt;
&lt;a id="rest_code_a60b412ba835495c84442a608a58c6ec-5" name="rest_code_a60b412ba835495c84442a608a58c6ec-5" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a60b412ba835495c84442a608a58c6ec-5"&gt;&lt;/a&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;matplotlib.pyplot&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;plt&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="code"&gt;&lt;pre class="code ipython3"&gt;&lt;a id="rest_code_50ccf7005e66491dbad8d1af960e52e0-1" name="rest_code_50ccf7005e66491dbad8d1af960e52e0-1" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_50ccf7005e66491dbad8d1af960e52e0-1"&gt;&lt;/a&gt;&lt;span class="c1"&gt;# Represent the basic dynamics&lt;/span&gt;
&lt;a id="rest_code_50ccf7005e66491dbad8d1af960e52e0-2" name="rest_code_50ccf7005e66491dbad8d1af960e52e0-2" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_50ccf7005e66491dbad8d1af960e52e0-2"&gt;&lt;/a&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;odefun&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;beta0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;betat&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;t0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;t1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;sigma&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;gamma&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_50ccf7005e66491dbad8d1af960e52e0-3" name="rest_code_50ccf7005e66491dbad8d1af960e52e0-3" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_50ccf7005e66491dbad8d1af960e52e0-3"&gt;&lt;/a&gt;    &lt;span class="n"&gt;dx&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;6&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_50ccf7005e66491dbad8d1af960e52e0-4" name="rest_code_50ccf7005e66491dbad8d1af960e52e0-4" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_50ccf7005e66491dbad8d1af960e52e0-4"&gt;&lt;/a&gt;    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;=&lt;/span&gt;&lt;span class="n"&gt;t0&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="ow"&gt;and&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;=&lt;/span&gt;&lt;span class="n"&gt;t1&lt;/span&gt;&lt;span class="p"&gt;)):&lt;/span&gt;
&lt;a id="rest_code_50ccf7005e66491dbad8d1af960e52e0-5" name="rest_code_50ccf7005e66491dbad8d1af960e52e0-5" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_50ccf7005e66491dbad8d1af960e52e0-5"&gt;&lt;/a&gt;        &lt;span class="n"&gt;beta&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;betat&lt;/span&gt;
&lt;a id="rest_code_50ccf7005e66491dbad8d1af960e52e0-6" name="rest_code_50ccf7005e66491dbad8d1af960e52e0-6" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_50ccf7005e66491dbad8d1af960e52e0-6"&gt;&lt;/a&gt;    &lt;span class="k"&gt;else&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a id="rest_code_50ccf7005e66491dbad8d1af960e52e0-7" name="rest_code_50ccf7005e66491dbad8d1af960e52e0-7" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_50ccf7005e66491dbad8d1af960e52e0-7"&gt;&lt;/a&gt;        &lt;span class="n"&gt;beta&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;beta0&lt;/span&gt;
&lt;a id="rest_code_50ccf7005e66491dbad8d1af960e52e0-8" name="rest_code_50ccf7005e66491dbad8d1af960e52e0-8" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_50ccf7005e66491dbad8d1af960e52e0-8"&gt;&lt;/a&gt;    &lt;span class="n"&gt;dx&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;beta&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_50ccf7005e66491dbad8d1af960e52e0-9" name="rest_code_50ccf7005e66491dbad8d1af960e52e0-9" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_50ccf7005e66491dbad8d1af960e52e0-9"&gt;&lt;/a&gt;    &lt;span class="n"&gt;dx&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;beta&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;sigma&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_50ccf7005e66491dbad8d1af960e52e0-10" name="rest_code_50ccf7005e66491dbad8d1af960e52e0-10" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_50ccf7005e66491dbad8d1af960e52e0-10"&gt;&lt;/a&gt;    &lt;span class="n"&gt;dx&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;sigma&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;sigma&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_50ccf7005e66491dbad8d1af960e52e0-11" name="rest_code_50ccf7005e66491dbad8d1af960e52e0-11" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_50ccf7005e66491dbad8d1af960e52e0-11"&gt;&lt;/a&gt;    &lt;span class="n"&gt;dx&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;sigma&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;gamma&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_50ccf7005e66491dbad8d1af960e52e0-12" name="rest_code_50ccf7005e66491dbad8d1af960e52e0-12" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_50ccf7005e66491dbad8d1af960e52e0-12"&gt;&lt;/a&gt;    &lt;span class="n"&gt;dx&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;gamma&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;gamma&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_50ccf7005e66491dbad8d1af960e52e0-13" name="rest_code_50ccf7005e66491dbad8d1af960e52e0-13" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_50ccf7005e66491dbad8d1af960e52e0-13"&gt;&lt;/a&gt;    &lt;span class="n"&gt;dx&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;gamma&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_50ccf7005e66491dbad8d1af960e52e0-14" name="rest_code_50ccf7005e66491dbad8d1af960e52e0-14" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_50ccf7005e66491dbad8d1af960e52e0-14"&gt;&lt;/a&gt;    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;dx&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="code"&gt;&lt;pre class="code ipython3"&gt;&lt;a id="rest_code_235f3c6356b64e44a3496d2d004cdec2-1" name="rest_code_235f3c6356b64e44a3496d2d004cdec2-1" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_235f3c6356b64e44a3496d2d004cdec2-1"&gt;&lt;/a&gt;&lt;span class="c1"&gt;# Parameters of the model&lt;/span&gt;
&lt;a id="rest_code_235f3c6356b64e44a3496d2d004cdec2-2" name="rest_code_235f3c6356b64e44a3496d2d004cdec2-2" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_235f3c6356b64e44a3496d2d004cdec2-2"&gt;&lt;/a&gt;&lt;span class="n"&gt;N&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;6.7e7&lt;/span&gt; &lt;span class="c1"&gt;# Total population&lt;/span&gt;
&lt;a id="rest_code_235f3c6356b64e44a3496d2d004cdec2-3" name="rest_code_235f3c6356b64e44a3496d2d004cdec2-3" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_235f3c6356b64e44a3496d2d004cdec2-3"&gt;&lt;/a&gt;&lt;span class="n"&gt;i0&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;1e-4&lt;/span&gt; &lt;span class="c1"&gt;# 0.5*Proportion of the population infected on day 0&lt;/span&gt;
&lt;a id="rest_code_235f3c6356b64e44a3496d2d004cdec2-4" name="rest_code_235f3c6356b64e44a3496d2d004cdec2-4" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_235f3c6356b64e44a3496d2d004cdec2-4"&gt;&lt;/a&gt;&lt;span class="n"&gt;tlast&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;365.0&lt;/span&gt; &lt;span class="c1"&gt;# Consider a year&lt;/span&gt;
&lt;a id="rest_code_235f3c6356b64e44a3496d2d004cdec2-5" name="rest_code_235f3c6356b64e44a3496d2d004cdec2-5" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_235f3c6356b64e44a3496d2d004cdec2-5"&gt;&lt;/a&gt;&lt;span class="n"&gt;latent_period&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;5.0&lt;/span&gt; &lt;span class="c1"&gt;# Days between being infected and becoming infectious&lt;/span&gt;
&lt;a id="rest_code_235f3c6356b64e44a3496d2d004cdec2-6" name="rest_code_235f3c6356b64e44a3496d2d004cdec2-6" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_235f3c6356b64e44a3496d2d004cdec2-6"&gt;&lt;/a&gt;&lt;span class="n"&gt;infectious_period&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;7.0&lt;/span&gt; &lt;span class="c1"&gt;# Days infectious&lt;/span&gt;
&lt;a id="rest_code_235f3c6356b64e44a3496d2d004cdec2-7" name="rest_code_235f3c6356b64e44a3496d2d004cdec2-7" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_235f3c6356b64e44a3496d2d004cdec2-7"&gt;&lt;/a&gt;&lt;span class="n"&gt;R0&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;2.5&lt;/span&gt; &lt;span class="c1"&gt;# Basic reproduction number in the absence of interventions&lt;/span&gt;
&lt;a id="rest_code_235f3c6356b64e44a3496d2d004cdec2-8" name="rest_code_235f3c6356b64e44a3496d2d004cdec2-8" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_235f3c6356b64e44a3496d2d004cdec2-8"&gt;&lt;/a&gt;&lt;span class="n"&gt;Rt&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;0.75&lt;/span&gt; &lt;span class="c1"&gt;# Reproduction number in the presence of interventions&lt;/span&gt;
&lt;a id="rest_code_235f3c6356b64e44a3496d2d004cdec2-9" name="rest_code_235f3c6356b64e44a3496d2d004cdec2-9" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_235f3c6356b64e44a3496d2d004cdec2-9"&gt;&lt;/a&gt;&lt;span class="n"&gt;tend&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;21.0&lt;/span&gt; &lt;span class="c1"&gt;# Number of days of interventions&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="code"&gt;&lt;pre class="code ipython3"&gt;&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-1" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-1" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-1"&gt;&lt;/a&gt;&lt;span class="n"&gt;beta0&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;R0&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="n"&gt;infectious_period&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-2" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-2" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-2"&gt;&lt;/a&gt;&lt;span class="n"&gt;betat&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Rt&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="n"&gt;infectious_period&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-3" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-3" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-3"&gt;&lt;/a&gt;&lt;span class="n"&gt;sigma&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;2.0&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="n"&gt;latent_period&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-4" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-4" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-4"&gt;&lt;/a&gt;&lt;span class="n"&gt;gamma&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;2.0&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="n"&gt;infectious_period&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-5" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-5" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-5"&gt;&lt;/a&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-6" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-6" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-6"&gt;&lt;/a&gt;&lt;span class="n"&gt;t0ran&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;array&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;100&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;40&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;52.5&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;65&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-7" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-7" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-7"&gt;&lt;/a&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-8" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-8" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-8"&gt;&lt;/a&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;mylab&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-9" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-9" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-9"&gt;&lt;/a&gt;    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-10" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-10" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-10"&gt;&lt;/a&gt;        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="s2"&gt;"Start at "&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="nb"&gt;str&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="s2"&gt;" days"&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-11" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-11" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-11"&gt;&lt;/a&gt;    &lt;span class="k"&gt;else&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-12" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-12" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-12"&gt;&lt;/a&gt;        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="s2"&gt;"Baseline"&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-13" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-13" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-13"&gt;&lt;/a&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-14" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-14" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-14"&gt;&lt;/a&gt;&lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;[]&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-15" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-15" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-15"&gt;&lt;/a&gt;&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;tt&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t0ran&lt;/span&gt;&lt;span class="p"&gt;)):&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-16" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-16" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-16"&gt;&lt;/a&gt;    &lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;append&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;integrate&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;solve_ivp&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;lambda&lt;/span&gt; &lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;odefun&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;beta0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;betat&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;t0ran&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;&lt;span class="n"&gt;t0ran&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="n"&gt;tend&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;sigma&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;gamma&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-17" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-17" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-17"&gt;&lt;/a&gt;                              &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;0.0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;tlast&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-18" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-18" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-18"&gt;&lt;/a&gt;                              &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;array&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="mf"&gt;1.0&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;2.0&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;i0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;0.0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;0.0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;i0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;i0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;0.0&lt;/span&gt;&lt;span class="p"&gt;]),&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-19" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-19" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-19"&gt;&lt;/a&gt;                              &lt;span class="s1"&gt;'RK45'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-20" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-20" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-20"&gt;&lt;/a&gt;                              &lt;span class="n"&gt;atol&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mf"&gt;1e-8&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-21" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-21" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-21"&gt;&lt;/a&gt;                              &lt;span class="n"&gt;rtol&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mf"&gt;1e-9&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="code"&gt;&lt;pre class="code ipython3"&gt;&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-1" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-1" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-1"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;figure&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;figsize&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-2" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-2" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-2"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;subplot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-3" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-3" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-3"&gt;&lt;/a&gt;&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;tt&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t0ran&lt;/span&gt;&lt;span class="p"&gt;)):&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-4" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-4" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-4"&gt;&lt;/a&gt;    &lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;plot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;T&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;label&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;mylab&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t0ran&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]))&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-5" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-5" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-5"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xlim&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="mi"&gt;30&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;70&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-6" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-6" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-6"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ylim&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mf"&gt;7e6&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-7" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-7" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-7"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'Time (days)'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-8" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-8" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-8"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ylabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'Number of infectious cases'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-9" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-9" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-9"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;legend&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-10" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-10" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-10"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;subplot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-11" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-11" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-11"&gt;&lt;/a&gt;&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;tt&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t0ran&lt;/span&gt;&lt;span class="p"&gt;)):&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-12" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-12" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-12"&gt;&lt;/a&gt;    &lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;plot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;T&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;label&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;mylab&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t0ran&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]))&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-13" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-13" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-13"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'Time (days)'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-14" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-14" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-14"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ylabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'Cumulative infections'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-15" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-15" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-15"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;legend&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-16" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-16" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-16"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xlim&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="mi"&gt;30&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;70&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-17" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-17" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-17"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ylim&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mf"&gt;1e7&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-18" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-18" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-18"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;tight_layout&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-19" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-19" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-19"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;show&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="code"&gt;&lt;pre class="code ipython3"&gt;&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-1" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-1" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-1"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;figure&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;figsize&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-2" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-2" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-2"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;subplot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-3" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-3" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-3"&gt;&lt;/a&gt;&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;tt&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t0ran&lt;/span&gt;&lt;span class="p"&gt;)):&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-4" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-4" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-4"&gt;&lt;/a&gt;    &lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;plot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;T&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;label&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;mylab&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t0ran&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]))&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-5" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-5" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-5"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xlim&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;tlast&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-6" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-6" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-6"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ylim&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mf"&gt;1.2e7&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-7" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-7" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-7"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'Time (days)'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-8" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-8" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-8"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ylabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'Number of infectious cases'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-9" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-9" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-9"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;legend&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-10" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-10" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-10"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;subplot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-11" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-11" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-11"&gt;&lt;/a&gt;&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;tt&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t0ran&lt;/span&gt;&lt;span class="p"&gt;)):&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-12" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-12" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-12"&gt;&lt;/a&gt;    &lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;plot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;T&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;label&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;mylab&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t0ran&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]))&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-13" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-13" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-13"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'Time (days)'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-14" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-14" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-14"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ylabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'Cumulative infections'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-15" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-15" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-15"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;legend&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-16" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-16" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-16"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xlim&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;tlast&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-17" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-17" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-17"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ylim&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mf"&gt;6.2e7&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-18" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-18" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-18"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;tight_layout&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-19" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-19" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-19"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;show&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;&lt;/body&gt;&lt;/html&gt;

&lt;p&gt;I think that this presents an incomplete picture of the policy considerations.&lt;/p&gt;
&lt;img alt="Before herd immunity" class="align-left" src="https://personalpages.manchester.ac.uk/staff/thomas.house/Herd.png" style="width: 240px;"&gt;
&lt;img alt="After herd immunity" class="align-right" src="https://personalpages.manchester.ac.uk/staff/thomas.house/Herd2.png" style="width: 240px;"&gt;
&lt;p&gt;To see why, let us start by defining the most important concept in epidemic
modelling, the basic reproduction number &lt;span class="raw-html"&gt;\(R_0\)&lt;/span&gt;. This is equal to
the average number of infections caused by a case early in the epidemic, so that
for &lt;span class="raw-html"&gt;\(R_0 = 3\)&lt;/span&gt;, the early transmission tree might look something like
the cartoon on the left. This exhibits the exponential growth that is so worrying
at present. We have first one case, then three, then nine, then 27, then ...&lt;/p&gt;
&lt;p&gt;Now suppose that immunity has been built up, either through vaccination or by
illness followed by recovery, so that two thirds of people are immune. This
means that each case will have three contacts that would have caused infection
in the absence of immunity, but on average two of these will be immune and so
the situation looks more like the cartoon on the right. We say that the
reproduction number is reduced from its basic value to &lt;span class="raw-html"&gt;\(R_t = 1\)&lt;/span&gt;.&lt;/p&gt;
&lt;p&gt;While the individuals in the cartoon with a crossed out arrow pointing towards
them are literally immune, the people that they would have infected benefit
from &lt;strong&gt;herd immunity&lt;/strong&gt;. They can be infected if exposed, but will not be. This
is particularly beneficial to the people who are particularly vulnerable to the
disease, who might die if they catch it. The general formula for herd immunity
is that when over &lt;span class="raw-html"&gt;\((1 - (1/R_0))\times 100\%\)&lt;/span&gt; of the population
is immune, then the epidemic will start to die out.&lt;/p&gt;
&lt;p&gt;Now suppose we simulate a more realistic scenario. The Python code for this is
at the bottom of this post, and it is much simpler than the models that are
typically used to guide policy, but captures the basic phenomena of interest.
In particular, we suppose that we can reduce transmission through social
distancing measures like closing schools and workplaces, but that this is only
possible for three weeks. This represents the fact that the costs of not
educating children and not doing other activities can become quite large over
time, and in some cases can lead to levels death and illness that could exceed
those due to the unchecked epidemic. Running the epidemic model with these
interventions gives the following results for cases at a given moment and total
cases over time.&lt;/p&gt;
&lt;img alt="../output_5.png" src="https://personalpages.manchester.ac.uk/staff/thomas.house/output_5.png"&gt;
&lt;p&gt;It seems that the Tweet was right - look at the difference the early intervention
makes! But now let us zoom out of the graph; then the picture looks like the below.&lt;/p&gt;
&lt;img alt="../output_6_0.png" src="https://personalpages.manchester.ac.uk/staff/thomas.house/output_6_0.png"&gt;
&lt;p&gt;In fact, the later intervention dramatically reduces the burden on the healthcare
system, cutting in half the maximum numbers ill and potentially needing treatment
at any one time, and significantly reduces the final number infected, which the
earlier interventions fail to do.&lt;/p&gt;
&lt;p&gt;The reason that this happens is that social distancing measures do not lead to herd
immunity, so once they are lifted the epidemic starts again. In the absence of a
vaccine, it is therefore meaningless to speak about whether a policy 'aims' to get
herd immunity or not, since every country in the world will reach herd immunity
unless it is able to implement social distancing for an indefinite period of time.&lt;/p&gt;
&lt;p&gt;What mitigation policies should aim to do, therefore, is to reach herd immunity
with the minimal human cost. This will be extremely difficult, and at every
stage we will be dealing with large uncertainties. I would not want to be the
person who ultimately made the policy decisions. But to say that early
interventions are always better is incorrect.&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code ipython3"&gt;&lt;a id="rest_code_a60b412ba835495c84442a608a58c6ec-1" name="rest_code_a60b412ba835495c84442a608a58c6ec-1" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a60b412ba835495c84442a608a58c6ec-1"&gt;&lt;/a&gt;&lt;span class="c1"&gt;# Pull in libraries needed&lt;/span&gt;
&lt;a id="rest_code_a60b412ba835495c84442a608a58c6ec-2" name="rest_code_a60b412ba835495c84442a608a58c6ec-2" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a60b412ba835495c84442a608a58c6ec-2"&gt;&lt;/a&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="k"&gt;matplotlib&lt;/span&gt; inline
&lt;a id="rest_code_a60b412ba835495c84442a608a58c6ec-3" name="rest_code_a60b412ba835495c84442a608a58c6ec-3" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a60b412ba835495c84442a608a58c6ec-3"&gt;&lt;/a&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;numpy&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;np&lt;/span&gt;
&lt;a id="rest_code_a60b412ba835495c84442a608a58c6ec-4" name="rest_code_a60b412ba835495c84442a608a58c6ec-4" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a60b412ba835495c84442a608a58c6ec-4"&gt;&lt;/a&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;scipy&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;integrate&lt;/span&gt;
&lt;a id="rest_code_a60b412ba835495c84442a608a58c6ec-5" name="rest_code_a60b412ba835495c84442a608a58c6ec-5" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a60b412ba835495c84442a608a58c6ec-5"&gt;&lt;/a&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;matplotlib.pyplot&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;plt&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="code"&gt;&lt;pre class="code ipython3"&gt;&lt;a id="rest_code_50ccf7005e66491dbad8d1af960e52e0-1" name="rest_code_50ccf7005e66491dbad8d1af960e52e0-1" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_50ccf7005e66491dbad8d1af960e52e0-1"&gt;&lt;/a&gt;&lt;span class="c1"&gt;# Represent the basic dynamics&lt;/span&gt;
&lt;a id="rest_code_50ccf7005e66491dbad8d1af960e52e0-2" name="rest_code_50ccf7005e66491dbad8d1af960e52e0-2" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_50ccf7005e66491dbad8d1af960e52e0-2"&gt;&lt;/a&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;odefun&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;beta0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;betat&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;t0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;t1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;sigma&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;gamma&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_50ccf7005e66491dbad8d1af960e52e0-3" name="rest_code_50ccf7005e66491dbad8d1af960e52e0-3" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_50ccf7005e66491dbad8d1af960e52e0-3"&gt;&lt;/a&gt;    &lt;span class="n"&gt;dx&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;6&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_50ccf7005e66491dbad8d1af960e52e0-4" name="rest_code_50ccf7005e66491dbad8d1af960e52e0-4" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_50ccf7005e66491dbad8d1af960e52e0-4"&gt;&lt;/a&gt;    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;=&lt;/span&gt;&lt;span class="n"&gt;t0&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="ow"&gt;and&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;=&lt;/span&gt;&lt;span class="n"&gt;t1&lt;/span&gt;&lt;span class="p"&gt;)):&lt;/span&gt;
&lt;a id="rest_code_50ccf7005e66491dbad8d1af960e52e0-5" name="rest_code_50ccf7005e66491dbad8d1af960e52e0-5" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_50ccf7005e66491dbad8d1af960e52e0-5"&gt;&lt;/a&gt;        &lt;span class="n"&gt;beta&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;betat&lt;/span&gt;
&lt;a id="rest_code_50ccf7005e66491dbad8d1af960e52e0-6" name="rest_code_50ccf7005e66491dbad8d1af960e52e0-6" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_50ccf7005e66491dbad8d1af960e52e0-6"&gt;&lt;/a&gt;    &lt;span class="k"&gt;else&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a id="rest_code_50ccf7005e66491dbad8d1af960e52e0-7" name="rest_code_50ccf7005e66491dbad8d1af960e52e0-7" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_50ccf7005e66491dbad8d1af960e52e0-7"&gt;&lt;/a&gt;        &lt;span class="n"&gt;beta&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;beta0&lt;/span&gt;
&lt;a id="rest_code_50ccf7005e66491dbad8d1af960e52e0-8" name="rest_code_50ccf7005e66491dbad8d1af960e52e0-8" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_50ccf7005e66491dbad8d1af960e52e0-8"&gt;&lt;/a&gt;    &lt;span class="n"&gt;dx&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;beta&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_50ccf7005e66491dbad8d1af960e52e0-9" name="rest_code_50ccf7005e66491dbad8d1af960e52e0-9" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_50ccf7005e66491dbad8d1af960e52e0-9"&gt;&lt;/a&gt;    &lt;span class="n"&gt;dx&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;beta&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;sigma&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_50ccf7005e66491dbad8d1af960e52e0-10" name="rest_code_50ccf7005e66491dbad8d1af960e52e0-10" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_50ccf7005e66491dbad8d1af960e52e0-10"&gt;&lt;/a&gt;    &lt;span class="n"&gt;dx&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;sigma&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;sigma&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_50ccf7005e66491dbad8d1af960e52e0-11" name="rest_code_50ccf7005e66491dbad8d1af960e52e0-11" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_50ccf7005e66491dbad8d1af960e52e0-11"&gt;&lt;/a&gt;    &lt;span class="n"&gt;dx&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;sigma&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;gamma&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_50ccf7005e66491dbad8d1af960e52e0-12" name="rest_code_50ccf7005e66491dbad8d1af960e52e0-12" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_50ccf7005e66491dbad8d1af960e52e0-12"&gt;&lt;/a&gt;    &lt;span class="n"&gt;dx&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;gamma&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;gamma&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_50ccf7005e66491dbad8d1af960e52e0-13" name="rest_code_50ccf7005e66491dbad8d1af960e52e0-13" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_50ccf7005e66491dbad8d1af960e52e0-13"&gt;&lt;/a&gt;    &lt;span class="n"&gt;dx&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;gamma&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_50ccf7005e66491dbad8d1af960e52e0-14" name="rest_code_50ccf7005e66491dbad8d1af960e52e0-14" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_50ccf7005e66491dbad8d1af960e52e0-14"&gt;&lt;/a&gt;    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;dx&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="code"&gt;&lt;pre class="code ipython3"&gt;&lt;a id="rest_code_235f3c6356b64e44a3496d2d004cdec2-1" name="rest_code_235f3c6356b64e44a3496d2d004cdec2-1" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_235f3c6356b64e44a3496d2d004cdec2-1"&gt;&lt;/a&gt;&lt;span class="c1"&gt;# Parameters of the model&lt;/span&gt;
&lt;a id="rest_code_235f3c6356b64e44a3496d2d004cdec2-2" name="rest_code_235f3c6356b64e44a3496d2d004cdec2-2" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_235f3c6356b64e44a3496d2d004cdec2-2"&gt;&lt;/a&gt;&lt;span class="n"&gt;N&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;6.7e7&lt;/span&gt; &lt;span class="c1"&gt;# Total population&lt;/span&gt;
&lt;a id="rest_code_235f3c6356b64e44a3496d2d004cdec2-3" name="rest_code_235f3c6356b64e44a3496d2d004cdec2-3" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_235f3c6356b64e44a3496d2d004cdec2-3"&gt;&lt;/a&gt;&lt;span class="n"&gt;i0&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;1e-4&lt;/span&gt; &lt;span class="c1"&gt;# 0.5*Proportion of the population infected on day 0&lt;/span&gt;
&lt;a id="rest_code_235f3c6356b64e44a3496d2d004cdec2-4" name="rest_code_235f3c6356b64e44a3496d2d004cdec2-4" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_235f3c6356b64e44a3496d2d004cdec2-4"&gt;&lt;/a&gt;&lt;span class="n"&gt;tlast&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;365.0&lt;/span&gt; &lt;span class="c1"&gt;# Consider a year&lt;/span&gt;
&lt;a id="rest_code_235f3c6356b64e44a3496d2d004cdec2-5" name="rest_code_235f3c6356b64e44a3496d2d004cdec2-5" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_235f3c6356b64e44a3496d2d004cdec2-5"&gt;&lt;/a&gt;&lt;span class="n"&gt;latent_period&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;5.0&lt;/span&gt; &lt;span class="c1"&gt;# Days between being infected and becoming infectious&lt;/span&gt;
&lt;a id="rest_code_235f3c6356b64e44a3496d2d004cdec2-6" name="rest_code_235f3c6356b64e44a3496d2d004cdec2-6" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_235f3c6356b64e44a3496d2d004cdec2-6"&gt;&lt;/a&gt;&lt;span class="n"&gt;infectious_period&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;7.0&lt;/span&gt; &lt;span class="c1"&gt;# Days infectious&lt;/span&gt;
&lt;a id="rest_code_235f3c6356b64e44a3496d2d004cdec2-7" name="rest_code_235f3c6356b64e44a3496d2d004cdec2-7" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_235f3c6356b64e44a3496d2d004cdec2-7"&gt;&lt;/a&gt;&lt;span class="n"&gt;R0&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;2.5&lt;/span&gt; &lt;span class="c1"&gt;# Basic reproduction number in the absence of interventions&lt;/span&gt;
&lt;a id="rest_code_235f3c6356b64e44a3496d2d004cdec2-8" name="rest_code_235f3c6356b64e44a3496d2d004cdec2-8" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_235f3c6356b64e44a3496d2d004cdec2-8"&gt;&lt;/a&gt;&lt;span class="n"&gt;Rt&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;0.75&lt;/span&gt; &lt;span class="c1"&gt;# Reproduction number in the presence of interventions&lt;/span&gt;
&lt;a id="rest_code_235f3c6356b64e44a3496d2d004cdec2-9" name="rest_code_235f3c6356b64e44a3496d2d004cdec2-9" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_235f3c6356b64e44a3496d2d004cdec2-9"&gt;&lt;/a&gt;&lt;span class="n"&gt;tend&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;21.0&lt;/span&gt; &lt;span class="c1"&gt;# Number of days of interventions&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="code"&gt;&lt;pre class="code ipython3"&gt;&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-1" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-1" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-1"&gt;&lt;/a&gt;&lt;span class="n"&gt;beta0&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;R0&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="n"&gt;infectious_period&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-2" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-2" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-2"&gt;&lt;/a&gt;&lt;span class="n"&gt;betat&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Rt&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="n"&gt;infectious_period&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-3" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-3" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-3"&gt;&lt;/a&gt;&lt;span class="n"&gt;sigma&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;2.0&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="n"&gt;latent_period&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-4" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-4" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-4"&gt;&lt;/a&gt;&lt;span class="n"&gt;gamma&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;2.0&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="n"&gt;infectious_period&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-5" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-5" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-5"&gt;&lt;/a&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-6" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-6" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-6"&gt;&lt;/a&gt;&lt;span class="n"&gt;t0ran&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;array&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;100&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;40&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;52.5&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;65&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-7" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-7" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-7"&gt;&lt;/a&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-8" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-8" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-8"&gt;&lt;/a&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;mylab&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-9" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-9" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-9"&gt;&lt;/a&gt;    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-10" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-10" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-10"&gt;&lt;/a&gt;        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="s2"&gt;"Start at "&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="nb"&gt;str&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="s2"&gt;" days"&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-11" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-11" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-11"&gt;&lt;/a&gt;    &lt;span class="k"&gt;else&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-12" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-12" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-12"&gt;&lt;/a&gt;        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="s2"&gt;"Baseline"&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-13" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-13" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-13"&gt;&lt;/a&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-14" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-14" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-14"&gt;&lt;/a&gt;&lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;[]&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-15" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-15" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-15"&gt;&lt;/a&gt;&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;tt&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t0ran&lt;/span&gt;&lt;span class="p"&gt;)):&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-16" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-16" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-16"&gt;&lt;/a&gt;    &lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;append&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;integrate&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;solve_ivp&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;lambda&lt;/span&gt; &lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;odefun&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;beta0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;betat&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;t0ran&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;&lt;span class="n"&gt;t0ran&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="n"&gt;tend&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;sigma&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;gamma&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-17" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-17" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-17"&gt;&lt;/a&gt;                              &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;0.0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;tlast&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-18" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-18" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-18"&gt;&lt;/a&gt;                              &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;array&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="mf"&gt;1.0&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;2.0&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;i0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;0.0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;0.0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;i0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;i0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;0.0&lt;/span&gt;&lt;span class="p"&gt;]),&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-19" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-19" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-19"&gt;&lt;/a&gt;                              &lt;span class="s1"&gt;'RK45'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-20" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-20" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-20"&gt;&lt;/a&gt;                              &lt;span class="n"&gt;atol&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mf"&gt;1e-8&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-21" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-21" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-21"&gt;&lt;/a&gt;                              &lt;span class="n"&gt;rtol&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mf"&gt;1e-9&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="code"&gt;&lt;pre class="code ipython3"&gt;&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-1" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-1" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-1"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;figure&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;figsize&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-2" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-2" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-2"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;subplot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-3" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-3" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-3"&gt;&lt;/a&gt;&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;tt&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t0ran&lt;/span&gt;&lt;span class="p"&gt;)):&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-4" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-4" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-4"&gt;&lt;/a&gt;    &lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;plot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;T&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;label&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;mylab&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t0ran&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]))&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-5" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-5" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-5"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xlim&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="mi"&gt;30&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;70&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-6" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-6" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-6"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ylim&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mf"&gt;7e6&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-7" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-7" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-7"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'Time (days)'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-8" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-8" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-8"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ylabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'Number of infectious cases'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-9" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-9" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-9"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;legend&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-10" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-10" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-10"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;subplot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-11" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-11" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-11"&gt;&lt;/a&gt;&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;tt&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t0ran&lt;/span&gt;&lt;span class="p"&gt;)):&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-12" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-12" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-12"&gt;&lt;/a&gt;    &lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;plot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;T&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;label&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;mylab&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t0ran&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]))&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-13" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-13" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-13"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'Time (days)'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-14" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-14" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-14"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ylabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'Cumulative infections'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-15" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-15" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-15"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;legend&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-16" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-16" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-16"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xlim&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="mi"&gt;30&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;70&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-17" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-17" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-17"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ylim&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mf"&gt;1e7&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-18" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-18" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-18"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;tight_layout&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-19" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-19" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-19"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;show&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="code"&gt;&lt;pre class="code ipython3"&gt;&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-1" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-1" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-1"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;figure&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;figsize&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-2" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-2" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-2"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;subplot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-3" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-3" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-3"&gt;&lt;/a&gt;&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;tt&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t0ran&lt;/span&gt;&lt;span class="p"&gt;)):&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-4" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-4" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-4"&gt;&lt;/a&gt;    &lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;plot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;T&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;label&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;mylab&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t0ran&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]))&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-5" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-5" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-5"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xlim&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;tlast&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-6" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-6" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-6"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ylim&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mf"&gt;1.2e7&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-7" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-7" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-7"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'Time (days)'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-8" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-8" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-8"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ylabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'Number of infectious cases'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-9" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-9" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-9"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;legend&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-10" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-10" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-10"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;subplot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-11" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-11" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-11"&gt;&lt;/a&gt;&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;tt&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t0ran&lt;/span&gt;&lt;span class="p"&gt;)):&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-12" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-12" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-12"&gt;&lt;/a&gt;    &lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;plot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;T&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;label&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;mylab&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t0ran&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]))&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-13" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-13" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-13"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'Time (days)'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-14" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-14" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-14"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ylabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'Cumulative infections'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-15" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-15" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-15"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;legend&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-16" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-16" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-16"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xlim&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;tlast&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-17" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-17" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-17"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ylim&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mf"&gt;6.2e7&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-18" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-18" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-18"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;tight_layout&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-19" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-19" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-19"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;show&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;&lt;/body&gt;&lt;/html&gt;

&lt;img alt="Before herd immunity" class="align-left" src="https://personalpages.manchester.ac.uk/staff/thomas.house/Herd.png" style="width: 240px;"&gt;
&lt;img alt="After herd immunity" class="align-right" src="https://personalpages.manchester.ac.uk/staff/thomas.house/Herd2.png" style="width: 240px;"&gt;
&lt;p&gt;To see why, let us start by defining the most important concept in epidemic
modelling, the basic reproduction number &lt;span class="raw-html"&gt;\(R_0\)&lt;/span&gt;. This is equal to
the average number of infections caused by a case early in the epidemic, so that
for &lt;span class="raw-html"&gt;\(R_0 = 3\)&lt;/span&gt;, the early transmission tree might look something like
the cartoon on the left. This exhibits the exponential growth that is so worrying
at present. We have first one case, then three, then nine, then 27, then ...&lt;/p&gt;
&lt;p&gt;Now suppose that immunity has been built up, either through vaccination or by
illness followed by recovery, so that two thirds of people are immune. This
means that each case will have three contacts that would have caused infection
in the absence of immunity, but on average two of these will be immune and so
the situation looks more like the cartoon on the right. We say that the
reproduction number is reduced from its basic value to &lt;span class="raw-html"&gt;\(R_t = 1\)&lt;/span&gt;.&lt;/p&gt;
&lt;p&gt;While the individuals in the cartoon with a crossed out arrow pointing towards
them are literally immune, the people that they would have infected benefit
from &lt;strong&gt;herd immunity&lt;/strong&gt;. They can be infected if exposed, but will not be. This
is particularly beneficial to the people who are particularly vulnerable to the
disease, who might die if they catch it. The general formula for herd immunity
is that when over &lt;span class="raw-html"&gt;\((1 - (1/R_0))\times 100\%\)&lt;/span&gt; of the population
is immune, then the epidemic will start to die out.&lt;/p&gt;
&lt;p&gt;Now suppose we simulate a more realistic scenario. The Python code for this is
at the bottom of this post, and it is much simpler than the models that are
typically used to guide policy, but captures the basic phenomena of interest.
In particular, we suppose that we can reduce transmission through social
distancing measures like closing schools and workplaces, but that this is only
possible for three weeks. This represents the fact that the costs of not
educating children and not doing other activities can become quite large over
time, and in some cases can lead to levels death and illness that could exceed
those due to the unchecked epidemic. Running the epidemic model with these
interventions gives the following results for cases at a given moment and total
cases over time.&lt;/p&gt;
&lt;img alt="../output_5.png" src="https://personalpages.manchester.ac.uk/staff/thomas.house/output_5.png"&gt;
&lt;p&gt;It seems that the Tweet was right - look at the difference the early intervention
makes! But now let us zoom out of the graph; then the picture looks like the below.&lt;/p&gt;
&lt;img alt="../output_6_0.png" src="https://personalpages.manchester.ac.uk/staff/thomas.house/output_6_0.png"&gt;
&lt;p&gt;In fact, the later intervention dramatically reduces the burden on the healthcare
system, cutting in half the maximum numbers ill and potentially needing treatment
at any one time, and significantly reduces the final number infected, which the
earlier interventions fail to do.&lt;/p&gt;
&lt;p&gt;The reason that this happens is that social distancing measures do not lead to herd
immunity, so once they are lifted the epidemic starts again. In the absence of a
vaccine, it is therefore meaningless to speak about whether a policy 'aims' to get
herd immunity or not, since every country in the world will reach herd immunity
unless it is able to implement social distancing for an indefinite period of time.&lt;/p&gt;
&lt;p&gt;What mitigation policies should aim to do, therefore, is to reach herd immunity
with the minimal human cost. This will be extremely difficult, and at every
stage we will be dealing with large uncertainties. I would not want to be the
person who ultimately made the policy decisions. But to say that early
interventions are always better is incorrect.&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code ipython3"&gt;&lt;a id="rest_code_a60b412ba835495c84442a608a58c6ec-1" name="rest_code_a60b412ba835495c84442a608a58c6ec-1" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a60b412ba835495c84442a608a58c6ec-1"&gt;&lt;/a&gt;&lt;span class="c1"&gt;# Pull in libraries needed&lt;/span&gt;
&lt;a id="rest_code_a60b412ba835495c84442a608a58c6ec-2" name="rest_code_a60b412ba835495c84442a608a58c6ec-2" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a60b412ba835495c84442a608a58c6ec-2"&gt;&lt;/a&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="k"&gt;matplotlib&lt;/span&gt; inline
&lt;a id="rest_code_a60b412ba835495c84442a608a58c6ec-3" name="rest_code_a60b412ba835495c84442a608a58c6ec-3" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a60b412ba835495c84442a608a58c6ec-3"&gt;&lt;/a&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;numpy&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;np&lt;/span&gt;
&lt;a id="rest_code_a60b412ba835495c84442a608a58c6ec-4" name="rest_code_a60b412ba835495c84442a608a58c6ec-4" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a60b412ba835495c84442a608a58c6ec-4"&gt;&lt;/a&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;scipy&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;integrate&lt;/span&gt;
&lt;a id="rest_code_a60b412ba835495c84442a608a58c6ec-5" name="rest_code_a60b412ba835495c84442a608a58c6ec-5" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a60b412ba835495c84442a608a58c6ec-5"&gt;&lt;/a&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;matplotlib.pyplot&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;plt&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="code"&gt;&lt;pre class="code ipython3"&gt;&lt;a id="rest_code_50ccf7005e66491dbad8d1af960e52e0-1" name="rest_code_50ccf7005e66491dbad8d1af960e52e0-1" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_50ccf7005e66491dbad8d1af960e52e0-1"&gt;&lt;/a&gt;&lt;span class="c1"&gt;# Represent the basic dynamics&lt;/span&gt;
&lt;a id="rest_code_50ccf7005e66491dbad8d1af960e52e0-2" name="rest_code_50ccf7005e66491dbad8d1af960e52e0-2" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_50ccf7005e66491dbad8d1af960e52e0-2"&gt;&lt;/a&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;odefun&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;beta0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;betat&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;t0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;t1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;sigma&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;gamma&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_50ccf7005e66491dbad8d1af960e52e0-3" name="rest_code_50ccf7005e66491dbad8d1af960e52e0-3" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_50ccf7005e66491dbad8d1af960e52e0-3"&gt;&lt;/a&gt;    &lt;span class="n"&gt;dx&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;6&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_50ccf7005e66491dbad8d1af960e52e0-4" name="rest_code_50ccf7005e66491dbad8d1af960e52e0-4" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_50ccf7005e66491dbad8d1af960e52e0-4"&gt;&lt;/a&gt;    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;=&lt;/span&gt;&lt;span class="n"&gt;t0&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="ow"&gt;and&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;=&lt;/span&gt;&lt;span class="n"&gt;t1&lt;/span&gt;&lt;span class="p"&gt;)):&lt;/span&gt;
&lt;a id="rest_code_50ccf7005e66491dbad8d1af960e52e0-5" name="rest_code_50ccf7005e66491dbad8d1af960e52e0-5" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_50ccf7005e66491dbad8d1af960e52e0-5"&gt;&lt;/a&gt;        &lt;span class="n"&gt;beta&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;betat&lt;/span&gt;
&lt;a id="rest_code_50ccf7005e66491dbad8d1af960e52e0-6" name="rest_code_50ccf7005e66491dbad8d1af960e52e0-6" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_50ccf7005e66491dbad8d1af960e52e0-6"&gt;&lt;/a&gt;    &lt;span class="k"&gt;else&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a id="rest_code_50ccf7005e66491dbad8d1af960e52e0-7" name="rest_code_50ccf7005e66491dbad8d1af960e52e0-7" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_50ccf7005e66491dbad8d1af960e52e0-7"&gt;&lt;/a&gt;        &lt;span class="n"&gt;beta&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;beta0&lt;/span&gt;
&lt;a id="rest_code_50ccf7005e66491dbad8d1af960e52e0-8" name="rest_code_50ccf7005e66491dbad8d1af960e52e0-8" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_50ccf7005e66491dbad8d1af960e52e0-8"&gt;&lt;/a&gt;    &lt;span class="n"&gt;dx&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;beta&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_50ccf7005e66491dbad8d1af960e52e0-9" name="rest_code_50ccf7005e66491dbad8d1af960e52e0-9" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_50ccf7005e66491dbad8d1af960e52e0-9"&gt;&lt;/a&gt;    &lt;span class="n"&gt;dx&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;beta&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;sigma&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_50ccf7005e66491dbad8d1af960e52e0-10" name="rest_code_50ccf7005e66491dbad8d1af960e52e0-10" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_50ccf7005e66491dbad8d1af960e52e0-10"&gt;&lt;/a&gt;    &lt;span class="n"&gt;dx&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;sigma&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;sigma&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_50ccf7005e66491dbad8d1af960e52e0-11" name="rest_code_50ccf7005e66491dbad8d1af960e52e0-11" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_50ccf7005e66491dbad8d1af960e52e0-11"&gt;&lt;/a&gt;    &lt;span class="n"&gt;dx&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;sigma&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;gamma&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_50ccf7005e66491dbad8d1af960e52e0-12" name="rest_code_50ccf7005e66491dbad8d1af960e52e0-12" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_50ccf7005e66491dbad8d1af960e52e0-12"&gt;&lt;/a&gt;    &lt;span class="n"&gt;dx&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;gamma&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;gamma&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_50ccf7005e66491dbad8d1af960e52e0-13" name="rest_code_50ccf7005e66491dbad8d1af960e52e0-13" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_50ccf7005e66491dbad8d1af960e52e0-13"&gt;&lt;/a&gt;    &lt;span class="n"&gt;dx&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;gamma&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_50ccf7005e66491dbad8d1af960e52e0-14" name="rest_code_50ccf7005e66491dbad8d1af960e52e0-14" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_50ccf7005e66491dbad8d1af960e52e0-14"&gt;&lt;/a&gt;    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;dx&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="code"&gt;&lt;pre class="code ipython3"&gt;&lt;a id="rest_code_235f3c6356b64e44a3496d2d004cdec2-1" name="rest_code_235f3c6356b64e44a3496d2d004cdec2-1" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_235f3c6356b64e44a3496d2d004cdec2-1"&gt;&lt;/a&gt;&lt;span class="c1"&gt;# Parameters of the model&lt;/span&gt;
&lt;a id="rest_code_235f3c6356b64e44a3496d2d004cdec2-2" name="rest_code_235f3c6356b64e44a3496d2d004cdec2-2" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_235f3c6356b64e44a3496d2d004cdec2-2"&gt;&lt;/a&gt;&lt;span class="n"&gt;N&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;6.7e7&lt;/span&gt; &lt;span class="c1"&gt;# Total population&lt;/span&gt;
&lt;a id="rest_code_235f3c6356b64e44a3496d2d004cdec2-3" name="rest_code_235f3c6356b64e44a3496d2d004cdec2-3" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_235f3c6356b64e44a3496d2d004cdec2-3"&gt;&lt;/a&gt;&lt;span class="n"&gt;i0&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;1e-4&lt;/span&gt; &lt;span class="c1"&gt;# 0.5*Proportion of the population infected on day 0&lt;/span&gt;
&lt;a id="rest_code_235f3c6356b64e44a3496d2d004cdec2-4" name="rest_code_235f3c6356b64e44a3496d2d004cdec2-4" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_235f3c6356b64e44a3496d2d004cdec2-4"&gt;&lt;/a&gt;&lt;span class="n"&gt;tlast&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;365.0&lt;/span&gt; &lt;span class="c1"&gt;# Consider a year&lt;/span&gt;
&lt;a id="rest_code_235f3c6356b64e44a3496d2d004cdec2-5" name="rest_code_235f3c6356b64e44a3496d2d004cdec2-5" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_235f3c6356b64e44a3496d2d004cdec2-5"&gt;&lt;/a&gt;&lt;span class="n"&gt;latent_period&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;5.0&lt;/span&gt; &lt;span class="c1"&gt;# Days between being infected and becoming infectious&lt;/span&gt;
&lt;a id="rest_code_235f3c6356b64e44a3496d2d004cdec2-6" name="rest_code_235f3c6356b64e44a3496d2d004cdec2-6" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_235f3c6356b64e44a3496d2d004cdec2-6"&gt;&lt;/a&gt;&lt;span class="n"&gt;infectious_period&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;7.0&lt;/span&gt; &lt;span class="c1"&gt;# Days infectious&lt;/span&gt;
&lt;a id="rest_code_235f3c6356b64e44a3496d2d004cdec2-7" name="rest_code_235f3c6356b64e44a3496d2d004cdec2-7" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_235f3c6356b64e44a3496d2d004cdec2-7"&gt;&lt;/a&gt;&lt;span class="n"&gt;R0&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;2.5&lt;/span&gt; &lt;span class="c1"&gt;# Basic reproduction number in the absence of interventions&lt;/span&gt;
&lt;a id="rest_code_235f3c6356b64e44a3496d2d004cdec2-8" name="rest_code_235f3c6356b64e44a3496d2d004cdec2-8" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_235f3c6356b64e44a3496d2d004cdec2-8"&gt;&lt;/a&gt;&lt;span class="n"&gt;Rt&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;0.75&lt;/span&gt; &lt;span class="c1"&gt;# Reproduction number in the presence of interventions&lt;/span&gt;
&lt;a id="rest_code_235f3c6356b64e44a3496d2d004cdec2-9" name="rest_code_235f3c6356b64e44a3496d2d004cdec2-9" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_235f3c6356b64e44a3496d2d004cdec2-9"&gt;&lt;/a&gt;&lt;span class="n"&gt;tend&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;21.0&lt;/span&gt; &lt;span class="c1"&gt;# Number of days of interventions&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="code"&gt;&lt;pre class="code ipython3"&gt;&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-1" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-1" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-1"&gt;&lt;/a&gt;&lt;span class="n"&gt;beta0&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;R0&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="n"&gt;infectious_period&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-2" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-2" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-2"&gt;&lt;/a&gt;&lt;span class="n"&gt;betat&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Rt&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="n"&gt;infectious_period&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-3" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-3" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-3"&gt;&lt;/a&gt;&lt;span class="n"&gt;sigma&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;2.0&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="n"&gt;latent_period&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-4" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-4" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-4"&gt;&lt;/a&gt;&lt;span class="n"&gt;gamma&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;2.0&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="n"&gt;infectious_period&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-5" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-5" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-5"&gt;&lt;/a&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-6" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-6" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-6"&gt;&lt;/a&gt;&lt;span class="n"&gt;t0ran&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;array&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;100&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;40&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;52.5&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;65&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-7" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-7" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-7"&gt;&lt;/a&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-8" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-8" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-8"&gt;&lt;/a&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;mylab&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-9" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-9" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-9"&gt;&lt;/a&gt;    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-10" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-10" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-10"&gt;&lt;/a&gt;        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="s2"&gt;"Start at "&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="nb"&gt;str&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="s2"&gt;" days"&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-11" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-11" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-11"&gt;&lt;/a&gt;    &lt;span class="k"&gt;else&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-12" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-12" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-12"&gt;&lt;/a&gt;        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="s2"&gt;"Baseline"&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-13" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-13" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-13"&gt;&lt;/a&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-14" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-14" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-14"&gt;&lt;/a&gt;&lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;[]&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-15" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-15" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-15"&gt;&lt;/a&gt;&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;tt&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t0ran&lt;/span&gt;&lt;span class="p"&gt;)):&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-16" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-16" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-16"&gt;&lt;/a&gt;    &lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;append&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;integrate&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;solve_ivp&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;lambda&lt;/span&gt; &lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;odefun&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;beta0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;betat&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;t0ran&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;&lt;span class="n"&gt;t0ran&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="n"&gt;tend&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;sigma&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;gamma&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-17" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-17" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-17"&gt;&lt;/a&gt;                              &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;0.0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;tlast&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-18" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-18" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-18"&gt;&lt;/a&gt;                              &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;array&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="mf"&gt;1.0&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;2.0&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;i0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;0.0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;0.0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;i0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;i0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;0.0&lt;/span&gt;&lt;span class="p"&gt;]),&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-19" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-19" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-19"&gt;&lt;/a&gt;                              &lt;span class="s1"&gt;'RK45'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-20" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-20" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-20"&gt;&lt;/a&gt;                              &lt;span class="n"&gt;atol&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mf"&gt;1e-8&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-21" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-21" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-21"&gt;&lt;/a&gt;                              &lt;span class="n"&gt;rtol&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mf"&gt;1e-9&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="code"&gt;&lt;pre class="code ipython3"&gt;&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-1" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-1" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-1"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;figure&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;figsize&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-2" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-2" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-2"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;subplot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-3" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-3" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-3"&gt;&lt;/a&gt;&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;tt&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t0ran&lt;/span&gt;&lt;span class="p"&gt;)):&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-4" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-4" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-4"&gt;&lt;/a&gt;    &lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;plot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;T&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;label&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;mylab&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t0ran&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]))&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-5" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-5" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-5"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xlim&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="mi"&gt;30&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;70&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-6" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-6" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-6"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ylim&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mf"&gt;7e6&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-7" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-7" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-7"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'Time (days)'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-8" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-8" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-8"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ylabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'Number of infectious cases'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-9" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-9" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-9"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;legend&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-10" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-10" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-10"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;subplot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-11" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-11" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-11"&gt;&lt;/a&gt;&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;tt&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t0ran&lt;/span&gt;&lt;span class="p"&gt;)):&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-12" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-12" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-12"&gt;&lt;/a&gt;    &lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;plot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;T&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;label&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;mylab&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t0ran&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]))&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-13" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-13" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-13"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'Time (days)'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-14" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-14" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-14"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ylabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'Cumulative infections'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-15" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-15" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-15"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;legend&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-16" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-16" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-16"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xlim&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="mi"&gt;30&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;70&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-17" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-17" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-17"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ylim&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mf"&gt;1e7&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-18" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-18" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-18"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;tight_layout&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-19" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-19" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-19"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;show&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="code"&gt;&lt;pre class="code ipython3"&gt;&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-1" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-1" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-1"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;figure&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;figsize&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-2" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-2" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-2"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;subplot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-3" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-3" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-3"&gt;&lt;/a&gt;&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;tt&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t0ran&lt;/span&gt;&lt;span class="p"&gt;)):&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-4" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-4" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-4"&gt;&lt;/a&gt;    &lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;plot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;T&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;label&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;mylab&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t0ran&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]))&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-5" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-5" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-5"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xlim&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;tlast&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-6" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-6" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-6"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ylim&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mf"&gt;1.2e7&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-7" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-7" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-7"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'Time (days)'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-8" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-8" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-8"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ylabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'Number of infectious cases'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-9" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-9" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-9"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;legend&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-10" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-10" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-10"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;subplot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-11" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-11" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-11"&gt;&lt;/a&gt;&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;tt&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t0ran&lt;/span&gt;&lt;span class="p"&gt;)):&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-12" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-12" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-12"&gt;&lt;/a&gt;    &lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;plot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;T&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;label&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;mylab&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t0ran&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]))&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-13" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-13" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-13"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'Time (days)'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-14" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-14" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-14"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ylabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'Cumulative infections'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-15" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-15" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-15"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;legend&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-16" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-16" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-16"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xlim&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;tlast&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-17" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-17" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-17"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ylim&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mf"&gt;6.2e7&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-18" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-18" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-18"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;tight_layout&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-19" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-19" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-19"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;show&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;&lt;/body&gt;&lt;/html&gt;

&lt;p&gt;Now suppose that immunity has been built up, either through vaccination or by
illness followed by recovery, so that two thirds of people are immune. This
means that each case will have three contacts that would have caused infection
in the absence of immunity, but on average two of these will be immune and so
the situation looks more like the cartoon on the right. We say that the
reproduction number is reduced from its basic value to &lt;span class="raw-html"&gt;\(R_t = 1\)&lt;/span&gt;.&lt;/p&gt;
&lt;p&gt;While the individuals in the cartoon with a crossed out arrow pointing towards
them are literally immune, the people that they would have infected benefit
from &lt;strong&gt;herd immunity&lt;/strong&gt;. They can be infected if exposed, but will not be. This
is particularly beneficial to the people who are particularly vulnerable to the
disease, who might die if they catch it. The general formula for herd immunity
is that when over &lt;span class="raw-html"&gt;\((1 - (1/R_0))\times 100\%\)&lt;/span&gt; of the population
is immune, then the epidemic will start to die out.&lt;/p&gt;
&lt;p&gt;Now suppose we simulate a more realistic scenario. The Python code for this is
at the bottom of this post, and it is much simpler than the models that are
typically used to guide policy, but captures the basic phenomena of interest.
In particular, we suppose that we can reduce transmission through social
distancing measures like closing schools and workplaces, but that this is only
possible for three weeks. This represents the fact that the costs of not
educating children and not doing other activities can become quite large over
time, and in some cases can lead to levels death and illness that could exceed
those due to the unchecked epidemic. Running the epidemic model with these
interventions gives the following results for cases at a given moment and total
cases over time.&lt;/p&gt;
&lt;img alt="../output_5.png" src="https://personalpages.manchester.ac.uk/staff/thomas.house/output_5.png"&gt;
&lt;p&gt;It seems that the Tweet was right - look at the difference the early intervention
makes! But now let us zoom out of the graph; then the picture looks like the below.&lt;/p&gt;
&lt;img alt="../output_6_0.png" src="https://personalpages.manchester.ac.uk/staff/thomas.house/output_6_0.png"&gt;
&lt;p&gt;In fact, the later intervention dramatically reduces the burden on the healthcare
system, cutting in half the maximum numbers ill and potentially needing treatment
at any one time, and significantly reduces the final number infected, which the
earlier interventions fail to do.&lt;/p&gt;
&lt;p&gt;The reason that this happens is that social distancing measures do not lead to herd
immunity, so once they are lifted the epidemic starts again. In the absence of a
vaccine, it is therefore meaningless to speak about whether a policy 'aims' to get
herd immunity or not, since every country in the world will reach herd immunity
unless it is able to implement social distancing for an indefinite period of time.&lt;/p&gt;
&lt;p&gt;What mitigation policies should aim to do, therefore, is to reach herd immunity
with the minimal human cost. This will be extremely difficult, and at every
stage we will be dealing with large uncertainties. I would not want to be the
person who ultimately made the policy decisions. But to say that early
interventions are always better is incorrect.&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code ipython3"&gt;&lt;a id="rest_code_a60b412ba835495c84442a608a58c6ec-1" name="rest_code_a60b412ba835495c84442a608a58c6ec-1" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a60b412ba835495c84442a608a58c6ec-1"&gt;&lt;/a&gt;&lt;span class="c1"&gt;# Pull in libraries needed&lt;/span&gt;
&lt;a id="rest_code_a60b412ba835495c84442a608a58c6ec-2" name="rest_code_a60b412ba835495c84442a608a58c6ec-2" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a60b412ba835495c84442a608a58c6ec-2"&gt;&lt;/a&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="k"&gt;matplotlib&lt;/span&gt; inline
&lt;a id="rest_code_a60b412ba835495c84442a608a58c6ec-3" name="rest_code_a60b412ba835495c84442a608a58c6ec-3" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a60b412ba835495c84442a608a58c6ec-3"&gt;&lt;/a&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;numpy&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;np&lt;/span&gt;
&lt;a id="rest_code_a60b412ba835495c84442a608a58c6ec-4" name="rest_code_a60b412ba835495c84442a608a58c6ec-4" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a60b412ba835495c84442a608a58c6ec-4"&gt;&lt;/a&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;scipy&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;integrate&lt;/span&gt;
&lt;a id="rest_code_a60b412ba835495c84442a608a58c6ec-5" name="rest_code_a60b412ba835495c84442a608a58c6ec-5" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a60b412ba835495c84442a608a58c6ec-5"&gt;&lt;/a&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;matplotlib.pyplot&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;plt&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="code"&gt;&lt;pre class="code ipython3"&gt;&lt;a id="rest_code_50ccf7005e66491dbad8d1af960e52e0-1" name="rest_code_50ccf7005e66491dbad8d1af960e52e0-1" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_50ccf7005e66491dbad8d1af960e52e0-1"&gt;&lt;/a&gt;&lt;span class="c1"&gt;# Represent the basic dynamics&lt;/span&gt;
&lt;a id="rest_code_50ccf7005e66491dbad8d1af960e52e0-2" name="rest_code_50ccf7005e66491dbad8d1af960e52e0-2" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_50ccf7005e66491dbad8d1af960e52e0-2"&gt;&lt;/a&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;odefun&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;beta0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;betat&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;t0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;t1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;sigma&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;gamma&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_50ccf7005e66491dbad8d1af960e52e0-3" name="rest_code_50ccf7005e66491dbad8d1af960e52e0-3" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_50ccf7005e66491dbad8d1af960e52e0-3"&gt;&lt;/a&gt;    &lt;span class="n"&gt;dx&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;6&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_50ccf7005e66491dbad8d1af960e52e0-4" name="rest_code_50ccf7005e66491dbad8d1af960e52e0-4" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_50ccf7005e66491dbad8d1af960e52e0-4"&gt;&lt;/a&gt;    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;=&lt;/span&gt;&lt;span class="n"&gt;t0&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="ow"&gt;and&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;=&lt;/span&gt;&lt;span class="n"&gt;t1&lt;/span&gt;&lt;span class="p"&gt;)):&lt;/span&gt;
&lt;a id="rest_code_50ccf7005e66491dbad8d1af960e52e0-5" name="rest_code_50ccf7005e66491dbad8d1af960e52e0-5" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_50ccf7005e66491dbad8d1af960e52e0-5"&gt;&lt;/a&gt;        &lt;span class="n"&gt;beta&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;betat&lt;/span&gt;
&lt;a id="rest_code_50ccf7005e66491dbad8d1af960e52e0-6" name="rest_code_50ccf7005e66491dbad8d1af960e52e0-6" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_50ccf7005e66491dbad8d1af960e52e0-6"&gt;&lt;/a&gt;    &lt;span class="k"&gt;else&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a id="rest_code_50ccf7005e66491dbad8d1af960e52e0-7" name="rest_code_50ccf7005e66491dbad8d1af960e52e0-7" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_50ccf7005e66491dbad8d1af960e52e0-7"&gt;&lt;/a&gt;        &lt;span class="n"&gt;beta&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;beta0&lt;/span&gt;
&lt;a id="rest_code_50ccf7005e66491dbad8d1af960e52e0-8" name="rest_code_50ccf7005e66491dbad8d1af960e52e0-8" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_50ccf7005e66491dbad8d1af960e52e0-8"&gt;&lt;/a&gt;    &lt;span class="n"&gt;dx&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;beta&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_50ccf7005e66491dbad8d1af960e52e0-9" name="rest_code_50ccf7005e66491dbad8d1af960e52e0-9" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_50ccf7005e66491dbad8d1af960e52e0-9"&gt;&lt;/a&gt;    &lt;span class="n"&gt;dx&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;beta&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;sigma&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_50ccf7005e66491dbad8d1af960e52e0-10" name="rest_code_50ccf7005e66491dbad8d1af960e52e0-10" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_50ccf7005e66491dbad8d1af960e52e0-10"&gt;&lt;/a&gt;    &lt;span class="n"&gt;dx&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;sigma&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;sigma&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_50ccf7005e66491dbad8d1af960e52e0-11" name="rest_code_50ccf7005e66491dbad8d1af960e52e0-11" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_50ccf7005e66491dbad8d1af960e52e0-11"&gt;&lt;/a&gt;    &lt;span class="n"&gt;dx&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;sigma&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;gamma&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_50ccf7005e66491dbad8d1af960e52e0-12" name="rest_code_50ccf7005e66491dbad8d1af960e52e0-12" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_50ccf7005e66491dbad8d1af960e52e0-12"&gt;&lt;/a&gt;    &lt;span class="n"&gt;dx&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;gamma&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;gamma&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_50ccf7005e66491dbad8d1af960e52e0-13" name="rest_code_50ccf7005e66491dbad8d1af960e52e0-13" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_50ccf7005e66491dbad8d1af960e52e0-13"&gt;&lt;/a&gt;    &lt;span class="n"&gt;dx&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;gamma&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_50ccf7005e66491dbad8d1af960e52e0-14" name="rest_code_50ccf7005e66491dbad8d1af960e52e0-14" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_50ccf7005e66491dbad8d1af960e52e0-14"&gt;&lt;/a&gt;    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;dx&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="code"&gt;&lt;pre class="code ipython3"&gt;&lt;a id="rest_code_235f3c6356b64e44a3496d2d004cdec2-1" name="rest_code_235f3c6356b64e44a3496d2d004cdec2-1" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_235f3c6356b64e44a3496d2d004cdec2-1"&gt;&lt;/a&gt;&lt;span class="c1"&gt;# Parameters of the model&lt;/span&gt;
&lt;a id="rest_code_235f3c6356b64e44a3496d2d004cdec2-2" name="rest_code_235f3c6356b64e44a3496d2d004cdec2-2" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_235f3c6356b64e44a3496d2d004cdec2-2"&gt;&lt;/a&gt;&lt;span class="n"&gt;N&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;6.7e7&lt;/span&gt; &lt;span class="c1"&gt;# Total population&lt;/span&gt;
&lt;a id="rest_code_235f3c6356b64e44a3496d2d004cdec2-3" name="rest_code_235f3c6356b64e44a3496d2d004cdec2-3" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_235f3c6356b64e44a3496d2d004cdec2-3"&gt;&lt;/a&gt;&lt;span class="n"&gt;i0&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;1e-4&lt;/span&gt; &lt;span class="c1"&gt;# 0.5*Proportion of the population infected on day 0&lt;/span&gt;
&lt;a id="rest_code_235f3c6356b64e44a3496d2d004cdec2-4" name="rest_code_235f3c6356b64e44a3496d2d004cdec2-4" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_235f3c6356b64e44a3496d2d004cdec2-4"&gt;&lt;/a&gt;&lt;span class="n"&gt;tlast&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;365.0&lt;/span&gt; &lt;span class="c1"&gt;# Consider a year&lt;/span&gt;
&lt;a id="rest_code_235f3c6356b64e44a3496d2d004cdec2-5" name="rest_code_235f3c6356b64e44a3496d2d004cdec2-5" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_235f3c6356b64e44a3496d2d004cdec2-5"&gt;&lt;/a&gt;&lt;span class="n"&gt;latent_period&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;5.0&lt;/span&gt; &lt;span class="c1"&gt;# Days between being infected and becoming infectious&lt;/span&gt;
&lt;a id="rest_code_235f3c6356b64e44a3496d2d004cdec2-6" name="rest_code_235f3c6356b64e44a3496d2d004cdec2-6" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_235f3c6356b64e44a3496d2d004cdec2-6"&gt;&lt;/a&gt;&lt;span class="n"&gt;infectious_period&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;7.0&lt;/span&gt; &lt;span class="c1"&gt;# Days infectious&lt;/span&gt;
&lt;a id="rest_code_235f3c6356b64e44a3496d2d004cdec2-7" name="rest_code_235f3c6356b64e44a3496d2d004cdec2-7" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_235f3c6356b64e44a3496d2d004cdec2-7"&gt;&lt;/a&gt;&lt;span class="n"&gt;R0&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;2.5&lt;/span&gt; &lt;span class="c1"&gt;# Basic reproduction number in the absence of interventions&lt;/span&gt;
&lt;a id="rest_code_235f3c6356b64e44a3496d2d004cdec2-8" name="rest_code_235f3c6356b64e44a3496d2d004cdec2-8" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_235f3c6356b64e44a3496d2d004cdec2-8"&gt;&lt;/a&gt;&lt;span class="n"&gt;Rt&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;0.75&lt;/span&gt; &lt;span class="c1"&gt;# Reproduction number in the presence of interventions&lt;/span&gt;
&lt;a id="rest_code_235f3c6356b64e44a3496d2d004cdec2-9" name="rest_code_235f3c6356b64e44a3496d2d004cdec2-9" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_235f3c6356b64e44a3496d2d004cdec2-9"&gt;&lt;/a&gt;&lt;span class="n"&gt;tend&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;21.0&lt;/span&gt; &lt;span class="c1"&gt;# Number of days of interventions&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="code"&gt;&lt;pre class="code ipython3"&gt;&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-1" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-1" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-1"&gt;&lt;/a&gt;&lt;span class="n"&gt;beta0&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;R0&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="n"&gt;infectious_period&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-2" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-2" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-2"&gt;&lt;/a&gt;&lt;span class="n"&gt;betat&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Rt&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="n"&gt;infectious_period&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-3" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-3" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-3"&gt;&lt;/a&gt;&lt;span class="n"&gt;sigma&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;2.0&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="n"&gt;latent_period&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-4" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-4" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-4"&gt;&lt;/a&gt;&lt;span class="n"&gt;gamma&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;2.0&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="n"&gt;infectious_period&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-5" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-5" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-5"&gt;&lt;/a&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-6" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-6" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-6"&gt;&lt;/a&gt;&lt;span class="n"&gt;t0ran&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;array&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;100&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;40&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;52.5&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;65&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-7" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-7" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-7"&gt;&lt;/a&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-8" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-8" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-8"&gt;&lt;/a&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;mylab&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-9" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-9" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-9"&gt;&lt;/a&gt;    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-10" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-10" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-10"&gt;&lt;/a&gt;        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="s2"&gt;"Start at "&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="nb"&gt;str&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="s2"&gt;" days"&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-11" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-11" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-11"&gt;&lt;/a&gt;    &lt;span class="k"&gt;else&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-12" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-12" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-12"&gt;&lt;/a&gt;        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="s2"&gt;"Baseline"&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-13" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-13" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-13"&gt;&lt;/a&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-14" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-14" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-14"&gt;&lt;/a&gt;&lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;[]&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-15" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-15" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-15"&gt;&lt;/a&gt;&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;tt&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t0ran&lt;/span&gt;&lt;span class="p"&gt;)):&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-16" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-16" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-16"&gt;&lt;/a&gt;    &lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;append&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;integrate&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;solve_ivp&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;lambda&lt;/span&gt; &lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;odefun&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;beta0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;betat&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;t0ran&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;&lt;span class="n"&gt;t0ran&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="n"&gt;tend&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;sigma&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;gamma&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-17" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-17" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-17"&gt;&lt;/a&gt;                              &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;0.0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;tlast&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-18" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-18" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-18"&gt;&lt;/a&gt;                              &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;array&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="mf"&gt;1.0&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;2.0&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;i0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;0.0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;0.0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;i0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;i0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;0.0&lt;/span&gt;&lt;span class="p"&gt;]),&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-19" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-19" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-19"&gt;&lt;/a&gt;                              &lt;span class="s1"&gt;'RK45'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-20" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-20" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-20"&gt;&lt;/a&gt;                              &lt;span class="n"&gt;atol&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mf"&gt;1e-8&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-21" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-21" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-21"&gt;&lt;/a&gt;                              &lt;span class="n"&gt;rtol&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mf"&gt;1e-9&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="code"&gt;&lt;pre class="code ipython3"&gt;&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-1" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-1" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-1"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;figure&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;figsize&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-2" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-2" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-2"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;subplot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-3" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-3" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-3"&gt;&lt;/a&gt;&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;tt&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t0ran&lt;/span&gt;&lt;span class="p"&gt;)):&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-4" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-4" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-4"&gt;&lt;/a&gt;    &lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;plot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;T&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;label&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;mylab&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t0ran&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]))&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-5" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-5" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-5"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xlim&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="mi"&gt;30&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;70&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-6" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-6" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-6"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ylim&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mf"&gt;7e6&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-7" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-7" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-7"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'Time (days)'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-8" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-8" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-8"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ylabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'Number of infectious cases'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-9" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-9" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-9"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;legend&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-10" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-10" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-10"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;subplot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-11" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-11" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-11"&gt;&lt;/a&gt;&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;tt&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t0ran&lt;/span&gt;&lt;span class="p"&gt;)):&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-12" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-12" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-12"&gt;&lt;/a&gt;    &lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;plot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;T&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;label&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;mylab&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t0ran&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]))&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-13" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-13" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-13"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'Time (days)'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-14" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-14" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-14"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ylabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'Cumulative infections'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-15" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-15" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-15"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;legend&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-16" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-16" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-16"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xlim&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="mi"&gt;30&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;70&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-17" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-17" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-17"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ylim&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mf"&gt;1e7&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-18" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-18" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-18"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;tight_layout&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-19" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-19" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-19"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;show&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="code"&gt;&lt;pre class="code ipython3"&gt;&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-1" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-1" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-1"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;figure&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;figsize&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-2" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-2" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-2"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;subplot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-3" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-3" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-3"&gt;&lt;/a&gt;&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;tt&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t0ran&lt;/span&gt;&lt;span class="p"&gt;)):&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-4" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-4" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-4"&gt;&lt;/a&gt;    &lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;plot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;T&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;label&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;mylab&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t0ran&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]))&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-5" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-5" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-5"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xlim&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;tlast&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-6" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-6" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-6"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ylim&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mf"&gt;1.2e7&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-7" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-7" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-7"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'Time (days)'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-8" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-8" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-8"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ylabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'Number of infectious cases'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-9" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-9" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-9"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;legend&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-10" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-10" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-10"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;subplot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-11" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-11" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-11"&gt;&lt;/a&gt;&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;tt&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t0ran&lt;/span&gt;&lt;span class="p"&gt;)):&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-12" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-12" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-12"&gt;&lt;/a&gt;    &lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;plot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;T&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;label&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;mylab&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t0ran&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]))&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-13" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-13" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-13"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'Time (days)'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-14" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-14" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-14"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ylabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'Cumulative infections'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-15" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-15" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-15"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;legend&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-16" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-16" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-16"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xlim&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;tlast&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-17" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-17" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-17"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ylim&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mf"&gt;6.2e7&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-18" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-18" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-18"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;tight_layout&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-19" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-19" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-19"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;show&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;&lt;/body&gt;&lt;/html&gt;

&lt;p&gt;While the individuals in the cartoon with a crossed out arrow pointing towards
them are literally immune, the people that they would have infected benefit
from &lt;strong&gt;herd immunity&lt;/strong&gt;. They can be infected if exposed, but will not be. This
is particularly beneficial to the people who are particularly vulnerable to the
disease, who might die if they catch it. The general formula for herd immunity
is that when over &lt;span class="raw-html"&gt;\((1 - (1/R_0))\times 100\%\)&lt;/span&gt; of the population
is immune, then the epidemic will start to die out.&lt;/p&gt;
&lt;p&gt;Now suppose we simulate a more realistic scenario. The Python code for this is
at the bottom of this post, and it is much simpler than the models that are
typically used to guide policy, but captures the basic phenomena of interest.
In particular, we suppose that we can reduce transmission through social
distancing measures like closing schools and workplaces, but that this is only
possible for three weeks. This represents the fact that the costs of not
educating children and not doing other activities can become quite large over
time, and in some cases can lead to levels death and illness that could exceed
those due to the unchecked epidemic. Running the epidemic model with these
interventions gives the following results for cases at a given moment and total
cases over time.&lt;/p&gt;
&lt;img alt="../output_5.png" src="https://personalpages.manchester.ac.uk/staff/thomas.house/output_5.png"&gt;
&lt;p&gt;It seems that the Tweet was right - look at the difference the early intervention
makes! But now let us zoom out of the graph; then the picture looks like the below.&lt;/p&gt;
&lt;img alt="../output_6_0.png" src="https://personalpages.manchester.ac.uk/staff/thomas.house/output_6_0.png"&gt;
&lt;p&gt;In fact, the later intervention dramatically reduces the burden on the healthcare
system, cutting in half the maximum numbers ill and potentially needing treatment
at any one time, and significantly reduces the final number infected, which the
earlier interventions fail to do.&lt;/p&gt;
&lt;p&gt;The reason that this happens is that social distancing measures do not lead to herd
immunity, so once they are lifted the epidemic starts again. In the absence of a
vaccine, it is therefore meaningless to speak about whether a policy 'aims' to get
herd immunity or not, since every country in the world will reach herd immunity
unless it is able to implement social distancing for an indefinite period of time.&lt;/p&gt;
&lt;p&gt;What mitigation policies should aim to do, therefore, is to reach herd immunity
with the minimal human cost. This will be extremely difficult, and at every
stage we will be dealing with large uncertainties. I would not want to be the
person who ultimately made the policy decisions. But to say that early
interventions are always better is incorrect.&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code ipython3"&gt;&lt;a id="rest_code_a60b412ba835495c84442a608a58c6ec-1" name="rest_code_a60b412ba835495c84442a608a58c6ec-1" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a60b412ba835495c84442a608a58c6ec-1"&gt;&lt;/a&gt;&lt;span class="c1"&gt;# Pull in libraries needed&lt;/span&gt;
&lt;a id="rest_code_a60b412ba835495c84442a608a58c6ec-2" name="rest_code_a60b412ba835495c84442a608a58c6ec-2" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a60b412ba835495c84442a608a58c6ec-2"&gt;&lt;/a&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="k"&gt;matplotlib&lt;/span&gt; inline
&lt;a id="rest_code_a60b412ba835495c84442a608a58c6ec-3" name="rest_code_a60b412ba835495c84442a608a58c6ec-3" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a60b412ba835495c84442a608a58c6ec-3"&gt;&lt;/a&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;numpy&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;np&lt;/span&gt;
&lt;a id="rest_code_a60b412ba835495c84442a608a58c6ec-4" name="rest_code_a60b412ba835495c84442a608a58c6ec-4" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a60b412ba835495c84442a608a58c6ec-4"&gt;&lt;/a&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;scipy&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;integrate&lt;/span&gt;
&lt;a id="rest_code_a60b412ba835495c84442a608a58c6ec-5" name="rest_code_a60b412ba835495c84442a608a58c6ec-5" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a60b412ba835495c84442a608a58c6ec-5"&gt;&lt;/a&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;matplotlib.pyplot&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;plt&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="code"&gt;&lt;pre class="code ipython3"&gt;&lt;a id="rest_code_50ccf7005e66491dbad8d1af960e52e0-1" name="rest_code_50ccf7005e66491dbad8d1af960e52e0-1" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_50ccf7005e66491dbad8d1af960e52e0-1"&gt;&lt;/a&gt;&lt;span class="c1"&gt;# Represent the basic dynamics&lt;/span&gt;
&lt;a id="rest_code_50ccf7005e66491dbad8d1af960e52e0-2" name="rest_code_50ccf7005e66491dbad8d1af960e52e0-2" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_50ccf7005e66491dbad8d1af960e52e0-2"&gt;&lt;/a&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;odefun&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;beta0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;betat&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;t0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;t1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;sigma&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;gamma&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_50ccf7005e66491dbad8d1af960e52e0-3" name="rest_code_50ccf7005e66491dbad8d1af960e52e0-3" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_50ccf7005e66491dbad8d1af960e52e0-3"&gt;&lt;/a&gt;    &lt;span class="n"&gt;dx&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;6&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_50ccf7005e66491dbad8d1af960e52e0-4" name="rest_code_50ccf7005e66491dbad8d1af960e52e0-4" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_50ccf7005e66491dbad8d1af960e52e0-4"&gt;&lt;/a&gt;    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;=&lt;/span&gt;&lt;span class="n"&gt;t0&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="ow"&gt;and&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;=&lt;/span&gt;&lt;span class="n"&gt;t1&lt;/span&gt;&lt;span class="p"&gt;)):&lt;/span&gt;
&lt;a id="rest_code_50ccf7005e66491dbad8d1af960e52e0-5" name="rest_code_50ccf7005e66491dbad8d1af960e52e0-5" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_50ccf7005e66491dbad8d1af960e52e0-5"&gt;&lt;/a&gt;        &lt;span class="n"&gt;beta&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;betat&lt;/span&gt;
&lt;a id="rest_code_50ccf7005e66491dbad8d1af960e52e0-6" name="rest_code_50ccf7005e66491dbad8d1af960e52e0-6" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_50ccf7005e66491dbad8d1af960e52e0-6"&gt;&lt;/a&gt;    &lt;span class="k"&gt;else&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a id="rest_code_50ccf7005e66491dbad8d1af960e52e0-7" name="rest_code_50ccf7005e66491dbad8d1af960e52e0-7" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_50ccf7005e66491dbad8d1af960e52e0-7"&gt;&lt;/a&gt;        &lt;span class="n"&gt;beta&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;beta0&lt;/span&gt;
&lt;a id="rest_code_50ccf7005e66491dbad8d1af960e52e0-8" name="rest_code_50ccf7005e66491dbad8d1af960e52e0-8" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_50ccf7005e66491dbad8d1af960e52e0-8"&gt;&lt;/a&gt;    &lt;span class="n"&gt;dx&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;beta&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_50ccf7005e66491dbad8d1af960e52e0-9" name="rest_code_50ccf7005e66491dbad8d1af960e52e0-9" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_50ccf7005e66491dbad8d1af960e52e0-9"&gt;&lt;/a&gt;    &lt;span class="n"&gt;dx&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;beta&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;sigma&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_50ccf7005e66491dbad8d1af960e52e0-10" name="rest_code_50ccf7005e66491dbad8d1af960e52e0-10" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_50ccf7005e66491dbad8d1af960e52e0-10"&gt;&lt;/a&gt;    &lt;span class="n"&gt;dx&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;sigma&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;sigma&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_50ccf7005e66491dbad8d1af960e52e0-11" name="rest_code_50ccf7005e66491dbad8d1af960e52e0-11" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_50ccf7005e66491dbad8d1af960e52e0-11"&gt;&lt;/a&gt;    &lt;span class="n"&gt;dx&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;sigma&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;gamma&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_50ccf7005e66491dbad8d1af960e52e0-12" name="rest_code_50ccf7005e66491dbad8d1af960e52e0-12" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_50ccf7005e66491dbad8d1af960e52e0-12"&gt;&lt;/a&gt;    &lt;span class="n"&gt;dx&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;gamma&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;gamma&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_50ccf7005e66491dbad8d1af960e52e0-13" name="rest_code_50ccf7005e66491dbad8d1af960e52e0-13" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_50ccf7005e66491dbad8d1af960e52e0-13"&gt;&lt;/a&gt;    &lt;span class="n"&gt;dx&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;gamma&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_50ccf7005e66491dbad8d1af960e52e0-14" name="rest_code_50ccf7005e66491dbad8d1af960e52e0-14" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_50ccf7005e66491dbad8d1af960e52e0-14"&gt;&lt;/a&gt;    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;dx&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="code"&gt;&lt;pre class="code ipython3"&gt;&lt;a id="rest_code_235f3c6356b64e44a3496d2d004cdec2-1" name="rest_code_235f3c6356b64e44a3496d2d004cdec2-1" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_235f3c6356b64e44a3496d2d004cdec2-1"&gt;&lt;/a&gt;&lt;span class="c1"&gt;# Parameters of the model&lt;/span&gt;
&lt;a id="rest_code_235f3c6356b64e44a3496d2d004cdec2-2" name="rest_code_235f3c6356b64e44a3496d2d004cdec2-2" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_235f3c6356b64e44a3496d2d004cdec2-2"&gt;&lt;/a&gt;&lt;span class="n"&gt;N&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;6.7e7&lt;/span&gt; &lt;span class="c1"&gt;# Total population&lt;/span&gt;
&lt;a id="rest_code_235f3c6356b64e44a3496d2d004cdec2-3" name="rest_code_235f3c6356b64e44a3496d2d004cdec2-3" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_235f3c6356b64e44a3496d2d004cdec2-3"&gt;&lt;/a&gt;&lt;span class="n"&gt;i0&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;1e-4&lt;/span&gt; &lt;span class="c1"&gt;# 0.5*Proportion of the population infected on day 0&lt;/span&gt;
&lt;a id="rest_code_235f3c6356b64e44a3496d2d004cdec2-4" name="rest_code_235f3c6356b64e44a3496d2d004cdec2-4" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_235f3c6356b64e44a3496d2d004cdec2-4"&gt;&lt;/a&gt;&lt;span class="n"&gt;tlast&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;365.0&lt;/span&gt; &lt;span class="c1"&gt;# Consider a year&lt;/span&gt;
&lt;a id="rest_code_235f3c6356b64e44a3496d2d004cdec2-5" name="rest_code_235f3c6356b64e44a3496d2d004cdec2-5" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_235f3c6356b64e44a3496d2d004cdec2-5"&gt;&lt;/a&gt;&lt;span class="n"&gt;latent_period&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;5.0&lt;/span&gt; &lt;span class="c1"&gt;# Days between being infected and becoming infectious&lt;/span&gt;
&lt;a id="rest_code_235f3c6356b64e44a3496d2d004cdec2-6" name="rest_code_235f3c6356b64e44a3496d2d004cdec2-6" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_235f3c6356b64e44a3496d2d004cdec2-6"&gt;&lt;/a&gt;&lt;span class="n"&gt;infectious_period&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;7.0&lt;/span&gt; &lt;span class="c1"&gt;# Days infectious&lt;/span&gt;
&lt;a id="rest_code_235f3c6356b64e44a3496d2d004cdec2-7" name="rest_code_235f3c6356b64e44a3496d2d004cdec2-7" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_235f3c6356b64e44a3496d2d004cdec2-7"&gt;&lt;/a&gt;&lt;span class="n"&gt;R0&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;2.5&lt;/span&gt; &lt;span class="c1"&gt;# Basic reproduction number in the absence of interventions&lt;/span&gt;
&lt;a id="rest_code_235f3c6356b64e44a3496d2d004cdec2-8" name="rest_code_235f3c6356b64e44a3496d2d004cdec2-8" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_235f3c6356b64e44a3496d2d004cdec2-8"&gt;&lt;/a&gt;&lt;span class="n"&gt;Rt&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;0.75&lt;/span&gt; &lt;span class="c1"&gt;# Reproduction number in the presence of interventions&lt;/span&gt;
&lt;a id="rest_code_235f3c6356b64e44a3496d2d004cdec2-9" name="rest_code_235f3c6356b64e44a3496d2d004cdec2-9" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_235f3c6356b64e44a3496d2d004cdec2-9"&gt;&lt;/a&gt;&lt;span class="n"&gt;tend&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;21.0&lt;/span&gt; &lt;span class="c1"&gt;# Number of days of interventions&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="code"&gt;&lt;pre class="code ipython3"&gt;&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-1" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-1" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-1"&gt;&lt;/a&gt;&lt;span class="n"&gt;beta0&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;R0&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="n"&gt;infectious_period&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-2" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-2" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-2"&gt;&lt;/a&gt;&lt;span class="n"&gt;betat&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Rt&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="n"&gt;infectious_period&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-3" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-3" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-3"&gt;&lt;/a&gt;&lt;span class="n"&gt;sigma&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;2.0&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="n"&gt;latent_period&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-4" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-4" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-4"&gt;&lt;/a&gt;&lt;span class="n"&gt;gamma&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;2.0&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="n"&gt;infectious_period&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-5" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-5" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-5"&gt;&lt;/a&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-6" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-6" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-6"&gt;&lt;/a&gt;&lt;span class="n"&gt;t0ran&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;array&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;100&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;40&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;52.5&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;65&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-7" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-7" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-7"&gt;&lt;/a&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-8" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-8" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-8"&gt;&lt;/a&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;mylab&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-9" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-9" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-9"&gt;&lt;/a&gt;    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-10" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-10" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-10"&gt;&lt;/a&gt;        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="s2"&gt;"Start at "&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="nb"&gt;str&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="s2"&gt;" days"&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-11" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-11" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-11"&gt;&lt;/a&gt;    &lt;span class="k"&gt;else&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-12" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-12" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-12"&gt;&lt;/a&gt;        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="s2"&gt;"Baseline"&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-13" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-13" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-13"&gt;&lt;/a&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-14" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-14" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-14"&gt;&lt;/a&gt;&lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;[]&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-15" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-15" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-15"&gt;&lt;/a&gt;&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;tt&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t0ran&lt;/span&gt;&lt;span class="p"&gt;)):&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-16" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-16" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-16"&gt;&lt;/a&gt;    &lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;append&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;integrate&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;solve_ivp&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;lambda&lt;/span&gt; &lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;odefun&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;beta0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;betat&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;t0ran&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;&lt;span class="n"&gt;t0ran&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="n"&gt;tend&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;sigma&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;gamma&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-17" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-17" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-17"&gt;&lt;/a&gt;                              &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;0.0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;tlast&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-18" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-18" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-18"&gt;&lt;/a&gt;                              &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;array&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="mf"&gt;1.0&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;2.0&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;i0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;0.0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;0.0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;i0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;i0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;0.0&lt;/span&gt;&lt;span class="p"&gt;]),&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-19" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-19" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-19"&gt;&lt;/a&gt;                              &lt;span class="s1"&gt;'RK45'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-20" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-20" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-20"&gt;&lt;/a&gt;                              &lt;span class="n"&gt;atol&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mf"&gt;1e-8&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-21" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-21" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-21"&gt;&lt;/a&gt;                              &lt;span class="n"&gt;rtol&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mf"&gt;1e-9&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="code"&gt;&lt;pre class="code ipython3"&gt;&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-1" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-1" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-1"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;figure&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;figsize&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-2" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-2" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-2"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;subplot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-3" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-3" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-3"&gt;&lt;/a&gt;&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;tt&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t0ran&lt;/span&gt;&lt;span class="p"&gt;)):&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-4" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-4" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-4"&gt;&lt;/a&gt;    &lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;plot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;T&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;label&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;mylab&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t0ran&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]))&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-5" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-5" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-5"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xlim&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="mi"&gt;30&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;70&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-6" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-6" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-6"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ylim&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mf"&gt;7e6&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-7" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-7" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-7"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'Time (days)'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-8" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-8" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-8"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ylabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'Number of infectious cases'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-9" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-9" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-9"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;legend&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-10" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-10" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-10"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;subplot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-11" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-11" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-11"&gt;&lt;/a&gt;&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;tt&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t0ran&lt;/span&gt;&lt;span class="p"&gt;)):&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-12" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-12" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-12"&gt;&lt;/a&gt;    &lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;plot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;T&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;label&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;mylab&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t0ran&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]))&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-13" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-13" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-13"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'Time (days)'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-14" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-14" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-14"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ylabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'Cumulative infections'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-15" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-15" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-15"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;legend&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-16" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-16" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-16"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xlim&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="mi"&gt;30&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;70&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-17" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-17" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-17"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ylim&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mf"&gt;1e7&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-18" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-18" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-18"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;tight_layout&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-19" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-19" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-19"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;show&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="code"&gt;&lt;pre class="code ipython3"&gt;&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-1" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-1" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-1"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;figure&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;figsize&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-2" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-2" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-2"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;subplot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-3" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-3" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-3"&gt;&lt;/a&gt;&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;tt&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t0ran&lt;/span&gt;&lt;span class="p"&gt;)):&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-4" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-4" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-4"&gt;&lt;/a&gt;    &lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;plot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;T&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;label&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;mylab&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t0ran&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]))&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-5" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-5" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-5"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xlim&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;tlast&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-6" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-6" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-6"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ylim&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mf"&gt;1.2e7&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-7" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-7" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-7"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'Time (days)'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-8" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-8" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-8"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ylabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'Number of infectious cases'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-9" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-9" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-9"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;legend&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-10" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-10" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-10"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;subplot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-11" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-11" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-11"&gt;&lt;/a&gt;&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;tt&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t0ran&lt;/span&gt;&lt;span class="p"&gt;)):&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-12" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-12" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-12"&gt;&lt;/a&gt;    &lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;plot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;T&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;label&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;mylab&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t0ran&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]))&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-13" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-13" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-13"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'Time (days)'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-14" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-14" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-14"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ylabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'Cumulative infections'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-15" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-15" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-15"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;legend&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-16" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-16" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-16"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xlim&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;tlast&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-17" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-17" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-17"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ylim&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mf"&gt;6.2e7&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-18" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-18" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-18"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;tight_layout&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-19" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-19" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-19"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;show&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;&lt;/body&gt;&lt;/html&gt;

&lt;p&gt;Now suppose we simulate a more realistic scenario. The Python code for this is
at the bottom of this post, and it is much simpler than the models that are
typically used to guide policy, but captures the basic phenomena of interest.
In particular, we suppose that we can reduce transmission through social
distancing measures like closing schools and workplaces, but that this is only
possible for three weeks. This represents the fact that the costs of not
educating children and not doing other activities can become quite large over
time, and in some cases can lead to levels death and illness that could exceed
those due to the unchecked epidemic. Running the epidemic model with these
interventions gives the following results for cases at a given moment and total
cases over time.&lt;/p&gt;
&lt;img alt="../output_5.png" src="https://personalpages.manchester.ac.uk/staff/thomas.house/output_5.png"&gt;
&lt;p&gt;It seems that the Tweet was right - look at the difference the early intervention
makes! But now let us zoom out of the graph; then the picture looks like the below.&lt;/p&gt;
&lt;img alt="../output_6_0.png" src="https://personalpages.manchester.ac.uk/staff/thomas.house/output_6_0.png"&gt;
&lt;p&gt;In fact, the later intervention dramatically reduces the burden on the healthcare
system, cutting in half the maximum numbers ill and potentially needing treatment
at any one time, and significantly reduces the final number infected, which the
earlier interventions fail to do.&lt;/p&gt;
&lt;p&gt;The reason that this happens is that social distancing measures do not lead to herd
immunity, so once they are lifted the epidemic starts again. In the absence of a
vaccine, it is therefore meaningless to speak about whether a policy 'aims' to get
herd immunity or not, since every country in the world will reach herd immunity
unless it is able to implement social distancing for an indefinite period of time.&lt;/p&gt;
&lt;p&gt;What mitigation policies should aim to do, therefore, is to reach herd immunity
with the minimal human cost. This will be extremely difficult, and at every
stage we will be dealing with large uncertainties. I would not want to be the
person who ultimately made the policy decisions. But to say that early
interventions are always better is incorrect.&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code ipython3"&gt;&lt;a id="rest_code_a60b412ba835495c84442a608a58c6ec-1" name="rest_code_a60b412ba835495c84442a608a58c6ec-1" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a60b412ba835495c84442a608a58c6ec-1"&gt;&lt;/a&gt;&lt;span class="c1"&gt;# Pull in libraries needed&lt;/span&gt;
&lt;a id="rest_code_a60b412ba835495c84442a608a58c6ec-2" name="rest_code_a60b412ba835495c84442a608a58c6ec-2" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a60b412ba835495c84442a608a58c6ec-2"&gt;&lt;/a&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="k"&gt;matplotlib&lt;/span&gt; inline
&lt;a id="rest_code_a60b412ba835495c84442a608a58c6ec-3" name="rest_code_a60b412ba835495c84442a608a58c6ec-3" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a60b412ba835495c84442a608a58c6ec-3"&gt;&lt;/a&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;numpy&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;np&lt;/span&gt;
&lt;a id="rest_code_a60b412ba835495c84442a608a58c6ec-4" name="rest_code_a60b412ba835495c84442a608a58c6ec-4" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a60b412ba835495c84442a608a58c6ec-4"&gt;&lt;/a&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;scipy&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;integrate&lt;/span&gt;
&lt;a id="rest_code_a60b412ba835495c84442a608a58c6ec-5" name="rest_code_a60b412ba835495c84442a608a58c6ec-5" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a60b412ba835495c84442a608a58c6ec-5"&gt;&lt;/a&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;matplotlib.pyplot&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;plt&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="code"&gt;&lt;pre class="code ipython3"&gt;&lt;a id="rest_code_50ccf7005e66491dbad8d1af960e52e0-1" name="rest_code_50ccf7005e66491dbad8d1af960e52e0-1" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_50ccf7005e66491dbad8d1af960e52e0-1"&gt;&lt;/a&gt;&lt;span class="c1"&gt;# Represent the basic dynamics&lt;/span&gt;
&lt;a id="rest_code_50ccf7005e66491dbad8d1af960e52e0-2" name="rest_code_50ccf7005e66491dbad8d1af960e52e0-2" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_50ccf7005e66491dbad8d1af960e52e0-2"&gt;&lt;/a&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;odefun&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;beta0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;betat&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;t0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;t1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;sigma&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;gamma&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_50ccf7005e66491dbad8d1af960e52e0-3" name="rest_code_50ccf7005e66491dbad8d1af960e52e0-3" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_50ccf7005e66491dbad8d1af960e52e0-3"&gt;&lt;/a&gt;    &lt;span class="n"&gt;dx&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;6&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_50ccf7005e66491dbad8d1af960e52e0-4" name="rest_code_50ccf7005e66491dbad8d1af960e52e0-4" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_50ccf7005e66491dbad8d1af960e52e0-4"&gt;&lt;/a&gt;    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;=&lt;/span&gt;&lt;span class="n"&gt;t0&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="ow"&gt;and&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;=&lt;/span&gt;&lt;span class="n"&gt;t1&lt;/span&gt;&lt;span class="p"&gt;)):&lt;/span&gt;
&lt;a id="rest_code_50ccf7005e66491dbad8d1af960e52e0-5" name="rest_code_50ccf7005e66491dbad8d1af960e52e0-5" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_50ccf7005e66491dbad8d1af960e52e0-5"&gt;&lt;/a&gt;        &lt;span class="n"&gt;beta&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;betat&lt;/span&gt;
&lt;a id="rest_code_50ccf7005e66491dbad8d1af960e52e0-6" name="rest_code_50ccf7005e66491dbad8d1af960e52e0-6" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_50ccf7005e66491dbad8d1af960e52e0-6"&gt;&lt;/a&gt;    &lt;span class="k"&gt;else&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a id="rest_code_50ccf7005e66491dbad8d1af960e52e0-7" name="rest_code_50ccf7005e66491dbad8d1af960e52e0-7" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_50ccf7005e66491dbad8d1af960e52e0-7"&gt;&lt;/a&gt;        &lt;span class="n"&gt;beta&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;beta0&lt;/span&gt;
&lt;a id="rest_code_50ccf7005e66491dbad8d1af960e52e0-8" name="rest_code_50ccf7005e66491dbad8d1af960e52e0-8" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_50ccf7005e66491dbad8d1af960e52e0-8"&gt;&lt;/a&gt;    &lt;span class="n"&gt;dx&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;beta&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_50ccf7005e66491dbad8d1af960e52e0-9" name="rest_code_50ccf7005e66491dbad8d1af960e52e0-9" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_50ccf7005e66491dbad8d1af960e52e0-9"&gt;&lt;/a&gt;    &lt;span class="n"&gt;dx&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;beta&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;sigma&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_50ccf7005e66491dbad8d1af960e52e0-10" name="rest_code_50ccf7005e66491dbad8d1af960e52e0-10" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_50ccf7005e66491dbad8d1af960e52e0-10"&gt;&lt;/a&gt;    &lt;span class="n"&gt;dx&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;sigma&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;sigma&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_50ccf7005e66491dbad8d1af960e52e0-11" name="rest_code_50ccf7005e66491dbad8d1af960e52e0-11" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_50ccf7005e66491dbad8d1af960e52e0-11"&gt;&lt;/a&gt;    &lt;span class="n"&gt;dx&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;sigma&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;gamma&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_50ccf7005e66491dbad8d1af960e52e0-12" name="rest_code_50ccf7005e66491dbad8d1af960e52e0-12" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_50ccf7005e66491dbad8d1af960e52e0-12"&gt;&lt;/a&gt;    &lt;span class="n"&gt;dx&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;gamma&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;gamma&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_50ccf7005e66491dbad8d1af960e52e0-13" name="rest_code_50ccf7005e66491dbad8d1af960e52e0-13" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_50ccf7005e66491dbad8d1af960e52e0-13"&gt;&lt;/a&gt;    &lt;span class="n"&gt;dx&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;gamma&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_50ccf7005e66491dbad8d1af960e52e0-14" name="rest_code_50ccf7005e66491dbad8d1af960e52e0-14" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_50ccf7005e66491dbad8d1af960e52e0-14"&gt;&lt;/a&gt;    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;dx&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="code"&gt;&lt;pre class="code ipython3"&gt;&lt;a id="rest_code_235f3c6356b64e44a3496d2d004cdec2-1" name="rest_code_235f3c6356b64e44a3496d2d004cdec2-1" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_235f3c6356b64e44a3496d2d004cdec2-1"&gt;&lt;/a&gt;&lt;span class="c1"&gt;# Parameters of the model&lt;/span&gt;
&lt;a id="rest_code_235f3c6356b64e44a3496d2d004cdec2-2" name="rest_code_235f3c6356b64e44a3496d2d004cdec2-2" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_235f3c6356b64e44a3496d2d004cdec2-2"&gt;&lt;/a&gt;&lt;span class="n"&gt;N&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;6.7e7&lt;/span&gt; &lt;span class="c1"&gt;# Total population&lt;/span&gt;
&lt;a id="rest_code_235f3c6356b64e44a3496d2d004cdec2-3" name="rest_code_235f3c6356b64e44a3496d2d004cdec2-3" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_235f3c6356b64e44a3496d2d004cdec2-3"&gt;&lt;/a&gt;&lt;span class="n"&gt;i0&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;1e-4&lt;/span&gt; &lt;span class="c1"&gt;# 0.5*Proportion of the population infected on day 0&lt;/span&gt;
&lt;a id="rest_code_235f3c6356b64e44a3496d2d004cdec2-4" name="rest_code_235f3c6356b64e44a3496d2d004cdec2-4" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_235f3c6356b64e44a3496d2d004cdec2-4"&gt;&lt;/a&gt;&lt;span class="n"&gt;tlast&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;365.0&lt;/span&gt; &lt;span class="c1"&gt;# Consider a year&lt;/span&gt;
&lt;a id="rest_code_235f3c6356b64e44a3496d2d004cdec2-5" name="rest_code_235f3c6356b64e44a3496d2d004cdec2-5" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_235f3c6356b64e44a3496d2d004cdec2-5"&gt;&lt;/a&gt;&lt;span class="n"&gt;latent_period&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;5.0&lt;/span&gt; &lt;span class="c1"&gt;# Days between being infected and becoming infectious&lt;/span&gt;
&lt;a id="rest_code_235f3c6356b64e44a3496d2d004cdec2-6" name="rest_code_235f3c6356b64e44a3496d2d004cdec2-6" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_235f3c6356b64e44a3496d2d004cdec2-6"&gt;&lt;/a&gt;&lt;span class="n"&gt;infectious_period&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;7.0&lt;/span&gt; &lt;span class="c1"&gt;# Days infectious&lt;/span&gt;
&lt;a id="rest_code_235f3c6356b64e44a3496d2d004cdec2-7" name="rest_code_235f3c6356b64e44a3496d2d004cdec2-7" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_235f3c6356b64e44a3496d2d004cdec2-7"&gt;&lt;/a&gt;&lt;span class="n"&gt;R0&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;2.5&lt;/span&gt; &lt;span class="c1"&gt;# Basic reproduction number in the absence of interventions&lt;/span&gt;
&lt;a id="rest_code_235f3c6356b64e44a3496d2d004cdec2-8" name="rest_code_235f3c6356b64e44a3496d2d004cdec2-8" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_235f3c6356b64e44a3496d2d004cdec2-8"&gt;&lt;/a&gt;&lt;span class="n"&gt;Rt&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;0.75&lt;/span&gt; &lt;span class="c1"&gt;# Reproduction number in the presence of interventions&lt;/span&gt;
&lt;a id="rest_code_235f3c6356b64e44a3496d2d004cdec2-9" name="rest_code_235f3c6356b64e44a3496d2d004cdec2-9" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_235f3c6356b64e44a3496d2d004cdec2-9"&gt;&lt;/a&gt;&lt;span class="n"&gt;tend&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;21.0&lt;/span&gt; &lt;span class="c1"&gt;# Number of days of interventions&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="code"&gt;&lt;pre class="code ipython3"&gt;&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-1" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-1" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-1"&gt;&lt;/a&gt;&lt;span class="n"&gt;beta0&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;R0&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="n"&gt;infectious_period&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-2" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-2" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-2"&gt;&lt;/a&gt;&lt;span class="n"&gt;betat&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Rt&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="n"&gt;infectious_period&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-3" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-3" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-3"&gt;&lt;/a&gt;&lt;span class="n"&gt;sigma&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;2.0&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="n"&gt;latent_period&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-4" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-4" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-4"&gt;&lt;/a&gt;&lt;span class="n"&gt;gamma&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;2.0&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="n"&gt;infectious_period&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-5" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-5" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-5"&gt;&lt;/a&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-6" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-6" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-6"&gt;&lt;/a&gt;&lt;span class="n"&gt;t0ran&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;array&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;100&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;40&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;52.5&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;65&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-7" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-7" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-7"&gt;&lt;/a&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-8" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-8" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-8"&gt;&lt;/a&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;mylab&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-9" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-9" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-9"&gt;&lt;/a&gt;    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-10" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-10" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-10"&gt;&lt;/a&gt;        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="s2"&gt;"Start at "&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="nb"&gt;str&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="s2"&gt;" days"&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-11" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-11" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-11"&gt;&lt;/a&gt;    &lt;span class="k"&gt;else&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-12" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-12" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-12"&gt;&lt;/a&gt;        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="s2"&gt;"Baseline"&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-13" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-13" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-13"&gt;&lt;/a&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-14" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-14" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-14"&gt;&lt;/a&gt;&lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;[]&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-15" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-15" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-15"&gt;&lt;/a&gt;&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;tt&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t0ran&lt;/span&gt;&lt;span class="p"&gt;)):&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-16" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-16" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-16"&gt;&lt;/a&gt;    &lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;append&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;integrate&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;solve_ivp&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;lambda&lt;/span&gt; &lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;odefun&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;beta0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;betat&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;t0ran&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;&lt;span class="n"&gt;t0ran&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="n"&gt;tend&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;sigma&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;gamma&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-17" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-17" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-17"&gt;&lt;/a&gt;                              &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;0.0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;tlast&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-18" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-18" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-18"&gt;&lt;/a&gt;                              &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;array&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="mf"&gt;1.0&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;2.0&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;i0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;0.0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;0.0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;i0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;i0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;0.0&lt;/span&gt;&lt;span class="p"&gt;]),&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-19" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-19" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-19"&gt;&lt;/a&gt;                              &lt;span class="s1"&gt;'RK45'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-20" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-20" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-20"&gt;&lt;/a&gt;                              &lt;span class="n"&gt;atol&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mf"&gt;1e-8&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-21" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-21" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-21"&gt;&lt;/a&gt;                              &lt;span class="n"&gt;rtol&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mf"&gt;1e-9&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="code"&gt;&lt;pre class="code ipython3"&gt;&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-1" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-1" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-1"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;figure&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;figsize&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-2" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-2" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-2"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;subplot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-3" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-3" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-3"&gt;&lt;/a&gt;&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;tt&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t0ran&lt;/span&gt;&lt;span class="p"&gt;)):&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-4" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-4" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-4"&gt;&lt;/a&gt;    &lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;plot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;T&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;label&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;mylab&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t0ran&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]))&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-5" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-5" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-5"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xlim&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="mi"&gt;30&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;70&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-6" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-6" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-6"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ylim&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mf"&gt;7e6&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-7" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-7" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-7"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'Time (days)'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-8" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-8" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-8"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ylabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'Number of infectious cases'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-9" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-9" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-9"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;legend&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-10" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-10" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-10"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;subplot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-11" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-11" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-11"&gt;&lt;/a&gt;&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;tt&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t0ran&lt;/span&gt;&lt;span class="p"&gt;)):&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-12" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-12" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-12"&gt;&lt;/a&gt;    &lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;plot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;T&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;label&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;mylab&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t0ran&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]))&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-13" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-13" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-13"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'Time (days)'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-14" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-14" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-14"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ylabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'Cumulative infections'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-15" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-15" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-15"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;legend&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-16" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-16" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-16"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xlim&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="mi"&gt;30&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;70&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-17" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-17" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-17"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ylim&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mf"&gt;1e7&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-18" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-18" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-18"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;tight_layout&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-19" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-19" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-19"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;show&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="code"&gt;&lt;pre class="code ipython3"&gt;&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-1" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-1" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-1"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;figure&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;figsize&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-2" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-2" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-2"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;subplot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-3" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-3" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-3"&gt;&lt;/a&gt;&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;tt&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t0ran&lt;/span&gt;&lt;span class="p"&gt;)):&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-4" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-4" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-4"&gt;&lt;/a&gt;    &lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;plot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;T&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;label&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;mylab&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t0ran&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]))&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-5" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-5" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-5"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xlim&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;tlast&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-6" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-6" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-6"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ylim&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mf"&gt;1.2e7&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-7" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-7" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-7"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'Time (days)'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-8" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-8" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-8"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ylabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'Number of infectious cases'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-9" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-9" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-9"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;legend&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-10" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-10" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-10"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;subplot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-11" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-11" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-11"&gt;&lt;/a&gt;&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;tt&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t0ran&lt;/span&gt;&lt;span class="p"&gt;)):&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-12" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-12" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-12"&gt;&lt;/a&gt;    &lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;plot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;T&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;label&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;mylab&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t0ran&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]))&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-13" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-13" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-13"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'Time (days)'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-14" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-14" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-14"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ylabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'Cumulative infections'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-15" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-15" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-15"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;legend&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-16" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-16" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-16"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xlim&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;tlast&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-17" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-17" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-17"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ylim&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mf"&gt;6.2e7&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-18" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-18" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-18"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;tight_layout&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-19" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-19" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-19"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;show&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;&lt;/body&gt;&lt;/html&gt;

&lt;img alt="../output_5.png" src="https://personalpages.manchester.ac.uk/staff/thomas.house/output_5.png"&gt;
&lt;p&gt;It seems that the Tweet was right - look at the difference the early intervention
makes! But now let us zoom out of the graph; then the picture looks like the below.&lt;/p&gt;
&lt;img alt="../output_6_0.png" src="https://personalpages.manchester.ac.uk/staff/thomas.house/output_6_0.png"&gt;
&lt;p&gt;In fact, the later intervention dramatically reduces the burden on the healthcare
system, cutting in half the maximum numbers ill and potentially needing treatment
at any one time, and significantly reduces the final number infected, which the
earlier interventions fail to do.&lt;/p&gt;
&lt;p&gt;The reason that this happens is that social distancing measures do not lead to herd
immunity, so once they are lifted the epidemic starts again. In the absence of a
vaccine, it is therefore meaningless to speak about whether a policy 'aims' to get
herd immunity or not, since every country in the world will reach herd immunity
unless it is able to implement social distancing for an indefinite period of time.&lt;/p&gt;
&lt;p&gt;What mitigation policies should aim to do, therefore, is to reach herd immunity
with the minimal human cost. This will be extremely difficult, and at every
stage we will be dealing with large uncertainties. I would not want to be the
person who ultimately made the policy decisions. But to say that early
interventions are always better is incorrect.&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code ipython3"&gt;&lt;a id="rest_code_a60b412ba835495c84442a608a58c6ec-1" name="rest_code_a60b412ba835495c84442a608a58c6ec-1" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a60b412ba835495c84442a608a58c6ec-1"&gt;&lt;/a&gt;&lt;span class="c1"&gt;# Pull in libraries needed&lt;/span&gt;
&lt;a id="rest_code_a60b412ba835495c84442a608a58c6ec-2" name="rest_code_a60b412ba835495c84442a608a58c6ec-2" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a60b412ba835495c84442a608a58c6ec-2"&gt;&lt;/a&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="k"&gt;matplotlib&lt;/span&gt; inline
&lt;a id="rest_code_a60b412ba835495c84442a608a58c6ec-3" name="rest_code_a60b412ba835495c84442a608a58c6ec-3" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a60b412ba835495c84442a608a58c6ec-3"&gt;&lt;/a&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;numpy&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;np&lt;/span&gt;
&lt;a id="rest_code_a60b412ba835495c84442a608a58c6ec-4" name="rest_code_a60b412ba835495c84442a608a58c6ec-4" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a60b412ba835495c84442a608a58c6ec-4"&gt;&lt;/a&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;scipy&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;integrate&lt;/span&gt;
&lt;a id="rest_code_a60b412ba835495c84442a608a58c6ec-5" name="rest_code_a60b412ba835495c84442a608a58c6ec-5" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a60b412ba835495c84442a608a58c6ec-5"&gt;&lt;/a&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;matplotlib.pyplot&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;plt&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="code"&gt;&lt;pre class="code ipython3"&gt;&lt;a id="rest_code_50ccf7005e66491dbad8d1af960e52e0-1" name="rest_code_50ccf7005e66491dbad8d1af960e52e0-1" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_50ccf7005e66491dbad8d1af960e52e0-1"&gt;&lt;/a&gt;&lt;span class="c1"&gt;# Represent the basic dynamics&lt;/span&gt;
&lt;a id="rest_code_50ccf7005e66491dbad8d1af960e52e0-2" name="rest_code_50ccf7005e66491dbad8d1af960e52e0-2" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_50ccf7005e66491dbad8d1af960e52e0-2"&gt;&lt;/a&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;odefun&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;beta0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;betat&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;t0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;t1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;sigma&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;gamma&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_50ccf7005e66491dbad8d1af960e52e0-3" name="rest_code_50ccf7005e66491dbad8d1af960e52e0-3" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_50ccf7005e66491dbad8d1af960e52e0-3"&gt;&lt;/a&gt;    &lt;span class="n"&gt;dx&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;6&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_50ccf7005e66491dbad8d1af960e52e0-4" name="rest_code_50ccf7005e66491dbad8d1af960e52e0-4" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_50ccf7005e66491dbad8d1af960e52e0-4"&gt;&lt;/a&gt;    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;=&lt;/span&gt;&lt;span class="n"&gt;t0&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="ow"&gt;and&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;=&lt;/span&gt;&lt;span class="n"&gt;t1&lt;/span&gt;&lt;span class="p"&gt;)):&lt;/span&gt;
&lt;a id="rest_code_50ccf7005e66491dbad8d1af960e52e0-5" name="rest_code_50ccf7005e66491dbad8d1af960e52e0-5" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_50ccf7005e66491dbad8d1af960e52e0-5"&gt;&lt;/a&gt;        &lt;span class="n"&gt;beta&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;betat&lt;/span&gt;
&lt;a id="rest_code_50ccf7005e66491dbad8d1af960e52e0-6" name="rest_code_50ccf7005e66491dbad8d1af960e52e0-6" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_50ccf7005e66491dbad8d1af960e52e0-6"&gt;&lt;/a&gt;    &lt;span class="k"&gt;else&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a id="rest_code_50ccf7005e66491dbad8d1af960e52e0-7" name="rest_code_50ccf7005e66491dbad8d1af960e52e0-7" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_50ccf7005e66491dbad8d1af960e52e0-7"&gt;&lt;/a&gt;        &lt;span class="n"&gt;beta&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;beta0&lt;/span&gt;
&lt;a id="rest_code_50ccf7005e66491dbad8d1af960e52e0-8" name="rest_code_50ccf7005e66491dbad8d1af960e52e0-8" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_50ccf7005e66491dbad8d1af960e52e0-8"&gt;&lt;/a&gt;    &lt;span class="n"&gt;dx&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;beta&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_50ccf7005e66491dbad8d1af960e52e0-9" name="rest_code_50ccf7005e66491dbad8d1af960e52e0-9" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_50ccf7005e66491dbad8d1af960e52e0-9"&gt;&lt;/a&gt;    &lt;span class="n"&gt;dx&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;beta&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;sigma&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_50ccf7005e66491dbad8d1af960e52e0-10" name="rest_code_50ccf7005e66491dbad8d1af960e52e0-10" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_50ccf7005e66491dbad8d1af960e52e0-10"&gt;&lt;/a&gt;    &lt;span class="n"&gt;dx&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;sigma&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;sigma&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_50ccf7005e66491dbad8d1af960e52e0-11" name="rest_code_50ccf7005e66491dbad8d1af960e52e0-11" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_50ccf7005e66491dbad8d1af960e52e0-11"&gt;&lt;/a&gt;    &lt;span class="n"&gt;dx&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;sigma&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;gamma&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_50ccf7005e66491dbad8d1af960e52e0-12" name="rest_code_50ccf7005e66491dbad8d1af960e52e0-12" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_50ccf7005e66491dbad8d1af960e52e0-12"&gt;&lt;/a&gt;    &lt;span class="n"&gt;dx&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;gamma&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;gamma&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_50ccf7005e66491dbad8d1af960e52e0-13" name="rest_code_50ccf7005e66491dbad8d1af960e52e0-13" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_50ccf7005e66491dbad8d1af960e52e0-13"&gt;&lt;/a&gt;    &lt;span class="n"&gt;dx&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;gamma&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_50ccf7005e66491dbad8d1af960e52e0-14" name="rest_code_50ccf7005e66491dbad8d1af960e52e0-14" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_50ccf7005e66491dbad8d1af960e52e0-14"&gt;&lt;/a&gt;    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;dx&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="code"&gt;&lt;pre class="code ipython3"&gt;&lt;a id="rest_code_235f3c6356b64e44a3496d2d004cdec2-1" name="rest_code_235f3c6356b64e44a3496d2d004cdec2-1" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_235f3c6356b64e44a3496d2d004cdec2-1"&gt;&lt;/a&gt;&lt;span class="c1"&gt;# Parameters of the model&lt;/span&gt;
&lt;a id="rest_code_235f3c6356b64e44a3496d2d004cdec2-2" name="rest_code_235f3c6356b64e44a3496d2d004cdec2-2" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_235f3c6356b64e44a3496d2d004cdec2-2"&gt;&lt;/a&gt;&lt;span class="n"&gt;N&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;6.7e7&lt;/span&gt; &lt;span class="c1"&gt;# Total population&lt;/span&gt;
&lt;a id="rest_code_235f3c6356b64e44a3496d2d004cdec2-3" name="rest_code_235f3c6356b64e44a3496d2d004cdec2-3" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_235f3c6356b64e44a3496d2d004cdec2-3"&gt;&lt;/a&gt;&lt;span class="n"&gt;i0&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;1e-4&lt;/span&gt; &lt;span class="c1"&gt;# 0.5*Proportion of the population infected on day 0&lt;/span&gt;
&lt;a id="rest_code_235f3c6356b64e44a3496d2d004cdec2-4" name="rest_code_235f3c6356b64e44a3496d2d004cdec2-4" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_235f3c6356b64e44a3496d2d004cdec2-4"&gt;&lt;/a&gt;&lt;span class="n"&gt;tlast&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;365.0&lt;/span&gt; &lt;span class="c1"&gt;# Consider a year&lt;/span&gt;
&lt;a id="rest_code_235f3c6356b64e44a3496d2d004cdec2-5" name="rest_code_235f3c6356b64e44a3496d2d004cdec2-5" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_235f3c6356b64e44a3496d2d004cdec2-5"&gt;&lt;/a&gt;&lt;span class="n"&gt;latent_period&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;5.0&lt;/span&gt; &lt;span class="c1"&gt;# Days between being infected and becoming infectious&lt;/span&gt;
&lt;a id="rest_code_235f3c6356b64e44a3496d2d004cdec2-6" name="rest_code_235f3c6356b64e44a3496d2d004cdec2-6" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_235f3c6356b64e44a3496d2d004cdec2-6"&gt;&lt;/a&gt;&lt;span class="n"&gt;infectious_period&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;7.0&lt;/span&gt; &lt;span class="c1"&gt;# Days infectious&lt;/span&gt;
&lt;a id="rest_code_235f3c6356b64e44a3496d2d004cdec2-7" name="rest_code_235f3c6356b64e44a3496d2d004cdec2-7" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_235f3c6356b64e44a3496d2d004cdec2-7"&gt;&lt;/a&gt;&lt;span class="n"&gt;R0&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;2.5&lt;/span&gt; &lt;span class="c1"&gt;# Basic reproduction number in the absence of interventions&lt;/span&gt;
&lt;a id="rest_code_235f3c6356b64e44a3496d2d004cdec2-8" name="rest_code_235f3c6356b64e44a3496d2d004cdec2-8" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_235f3c6356b64e44a3496d2d004cdec2-8"&gt;&lt;/a&gt;&lt;span class="n"&gt;Rt&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;0.75&lt;/span&gt; &lt;span class="c1"&gt;# Reproduction number in the presence of interventions&lt;/span&gt;
&lt;a id="rest_code_235f3c6356b64e44a3496d2d004cdec2-9" name="rest_code_235f3c6356b64e44a3496d2d004cdec2-9" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_235f3c6356b64e44a3496d2d004cdec2-9"&gt;&lt;/a&gt;&lt;span class="n"&gt;tend&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;21.0&lt;/span&gt; &lt;span class="c1"&gt;# Number of days of interventions&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="code"&gt;&lt;pre class="code ipython3"&gt;&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-1" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-1" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-1"&gt;&lt;/a&gt;&lt;span class="n"&gt;beta0&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;R0&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="n"&gt;infectious_period&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-2" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-2" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-2"&gt;&lt;/a&gt;&lt;span class="n"&gt;betat&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Rt&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="n"&gt;infectious_period&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-3" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-3" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-3"&gt;&lt;/a&gt;&lt;span class="n"&gt;sigma&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;2.0&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="n"&gt;latent_period&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-4" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-4" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-4"&gt;&lt;/a&gt;&lt;span class="n"&gt;gamma&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;2.0&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="n"&gt;infectious_period&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-5" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-5" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-5"&gt;&lt;/a&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-6" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-6" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-6"&gt;&lt;/a&gt;&lt;span class="n"&gt;t0ran&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;array&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;100&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;40&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;52.5&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;65&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-7" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-7" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-7"&gt;&lt;/a&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-8" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-8" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-8"&gt;&lt;/a&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;mylab&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-9" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-9" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-9"&gt;&lt;/a&gt;    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-10" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-10" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-10"&gt;&lt;/a&gt;        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="s2"&gt;"Start at "&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="nb"&gt;str&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="s2"&gt;" days"&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-11" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-11" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-11"&gt;&lt;/a&gt;    &lt;span class="k"&gt;else&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-12" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-12" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-12"&gt;&lt;/a&gt;        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="s2"&gt;"Baseline"&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-13" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-13" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-13"&gt;&lt;/a&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-14" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-14" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-14"&gt;&lt;/a&gt;&lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;[]&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-15" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-15" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-15"&gt;&lt;/a&gt;&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;tt&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t0ran&lt;/span&gt;&lt;span class="p"&gt;)):&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-16" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-16" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-16"&gt;&lt;/a&gt;    &lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;append&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;integrate&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;solve_ivp&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;lambda&lt;/span&gt; &lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;odefun&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;beta0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;betat&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;t0ran&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;&lt;span class="n"&gt;t0ran&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="n"&gt;tend&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;sigma&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;gamma&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-17" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-17" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-17"&gt;&lt;/a&gt;                              &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;0.0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;tlast&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-18" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-18" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-18"&gt;&lt;/a&gt;                              &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;array&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="mf"&gt;1.0&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;2.0&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;i0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;0.0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;0.0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;i0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;i0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;0.0&lt;/span&gt;&lt;span class="p"&gt;]),&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-19" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-19" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-19"&gt;&lt;/a&gt;                              &lt;span class="s1"&gt;'RK45'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-20" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-20" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-20"&gt;&lt;/a&gt;                              &lt;span class="n"&gt;atol&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mf"&gt;1e-8&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-21" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-21" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-21"&gt;&lt;/a&gt;                              &lt;span class="n"&gt;rtol&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mf"&gt;1e-9&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="code"&gt;&lt;pre class="code ipython3"&gt;&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-1" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-1" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-1"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;figure&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;figsize&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-2" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-2" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-2"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;subplot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-3" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-3" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-3"&gt;&lt;/a&gt;&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;tt&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t0ran&lt;/span&gt;&lt;span class="p"&gt;)):&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-4" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-4" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-4"&gt;&lt;/a&gt;    &lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;plot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;T&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;label&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;mylab&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t0ran&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]))&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-5" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-5" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-5"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xlim&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="mi"&gt;30&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;70&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-6" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-6" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-6"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ylim&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mf"&gt;7e6&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-7" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-7" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-7"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'Time (days)'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-8" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-8" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-8"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ylabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'Number of infectious cases'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-9" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-9" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-9"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;legend&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-10" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-10" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-10"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;subplot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-11" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-11" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-11"&gt;&lt;/a&gt;&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;tt&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t0ran&lt;/span&gt;&lt;span class="p"&gt;)):&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-12" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-12" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-12"&gt;&lt;/a&gt;    &lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;plot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;T&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;label&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;mylab&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t0ran&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]))&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-13" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-13" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-13"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'Time (days)'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-14" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-14" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-14"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ylabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'Cumulative infections'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-15" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-15" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-15"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;legend&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-16" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-16" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-16"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xlim&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="mi"&gt;30&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;70&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-17" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-17" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-17"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ylim&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mf"&gt;1e7&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-18" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-18" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-18"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;tight_layout&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-19" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-19" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-19"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;show&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="code"&gt;&lt;pre class="code ipython3"&gt;&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-1" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-1" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-1"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;figure&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;figsize&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-2" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-2" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-2"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;subplot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-3" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-3" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-3"&gt;&lt;/a&gt;&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;tt&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t0ran&lt;/span&gt;&lt;span class="p"&gt;)):&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-4" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-4" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-4"&gt;&lt;/a&gt;    &lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;plot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;T&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;label&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;mylab&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t0ran&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]))&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-5" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-5" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-5"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xlim&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;tlast&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-6" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-6" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-6"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ylim&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mf"&gt;1.2e7&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-7" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-7" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-7"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'Time (days)'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-8" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-8" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-8"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ylabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'Number of infectious cases'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-9" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-9" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-9"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;legend&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-10" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-10" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-10"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;subplot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-11" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-11" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-11"&gt;&lt;/a&gt;&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;tt&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t0ran&lt;/span&gt;&lt;span class="p"&gt;)):&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-12" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-12" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-12"&gt;&lt;/a&gt;    &lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;plot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;T&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;label&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;mylab&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t0ran&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]))&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-13" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-13" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-13"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'Time (days)'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-14" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-14" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-14"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ylabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'Cumulative infections'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-15" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-15" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-15"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;legend&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-16" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-16" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-16"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xlim&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;tlast&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-17" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-17" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-17"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ylim&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mf"&gt;6.2e7&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-18" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-18" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-18"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;tight_layout&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-19" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-19" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-19"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;show&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;&lt;/body&gt;&lt;/html&gt;

&lt;img alt="../output_6_0.png" src="https://personalpages.manchester.ac.uk/staff/thomas.house/output_6_0.png"&gt;
&lt;p&gt;In fact, the later intervention dramatically reduces the burden on the healthcare
system, cutting in half the maximum numbers ill and potentially needing treatment
at any one time, and significantly reduces the final number infected, which the
earlier interventions fail to do.&lt;/p&gt;
&lt;p&gt;The reason that this happens is that social distancing measures do not lead to herd
immunity, so once they are lifted the epidemic starts again. In the absence of a
vaccine, it is therefore meaningless to speak about whether a policy 'aims' to get
herd immunity or not, since every country in the world will reach herd immunity
unless it is able to implement social distancing for an indefinite period of time.&lt;/p&gt;
&lt;p&gt;What mitigation policies should aim to do, therefore, is to reach herd immunity
with the minimal human cost. This will be extremely difficult, and at every
stage we will be dealing with large uncertainties. I would not want to be the
person who ultimately made the policy decisions. But to say that early
interventions are always better is incorrect.&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code ipython3"&gt;&lt;a id="rest_code_a60b412ba835495c84442a608a58c6ec-1" name="rest_code_a60b412ba835495c84442a608a58c6ec-1" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a60b412ba835495c84442a608a58c6ec-1"&gt;&lt;/a&gt;&lt;span class="c1"&gt;# Pull in libraries needed&lt;/span&gt;
&lt;a id="rest_code_a60b412ba835495c84442a608a58c6ec-2" name="rest_code_a60b412ba835495c84442a608a58c6ec-2" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a60b412ba835495c84442a608a58c6ec-2"&gt;&lt;/a&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="k"&gt;matplotlib&lt;/span&gt; inline
&lt;a id="rest_code_a60b412ba835495c84442a608a58c6ec-3" name="rest_code_a60b412ba835495c84442a608a58c6ec-3" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a60b412ba835495c84442a608a58c6ec-3"&gt;&lt;/a&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;numpy&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;np&lt;/span&gt;
&lt;a id="rest_code_a60b412ba835495c84442a608a58c6ec-4" name="rest_code_a60b412ba835495c84442a608a58c6ec-4" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a60b412ba835495c84442a608a58c6ec-4"&gt;&lt;/a&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;scipy&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;integrate&lt;/span&gt;
&lt;a id="rest_code_a60b412ba835495c84442a608a58c6ec-5" name="rest_code_a60b412ba835495c84442a608a58c6ec-5" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a60b412ba835495c84442a608a58c6ec-5"&gt;&lt;/a&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;matplotlib.pyplot&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;plt&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="code"&gt;&lt;pre class="code ipython3"&gt;&lt;a id="rest_code_50ccf7005e66491dbad8d1af960e52e0-1" name="rest_code_50ccf7005e66491dbad8d1af960e52e0-1" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_50ccf7005e66491dbad8d1af960e52e0-1"&gt;&lt;/a&gt;&lt;span class="c1"&gt;# Represent the basic dynamics&lt;/span&gt;
&lt;a id="rest_code_50ccf7005e66491dbad8d1af960e52e0-2" name="rest_code_50ccf7005e66491dbad8d1af960e52e0-2" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_50ccf7005e66491dbad8d1af960e52e0-2"&gt;&lt;/a&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;odefun&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;beta0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;betat&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;t0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;t1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;sigma&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;gamma&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_50ccf7005e66491dbad8d1af960e52e0-3" name="rest_code_50ccf7005e66491dbad8d1af960e52e0-3" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_50ccf7005e66491dbad8d1af960e52e0-3"&gt;&lt;/a&gt;    &lt;span class="n"&gt;dx&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;6&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_50ccf7005e66491dbad8d1af960e52e0-4" name="rest_code_50ccf7005e66491dbad8d1af960e52e0-4" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_50ccf7005e66491dbad8d1af960e52e0-4"&gt;&lt;/a&gt;    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;=&lt;/span&gt;&lt;span class="n"&gt;t0&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="ow"&gt;and&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;=&lt;/span&gt;&lt;span class="n"&gt;t1&lt;/span&gt;&lt;span class="p"&gt;)):&lt;/span&gt;
&lt;a id="rest_code_50ccf7005e66491dbad8d1af960e52e0-5" name="rest_code_50ccf7005e66491dbad8d1af960e52e0-5" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_50ccf7005e66491dbad8d1af960e52e0-5"&gt;&lt;/a&gt;        &lt;span class="n"&gt;beta&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;betat&lt;/span&gt;
&lt;a id="rest_code_50ccf7005e66491dbad8d1af960e52e0-6" name="rest_code_50ccf7005e66491dbad8d1af960e52e0-6" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_50ccf7005e66491dbad8d1af960e52e0-6"&gt;&lt;/a&gt;    &lt;span class="k"&gt;else&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a id="rest_code_50ccf7005e66491dbad8d1af960e52e0-7" name="rest_code_50ccf7005e66491dbad8d1af960e52e0-7" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_50ccf7005e66491dbad8d1af960e52e0-7"&gt;&lt;/a&gt;        &lt;span class="n"&gt;beta&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;beta0&lt;/span&gt;
&lt;a id="rest_code_50ccf7005e66491dbad8d1af960e52e0-8" name="rest_code_50ccf7005e66491dbad8d1af960e52e0-8" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_50ccf7005e66491dbad8d1af960e52e0-8"&gt;&lt;/a&gt;    &lt;span class="n"&gt;dx&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;beta&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_50ccf7005e66491dbad8d1af960e52e0-9" name="rest_code_50ccf7005e66491dbad8d1af960e52e0-9" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_50ccf7005e66491dbad8d1af960e52e0-9"&gt;&lt;/a&gt;    &lt;span class="n"&gt;dx&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;beta&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;sigma&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_50ccf7005e66491dbad8d1af960e52e0-10" name="rest_code_50ccf7005e66491dbad8d1af960e52e0-10" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_50ccf7005e66491dbad8d1af960e52e0-10"&gt;&lt;/a&gt;    &lt;span class="n"&gt;dx&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;sigma&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;sigma&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_50ccf7005e66491dbad8d1af960e52e0-11" name="rest_code_50ccf7005e66491dbad8d1af960e52e0-11" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_50ccf7005e66491dbad8d1af960e52e0-11"&gt;&lt;/a&gt;    &lt;span class="n"&gt;dx&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;sigma&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;gamma&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_50ccf7005e66491dbad8d1af960e52e0-12" name="rest_code_50ccf7005e66491dbad8d1af960e52e0-12" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_50ccf7005e66491dbad8d1af960e52e0-12"&gt;&lt;/a&gt;    &lt;span class="n"&gt;dx&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;gamma&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;gamma&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_50ccf7005e66491dbad8d1af960e52e0-13" name="rest_code_50ccf7005e66491dbad8d1af960e52e0-13" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_50ccf7005e66491dbad8d1af960e52e0-13"&gt;&lt;/a&gt;    &lt;span class="n"&gt;dx&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;gamma&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_50ccf7005e66491dbad8d1af960e52e0-14" name="rest_code_50ccf7005e66491dbad8d1af960e52e0-14" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_50ccf7005e66491dbad8d1af960e52e0-14"&gt;&lt;/a&gt;    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;dx&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="code"&gt;&lt;pre class="code ipython3"&gt;&lt;a id="rest_code_235f3c6356b64e44a3496d2d004cdec2-1" name="rest_code_235f3c6356b64e44a3496d2d004cdec2-1" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_235f3c6356b64e44a3496d2d004cdec2-1"&gt;&lt;/a&gt;&lt;span class="c1"&gt;# Parameters of the model&lt;/span&gt;
&lt;a id="rest_code_235f3c6356b64e44a3496d2d004cdec2-2" name="rest_code_235f3c6356b64e44a3496d2d004cdec2-2" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_235f3c6356b64e44a3496d2d004cdec2-2"&gt;&lt;/a&gt;&lt;span class="n"&gt;N&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;6.7e7&lt;/span&gt; &lt;span class="c1"&gt;# Total population&lt;/span&gt;
&lt;a id="rest_code_235f3c6356b64e44a3496d2d004cdec2-3" name="rest_code_235f3c6356b64e44a3496d2d004cdec2-3" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_235f3c6356b64e44a3496d2d004cdec2-3"&gt;&lt;/a&gt;&lt;span class="n"&gt;i0&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;1e-4&lt;/span&gt; &lt;span class="c1"&gt;# 0.5*Proportion of the population infected on day 0&lt;/span&gt;
&lt;a id="rest_code_235f3c6356b64e44a3496d2d004cdec2-4" name="rest_code_235f3c6356b64e44a3496d2d004cdec2-4" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_235f3c6356b64e44a3496d2d004cdec2-4"&gt;&lt;/a&gt;&lt;span class="n"&gt;tlast&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;365.0&lt;/span&gt; &lt;span class="c1"&gt;# Consider a year&lt;/span&gt;
&lt;a id="rest_code_235f3c6356b64e44a3496d2d004cdec2-5" name="rest_code_235f3c6356b64e44a3496d2d004cdec2-5" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_235f3c6356b64e44a3496d2d004cdec2-5"&gt;&lt;/a&gt;&lt;span class="n"&gt;latent_period&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;5.0&lt;/span&gt; &lt;span class="c1"&gt;# Days between being infected and becoming infectious&lt;/span&gt;
&lt;a id="rest_code_235f3c6356b64e44a3496d2d004cdec2-6" name="rest_code_235f3c6356b64e44a3496d2d004cdec2-6" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_235f3c6356b64e44a3496d2d004cdec2-6"&gt;&lt;/a&gt;&lt;span class="n"&gt;infectious_period&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;7.0&lt;/span&gt; &lt;span class="c1"&gt;# Days infectious&lt;/span&gt;
&lt;a id="rest_code_235f3c6356b64e44a3496d2d004cdec2-7" name="rest_code_235f3c6356b64e44a3496d2d004cdec2-7" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_235f3c6356b64e44a3496d2d004cdec2-7"&gt;&lt;/a&gt;&lt;span class="n"&gt;R0&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;2.5&lt;/span&gt; &lt;span class="c1"&gt;# Basic reproduction number in the absence of interventions&lt;/span&gt;
&lt;a id="rest_code_235f3c6356b64e44a3496d2d004cdec2-8" name="rest_code_235f3c6356b64e44a3496d2d004cdec2-8" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_235f3c6356b64e44a3496d2d004cdec2-8"&gt;&lt;/a&gt;&lt;span class="n"&gt;Rt&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;0.75&lt;/span&gt; &lt;span class="c1"&gt;# Reproduction number in the presence of interventions&lt;/span&gt;
&lt;a id="rest_code_235f3c6356b64e44a3496d2d004cdec2-9" name="rest_code_235f3c6356b64e44a3496d2d004cdec2-9" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_235f3c6356b64e44a3496d2d004cdec2-9"&gt;&lt;/a&gt;&lt;span class="n"&gt;tend&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;21.0&lt;/span&gt; &lt;span class="c1"&gt;# Number of days of interventions&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="code"&gt;&lt;pre class="code ipython3"&gt;&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-1" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-1" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-1"&gt;&lt;/a&gt;&lt;span class="n"&gt;beta0&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;R0&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="n"&gt;infectious_period&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-2" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-2" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-2"&gt;&lt;/a&gt;&lt;span class="n"&gt;betat&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Rt&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="n"&gt;infectious_period&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-3" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-3" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-3"&gt;&lt;/a&gt;&lt;span class="n"&gt;sigma&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;2.0&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="n"&gt;latent_period&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-4" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-4" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-4"&gt;&lt;/a&gt;&lt;span class="n"&gt;gamma&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;2.0&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="n"&gt;infectious_period&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-5" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-5" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-5"&gt;&lt;/a&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-6" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-6" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-6"&gt;&lt;/a&gt;&lt;span class="n"&gt;t0ran&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;array&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;100&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;40&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;52.5&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;65&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-7" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-7" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-7"&gt;&lt;/a&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-8" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-8" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-8"&gt;&lt;/a&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;mylab&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-9" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-9" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-9"&gt;&lt;/a&gt;    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-10" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-10" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-10"&gt;&lt;/a&gt;        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="s2"&gt;"Start at "&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="nb"&gt;str&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="s2"&gt;" days"&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-11" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-11" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-11"&gt;&lt;/a&gt;    &lt;span class="k"&gt;else&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-12" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-12" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-12"&gt;&lt;/a&gt;        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="s2"&gt;"Baseline"&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-13" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-13" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-13"&gt;&lt;/a&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-14" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-14" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-14"&gt;&lt;/a&gt;&lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;[]&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-15" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-15" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-15"&gt;&lt;/a&gt;&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;tt&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t0ran&lt;/span&gt;&lt;span class="p"&gt;)):&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-16" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-16" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-16"&gt;&lt;/a&gt;    &lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;append&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;integrate&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;solve_ivp&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;lambda&lt;/span&gt; &lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;odefun&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;beta0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;betat&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;t0ran&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;&lt;span class="n"&gt;t0ran&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="n"&gt;tend&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;sigma&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;gamma&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-17" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-17" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-17"&gt;&lt;/a&gt;                              &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;0.0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;tlast&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-18" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-18" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-18"&gt;&lt;/a&gt;                              &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;array&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="mf"&gt;1.0&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;2.0&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;i0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;0.0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;0.0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;i0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;i0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;0.0&lt;/span&gt;&lt;span class="p"&gt;]),&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-19" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-19" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-19"&gt;&lt;/a&gt;                              &lt;span class="s1"&gt;'RK45'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-20" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-20" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-20"&gt;&lt;/a&gt;                              &lt;span class="n"&gt;atol&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mf"&gt;1e-8&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-21" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-21" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-21"&gt;&lt;/a&gt;                              &lt;span class="n"&gt;rtol&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mf"&gt;1e-9&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="code"&gt;&lt;pre class="code ipython3"&gt;&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-1" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-1" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-1"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;figure&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;figsize&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-2" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-2" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-2"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;subplot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-3" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-3" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-3"&gt;&lt;/a&gt;&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;tt&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t0ran&lt;/span&gt;&lt;span class="p"&gt;)):&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-4" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-4" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-4"&gt;&lt;/a&gt;    &lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;plot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;T&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;label&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;mylab&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t0ran&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]))&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-5" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-5" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-5"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xlim&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="mi"&gt;30&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;70&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-6" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-6" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-6"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ylim&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mf"&gt;7e6&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-7" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-7" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-7"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'Time (days)'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-8" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-8" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-8"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ylabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'Number of infectious cases'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-9" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-9" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-9"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;legend&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-10" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-10" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-10"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;subplot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-11" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-11" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-11"&gt;&lt;/a&gt;&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;tt&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t0ran&lt;/span&gt;&lt;span class="p"&gt;)):&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-12" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-12" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-12"&gt;&lt;/a&gt;    &lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;plot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;T&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;label&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;mylab&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t0ran&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]))&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-13" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-13" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-13"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'Time (days)'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-14" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-14" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-14"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ylabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'Cumulative infections'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-15" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-15" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-15"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;legend&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-16" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-16" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-16"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xlim&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="mi"&gt;30&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;70&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-17" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-17" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-17"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ylim&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mf"&gt;1e7&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-18" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-18" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-18"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;tight_layout&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-19" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-19" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-19"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;show&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="code"&gt;&lt;pre class="code ipython3"&gt;&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-1" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-1" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-1"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;figure&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;figsize&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-2" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-2" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-2"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;subplot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-3" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-3" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-3"&gt;&lt;/a&gt;&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;tt&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t0ran&lt;/span&gt;&lt;span class="p"&gt;)):&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-4" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-4" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-4"&gt;&lt;/a&gt;    &lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;plot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;T&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;label&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;mylab&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t0ran&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]))&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-5" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-5" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-5"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xlim&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;tlast&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-6" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-6" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-6"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ylim&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mf"&gt;1.2e7&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-7" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-7" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-7"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'Time (days)'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-8" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-8" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-8"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ylabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'Number of infectious cases'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-9" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-9" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-9"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;legend&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-10" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-10" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-10"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;subplot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-11" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-11" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-11"&gt;&lt;/a&gt;&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;tt&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t0ran&lt;/span&gt;&lt;span class="p"&gt;)):&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-12" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-12" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-12"&gt;&lt;/a&gt;    &lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;plot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;T&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;label&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;mylab&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t0ran&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]))&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-13" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-13" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-13"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'Time (days)'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-14" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-14" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-14"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ylabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'Cumulative infections'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-15" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-15" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-15"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;legend&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-16" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-16" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-16"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xlim&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;tlast&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-17" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-17" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-17"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ylim&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mf"&gt;6.2e7&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-18" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-18" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-18"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;tight_layout&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-19" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-19" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-19"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;show&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;&lt;/body&gt;&lt;/html&gt;

&lt;p&gt;The reason that this happens is that social distancing measures do not lead to herd
immunity, so once they are lifted the epidemic starts again. In the absence of a
vaccine, it is therefore meaningless to speak about whether a policy 'aims' to get
herd immunity or not, since every country in the world will reach herd immunity
unless it is able to implement social distancing for an indefinite period of time.&lt;/p&gt;
&lt;p&gt;What mitigation policies should aim to do, therefore, is to reach herd immunity
with the minimal human cost. This will be extremely difficult, and at every
stage we will be dealing with large uncertainties. I would not want to be the
person who ultimately made the policy decisions. But to say that early
interventions are always better is incorrect.&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code ipython3"&gt;&lt;a id="rest_code_a60b412ba835495c84442a608a58c6ec-1" name="rest_code_a60b412ba835495c84442a608a58c6ec-1" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a60b412ba835495c84442a608a58c6ec-1"&gt;&lt;/a&gt;&lt;span class="c1"&gt;# Pull in libraries needed&lt;/span&gt;
&lt;a id="rest_code_a60b412ba835495c84442a608a58c6ec-2" name="rest_code_a60b412ba835495c84442a608a58c6ec-2" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a60b412ba835495c84442a608a58c6ec-2"&gt;&lt;/a&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="k"&gt;matplotlib&lt;/span&gt; inline
&lt;a id="rest_code_a60b412ba835495c84442a608a58c6ec-3" name="rest_code_a60b412ba835495c84442a608a58c6ec-3" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a60b412ba835495c84442a608a58c6ec-3"&gt;&lt;/a&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;numpy&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;np&lt;/span&gt;
&lt;a id="rest_code_a60b412ba835495c84442a608a58c6ec-4" name="rest_code_a60b412ba835495c84442a608a58c6ec-4" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a60b412ba835495c84442a608a58c6ec-4"&gt;&lt;/a&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;scipy&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;integrate&lt;/span&gt;
&lt;a id="rest_code_a60b412ba835495c84442a608a58c6ec-5" name="rest_code_a60b412ba835495c84442a608a58c6ec-5" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a60b412ba835495c84442a608a58c6ec-5"&gt;&lt;/a&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;matplotlib.pyplot&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;plt&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="code"&gt;&lt;pre class="code ipython3"&gt;&lt;a id="rest_code_50ccf7005e66491dbad8d1af960e52e0-1" name="rest_code_50ccf7005e66491dbad8d1af960e52e0-1" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_50ccf7005e66491dbad8d1af960e52e0-1"&gt;&lt;/a&gt;&lt;span class="c1"&gt;# Represent the basic dynamics&lt;/span&gt;
&lt;a id="rest_code_50ccf7005e66491dbad8d1af960e52e0-2" name="rest_code_50ccf7005e66491dbad8d1af960e52e0-2" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_50ccf7005e66491dbad8d1af960e52e0-2"&gt;&lt;/a&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;odefun&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;beta0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;betat&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;t0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;t1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;sigma&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;gamma&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_50ccf7005e66491dbad8d1af960e52e0-3" name="rest_code_50ccf7005e66491dbad8d1af960e52e0-3" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_50ccf7005e66491dbad8d1af960e52e0-3"&gt;&lt;/a&gt;    &lt;span class="n"&gt;dx&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;6&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_50ccf7005e66491dbad8d1af960e52e0-4" name="rest_code_50ccf7005e66491dbad8d1af960e52e0-4" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_50ccf7005e66491dbad8d1af960e52e0-4"&gt;&lt;/a&gt;    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;=&lt;/span&gt;&lt;span class="n"&gt;t0&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="ow"&gt;and&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;=&lt;/span&gt;&lt;span class="n"&gt;t1&lt;/span&gt;&lt;span class="p"&gt;)):&lt;/span&gt;
&lt;a id="rest_code_50ccf7005e66491dbad8d1af960e52e0-5" name="rest_code_50ccf7005e66491dbad8d1af960e52e0-5" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_50ccf7005e66491dbad8d1af960e52e0-5"&gt;&lt;/a&gt;        &lt;span class="n"&gt;beta&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;betat&lt;/span&gt;
&lt;a id="rest_code_50ccf7005e66491dbad8d1af960e52e0-6" name="rest_code_50ccf7005e66491dbad8d1af960e52e0-6" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_50ccf7005e66491dbad8d1af960e52e0-6"&gt;&lt;/a&gt;    &lt;span class="k"&gt;else&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a id="rest_code_50ccf7005e66491dbad8d1af960e52e0-7" name="rest_code_50ccf7005e66491dbad8d1af960e52e0-7" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_50ccf7005e66491dbad8d1af960e52e0-7"&gt;&lt;/a&gt;        &lt;span class="n"&gt;beta&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;beta0&lt;/span&gt;
&lt;a id="rest_code_50ccf7005e66491dbad8d1af960e52e0-8" name="rest_code_50ccf7005e66491dbad8d1af960e52e0-8" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_50ccf7005e66491dbad8d1af960e52e0-8"&gt;&lt;/a&gt;    &lt;span class="n"&gt;dx&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;beta&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_50ccf7005e66491dbad8d1af960e52e0-9" name="rest_code_50ccf7005e66491dbad8d1af960e52e0-9" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_50ccf7005e66491dbad8d1af960e52e0-9"&gt;&lt;/a&gt;    &lt;span class="n"&gt;dx&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;beta&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;sigma&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_50ccf7005e66491dbad8d1af960e52e0-10" name="rest_code_50ccf7005e66491dbad8d1af960e52e0-10" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_50ccf7005e66491dbad8d1af960e52e0-10"&gt;&lt;/a&gt;    &lt;span class="n"&gt;dx&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;sigma&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;sigma&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_50ccf7005e66491dbad8d1af960e52e0-11" name="rest_code_50ccf7005e66491dbad8d1af960e52e0-11" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_50ccf7005e66491dbad8d1af960e52e0-11"&gt;&lt;/a&gt;    &lt;span class="n"&gt;dx&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;sigma&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;gamma&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_50ccf7005e66491dbad8d1af960e52e0-12" name="rest_code_50ccf7005e66491dbad8d1af960e52e0-12" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_50ccf7005e66491dbad8d1af960e52e0-12"&gt;&lt;/a&gt;    &lt;span class="n"&gt;dx&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;gamma&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;gamma&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_50ccf7005e66491dbad8d1af960e52e0-13" name="rest_code_50ccf7005e66491dbad8d1af960e52e0-13" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_50ccf7005e66491dbad8d1af960e52e0-13"&gt;&lt;/a&gt;    &lt;span class="n"&gt;dx&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;gamma&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_50ccf7005e66491dbad8d1af960e52e0-14" name="rest_code_50ccf7005e66491dbad8d1af960e52e0-14" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_50ccf7005e66491dbad8d1af960e52e0-14"&gt;&lt;/a&gt;    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;dx&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="code"&gt;&lt;pre class="code ipython3"&gt;&lt;a id="rest_code_235f3c6356b64e44a3496d2d004cdec2-1" name="rest_code_235f3c6356b64e44a3496d2d004cdec2-1" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_235f3c6356b64e44a3496d2d004cdec2-1"&gt;&lt;/a&gt;&lt;span class="c1"&gt;# Parameters of the model&lt;/span&gt;
&lt;a id="rest_code_235f3c6356b64e44a3496d2d004cdec2-2" name="rest_code_235f3c6356b64e44a3496d2d004cdec2-2" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_235f3c6356b64e44a3496d2d004cdec2-2"&gt;&lt;/a&gt;&lt;span class="n"&gt;N&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;6.7e7&lt;/span&gt; &lt;span class="c1"&gt;# Total population&lt;/span&gt;
&lt;a id="rest_code_235f3c6356b64e44a3496d2d004cdec2-3" name="rest_code_235f3c6356b64e44a3496d2d004cdec2-3" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_235f3c6356b64e44a3496d2d004cdec2-3"&gt;&lt;/a&gt;&lt;span class="n"&gt;i0&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;1e-4&lt;/span&gt; &lt;span class="c1"&gt;# 0.5*Proportion of the population infected on day 0&lt;/span&gt;
&lt;a id="rest_code_235f3c6356b64e44a3496d2d004cdec2-4" name="rest_code_235f3c6356b64e44a3496d2d004cdec2-4" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_235f3c6356b64e44a3496d2d004cdec2-4"&gt;&lt;/a&gt;&lt;span class="n"&gt;tlast&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;365.0&lt;/span&gt; &lt;span class="c1"&gt;# Consider a year&lt;/span&gt;
&lt;a id="rest_code_235f3c6356b64e44a3496d2d004cdec2-5" name="rest_code_235f3c6356b64e44a3496d2d004cdec2-5" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_235f3c6356b64e44a3496d2d004cdec2-5"&gt;&lt;/a&gt;&lt;span class="n"&gt;latent_period&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;5.0&lt;/span&gt; &lt;span class="c1"&gt;# Days between being infected and becoming infectious&lt;/span&gt;
&lt;a id="rest_code_235f3c6356b64e44a3496d2d004cdec2-6" name="rest_code_235f3c6356b64e44a3496d2d004cdec2-6" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_235f3c6356b64e44a3496d2d004cdec2-6"&gt;&lt;/a&gt;&lt;span class="n"&gt;infectious_period&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;7.0&lt;/span&gt; &lt;span class="c1"&gt;# Days infectious&lt;/span&gt;
&lt;a id="rest_code_235f3c6356b64e44a3496d2d004cdec2-7" name="rest_code_235f3c6356b64e44a3496d2d004cdec2-7" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_235f3c6356b64e44a3496d2d004cdec2-7"&gt;&lt;/a&gt;&lt;span class="n"&gt;R0&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;2.5&lt;/span&gt; &lt;span class="c1"&gt;# Basic reproduction number in the absence of interventions&lt;/span&gt;
&lt;a id="rest_code_235f3c6356b64e44a3496d2d004cdec2-8" name="rest_code_235f3c6356b64e44a3496d2d004cdec2-8" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_235f3c6356b64e44a3496d2d004cdec2-8"&gt;&lt;/a&gt;&lt;span class="n"&gt;Rt&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;0.75&lt;/span&gt; &lt;span class="c1"&gt;# Reproduction number in the presence of interventions&lt;/span&gt;
&lt;a id="rest_code_235f3c6356b64e44a3496d2d004cdec2-9" name="rest_code_235f3c6356b64e44a3496d2d004cdec2-9" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_235f3c6356b64e44a3496d2d004cdec2-9"&gt;&lt;/a&gt;&lt;span class="n"&gt;tend&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;21.0&lt;/span&gt; &lt;span class="c1"&gt;# Number of days of interventions&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="code"&gt;&lt;pre class="code ipython3"&gt;&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-1" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-1" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-1"&gt;&lt;/a&gt;&lt;span class="n"&gt;beta0&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;R0&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="n"&gt;infectious_period&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-2" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-2" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-2"&gt;&lt;/a&gt;&lt;span class="n"&gt;betat&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Rt&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="n"&gt;infectious_period&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-3" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-3" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-3"&gt;&lt;/a&gt;&lt;span class="n"&gt;sigma&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;2.0&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="n"&gt;latent_period&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-4" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-4" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-4"&gt;&lt;/a&gt;&lt;span class="n"&gt;gamma&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;2.0&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="n"&gt;infectious_period&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-5" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-5" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-5"&gt;&lt;/a&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-6" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-6" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-6"&gt;&lt;/a&gt;&lt;span class="n"&gt;t0ran&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;array&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;100&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;40&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;52.5&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;65&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-7" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-7" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-7"&gt;&lt;/a&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-8" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-8" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-8"&gt;&lt;/a&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;mylab&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-9" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-9" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-9"&gt;&lt;/a&gt;    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-10" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-10" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-10"&gt;&lt;/a&gt;        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="s2"&gt;"Start at "&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="nb"&gt;str&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="s2"&gt;" days"&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-11" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-11" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-11"&gt;&lt;/a&gt;    &lt;span class="k"&gt;else&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-12" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-12" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-12"&gt;&lt;/a&gt;        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="s2"&gt;"Baseline"&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-13" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-13" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-13"&gt;&lt;/a&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-14" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-14" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-14"&gt;&lt;/a&gt;&lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;[]&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-15" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-15" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-15"&gt;&lt;/a&gt;&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;tt&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t0ran&lt;/span&gt;&lt;span class="p"&gt;)):&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-16" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-16" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-16"&gt;&lt;/a&gt;    &lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;append&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;integrate&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;solve_ivp&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;lambda&lt;/span&gt; &lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;odefun&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;beta0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;betat&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;t0ran&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;&lt;span class="n"&gt;t0ran&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="n"&gt;tend&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;sigma&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;gamma&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-17" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-17" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-17"&gt;&lt;/a&gt;                              &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;0.0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;tlast&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-18" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-18" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-18"&gt;&lt;/a&gt;                              &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;array&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="mf"&gt;1.0&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;2.0&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;i0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;0.0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;0.0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;i0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;i0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;0.0&lt;/span&gt;&lt;span class="p"&gt;]),&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-19" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-19" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-19"&gt;&lt;/a&gt;                              &lt;span class="s1"&gt;'RK45'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-20" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-20" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-20"&gt;&lt;/a&gt;                              &lt;span class="n"&gt;atol&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mf"&gt;1e-8&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-21" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-21" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-21"&gt;&lt;/a&gt;                              &lt;span class="n"&gt;rtol&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mf"&gt;1e-9&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="code"&gt;&lt;pre class="code ipython3"&gt;&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-1" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-1" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-1"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;figure&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;figsize&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-2" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-2" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-2"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;subplot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-3" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-3" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-3"&gt;&lt;/a&gt;&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;tt&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t0ran&lt;/span&gt;&lt;span class="p"&gt;)):&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-4" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-4" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-4"&gt;&lt;/a&gt;    &lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;plot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;T&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;label&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;mylab&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t0ran&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]))&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-5" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-5" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-5"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xlim&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="mi"&gt;30&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;70&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-6" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-6" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-6"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ylim&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mf"&gt;7e6&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-7" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-7" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-7"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'Time (days)'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-8" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-8" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-8"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ylabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'Number of infectious cases'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-9" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-9" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-9"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;legend&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-10" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-10" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-10"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;subplot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-11" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-11" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-11"&gt;&lt;/a&gt;&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;tt&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t0ran&lt;/span&gt;&lt;span class="p"&gt;)):&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-12" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-12" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-12"&gt;&lt;/a&gt;    &lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;plot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;T&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;label&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;mylab&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t0ran&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]))&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-13" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-13" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-13"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'Time (days)'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-14" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-14" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-14"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ylabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'Cumulative infections'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-15" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-15" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-15"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;legend&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-16" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-16" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-16"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xlim&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="mi"&gt;30&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;70&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-17" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-17" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-17"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ylim&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mf"&gt;1e7&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-18" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-18" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-18"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;tight_layout&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-19" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-19" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-19"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;show&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="code"&gt;&lt;pre class="code ipython3"&gt;&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-1" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-1" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-1"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;figure&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;figsize&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-2" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-2" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-2"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;subplot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-3" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-3" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-3"&gt;&lt;/a&gt;&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;tt&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t0ran&lt;/span&gt;&lt;span class="p"&gt;)):&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-4" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-4" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-4"&gt;&lt;/a&gt;    &lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;plot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;T&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;label&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;mylab&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t0ran&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]))&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-5" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-5" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-5"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xlim&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;tlast&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-6" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-6" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-6"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ylim&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mf"&gt;1.2e7&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-7" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-7" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-7"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'Time (days)'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-8" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-8" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-8"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ylabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'Number of infectious cases'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-9" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-9" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-9"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;legend&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-10" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-10" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-10"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;subplot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-11" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-11" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-11"&gt;&lt;/a&gt;&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;tt&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t0ran&lt;/span&gt;&lt;span class="p"&gt;)):&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-12" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-12" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-12"&gt;&lt;/a&gt;    &lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;plot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;T&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;label&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;mylab&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t0ran&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]))&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-13" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-13" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-13"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'Time (days)'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-14" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-14" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-14"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ylabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'Cumulative infections'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-15" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-15" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-15"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;legend&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-16" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-16" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-16"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xlim&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;tlast&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-17" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-17" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-17"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ylim&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mf"&gt;6.2e7&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-18" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-18" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-18"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;tight_layout&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-19" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-19" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-19"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;show&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;&lt;/body&gt;&lt;/html&gt;

&lt;p&gt;What mitigation policies should aim to do, therefore, is to reach herd immunity
with the minimal human cost. This will be extremely difficult, and at every
stage we will be dealing with large uncertainties. I would not want to be the
person who ultimately made the policy decisions. But to say that early
interventions are always better is incorrect.&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code ipython3"&gt;&lt;a id="rest_code_a60b412ba835495c84442a608a58c6ec-1" name="rest_code_a60b412ba835495c84442a608a58c6ec-1" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a60b412ba835495c84442a608a58c6ec-1"&gt;&lt;/a&gt;&lt;span class="c1"&gt;# Pull in libraries needed&lt;/span&gt;
&lt;a id="rest_code_a60b412ba835495c84442a608a58c6ec-2" name="rest_code_a60b412ba835495c84442a608a58c6ec-2" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a60b412ba835495c84442a608a58c6ec-2"&gt;&lt;/a&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="k"&gt;matplotlib&lt;/span&gt; inline
&lt;a id="rest_code_a60b412ba835495c84442a608a58c6ec-3" name="rest_code_a60b412ba835495c84442a608a58c6ec-3" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a60b412ba835495c84442a608a58c6ec-3"&gt;&lt;/a&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;numpy&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;np&lt;/span&gt;
&lt;a id="rest_code_a60b412ba835495c84442a608a58c6ec-4" name="rest_code_a60b412ba835495c84442a608a58c6ec-4" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a60b412ba835495c84442a608a58c6ec-4"&gt;&lt;/a&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;scipy&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;integrate&lt;/span&gt;
&lt;a id="rest_code_a60b412ba835495c84442a608a58c6ec-5" name="rest_code_a60b412ba835495c84442a608a58c6ec-5" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a60b412ba835495c84442a608a58c6ec-5"&gt;&lt;/a&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;matplotlib.pyplot&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;plt&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="code"&gt;&lt;pre class="code ipython3"&gt;&lt;a id="rest_code_50ccf7005e66491dbad8d1af960e52e0-1" name="rest_code_50ccf7005e66491dbad8d1af960e52e0-1" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_50ccf7005e66491dbad8d1af960e52e0-1"&gt;&lt;/a&gt;&lt;span class="c1"&gt;# Represent the basic dynamics&lt;/span&gt;
&lt;a id="rest_code_50ccf7005e66491dbad8d1af960e52e0-2" name="rest_code_50ccf7005e66491dbad8d1af960e52e0-2" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_50ccf7005e66491dbad8d1af960e52e0-2"&gt;&lt;/a&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;odefun&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;beta0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;betat&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;t0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;t1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;sigma&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;gamma&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_50ccf7005e66491dbad8d1af960e52e0-3" name="rest_code_50ccf7005e66491dbad8d1af960e52e0-3" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_50ccf7005e66491dbad8d1af960e52e0-3"&gt;&lt;/a&gt;    &lt;span class="n"&gt;dx&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;6&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_50ccf7005e66491dbad8d1af960e52e0-4" name="rest_code_50ccf7005e66491dbad8d1af960e52e0-4" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_50ccf7005e66491dbad8d1af960e52e0-4"&gt;&lt;/a&gt;    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;=&lt;/span&gt;&lt;span class="n"&gt;t0&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="ow"&gt;and&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;=&lt;/span&gt;&lt;span class="n"&gt;t1&lt;/span&gt;&lt;span class="p"&gt;)):&lt;/span&gt;
&lt;a id="rest_code_50ccf7005e66491dbad8d1af960e52e0-5" name="rest_code_50ccf7005e66491dbad8d1af960e52e0-5" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_50ccf7005e66491dbad8d1af960e52e0-5"&gt;&lt;/a&gt;        &lt;span class="n"&gt;beta&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;betat&lt;/span&gt;
&lt;a id="rest_code_50ccf7005e66491dbad8d1af960e52e0-6" name="rest_code_50ccf7005e66491dbad8d1af960e52e0-6" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_50ccf7005e66491dbad8d1af960e52e0-6"&gt;&lt;/a&gt;    &lt;span class="k"&gt;else&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a id="rest_code_50ccf7005e66491dbad8d1af960e52e0-7" name="rest_code_50ccf7005e66491dbad8d1af960e52e0-7" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_50ccf7005e66491dbad8d1af960e52e0-7"&gt;&lt;/a&gt;        &lt;span class="n"&gt;beta&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;beta0&lt;/span&gt;
&lt;a id="rest_code_50ccf7005e66491dbad8d1af960e52e0-8" name="rest_code_50ccf7005e66491dbad8d1af960e52e0-8" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_50ccf7005e66491dbad8d1af960e52e0-8"&gt;&lt;/a&gt;    &lt;span class="n"&gt;dx&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;beta&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_50ccf7005e66491dbad8d1af960e52e0-9" name="rest_code_50ccf7005e66491dbad8d1af960e52e0-9" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_50ccf7005e66491dbad8d1af960e52e0-9"&gt;&lt;/a&gt;    &lt;span class="n"&gt;dx&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;beta&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;sigma&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_50ccf7005e66491dbad8d1af960e52e0-10" name="rest_code_50ccf7005e66491dbad8d1af960e52e0-10" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_50ccf7005e66491dbad8d1af960e52e0-10"&gt;&lt;/a&gt;    &lt;span class="n"&gt;dx&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;sigma&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;sigma&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_50ccf7005e66491dbad8d1af960e52e0-11" name="rest_code_50ccf7005e66491dbad8d1af960e52e0-11" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_50ccf7005e66491dbad8d1af960e52e0-11"&gt;&lt;/a&gt;    &lt;span class="n"&gt;dx&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;sigma&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;gamma&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_50ccf7005e66491dbad8d1af960e52e0-12" name="rest_code_50ccf7005e66491dbad8d1af960e52e0-12" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_50ccf7005e66491dbad8d1af960e52e0-12"&gt;&lt;/a&gt;    &lt;span class="n"&gt;dx&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;gamma&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;gamma&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_50ccf7005e66491dbad8d1af960e52e0-13" name="rest_code_50ccf7005e66491dbad8d1af960e52e0-13" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_50ccf7005e66491dbad8d1af960e52e0-13"&gt;&lt;/a&gt;    &lt;span class="n"&gt;dx&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;gamma&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_50ccf7005e66491dbad8d1af960e52e0-14" name="rest_code_50ccf7005e66491dbad8d1af960e52e0-14" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_50ccf7005e66491dbad8d1af960e52e0-14"&gt;&lt;/a&gt;    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;dx&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="code"&gt;&lt;pre class="code ipython3"&gt;&lt;a id="rest_code_235f3c6356b64e44a3496d2d004cdec2-1" name="rest_code_235f3c6356b64e44a3496d2d004cdec2-1" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_235f3c6356b64e44a3496d2d004cdec2-1"&gt;&lt;/a&gt;&lt;span class="c1"&gt;# Parameters of the model&lt;/span&gt;
&lt;a id="rest_code_235f3c6356b64e44a3496d2d004cdec2-2" name="rest_code_235f3c6356b64e44a3496d2d004cdec2-2" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_235f3c6356b64e44a3496d2d004cdec2-2"&gt;&lt;/a&gt;&lt;span class="n"&gt;N&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;6.7e7&lt;/span&gt; &lt;span class="c1"&gt;# Total population&lt;/span&gt;
&lt;a id="rest_code_235f3c6356b64e44a3496d2d004cdec2-3" name="rest_code_235f3c6356b64e44a3496d2d004cdec2-3" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_235f3c6356b64e44a3496d2d004cdec2-3"&gt;&lt;/a&gt;&lt;span class="n"&gt;i0&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;1e-4&lt;/span&gt; &lt;span class="c1"&gt;# 0.5*Proportion of the population infected on day 0&lt;/span&gt;
&lt;a id="rest_code_235f3c6356b64e44a3496d2d004cdec2-4" name="rest_code_235f3c6356b64e44a3496d2d004cdec2-4" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_235f3c6356b64e44a3496d2d004cdec2-4"&gt;&lt;/a&gt;&lt;span class="n"&gt;tlast&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;365.0&lt;/span&gt; &lt;span class="c1"&gt;# Consider a year&lt;/span&gt;
&lt;a id="rest_code_235f3c6356b64e44a3496d2d004cdec2-5" name="rest_code_235f3c6356b64e44a3496d2d004cdec2-5" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_235f3c6356b64e44a3496d2d004cdec2-5"&gt;&lt;/a&gt;&lt;span class="n"&gt;latent_period&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;5.0&lt;/span&gt; &lt;span class="c1"&gt;# Days between being infected and becoming infectious&lt;/span&gt;
&lt;a id="rest_code_235f3c6356b64e44a3496d2d004cdec2-6" name="rest_code_235f3c6356b64e44a3496d2d004cdec2-6" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_235f3c6356b64e44a3496d2d004cdec2-6"&gt;&lt;/a&gt;&lt;span class="n"&gt;infectious_period&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;7.0&lt;/span&gt; &lt;span class="c1"&gt;# Days infectious&lt;/span&gt;
&lt;a id="rest_code_235f3c6356b64e44a3496d2d004cdec2-7" name="rest_code_235f3c6356b64e44a3496d2d004cdec2-7" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_235f3c6356b64e44a3496d2d004cdec2-7"&gt;&lt;/a&gt;&lt;span class="n"&gt;R0&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;2.5&lt;/span&gt; &lt;span class="c1"&gt;# Basic reproduction number in the absence of interventions&lt;/span&gt;
&lt;a id="rest_code_235f3c6356b64e44a3496d2d004cdec2-8" name="rest_code_235f3c6356b64e44a3496d2d004cdec2-8" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_235f3c6356b64e44a3496d2d004cdec2-8"&gt;&lt;/a&gt;&lt;span class="n"&gt;Rt&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;0.75&lt;/span&gt; &lt;span class="c1"&gt;# Reproduction number in the presence of interventions&lt;/span&gt;
&lt;a id="rest_code_235f3c6356b64e44a3496d2d004cdec2-9" name="rest_code_235f3c6356b64e44a3496d2d004cdec2-9" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_235f3c6356b64e44a3496d2d004cdec2-9"&gt;&lt;/a&gt;&lt;span class="n"&gt;tend&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;21.0&lt;/span&gt; &lt;span class="c1"&gt;# Number of days of interventions&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="code"&gt;&lt;pre class="code ipython3"&gt;&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-1" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-1" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-1"&gt;&lt;/a&gt;&lt;span class="n"&gt;beta0&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;R0&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="n"&gt;infectious_period&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-2" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-2" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-2"&gt;&lt;/a&gt;&lt;span class="n"&gt;betat&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Rt&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="n"&gt;infectious_period&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-3" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-3" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-3"&gt;&lt;/a&gt;&lt;span class="n"&gt;sigma&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;2.0&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="n"&gt;latent_period&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-4" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-4" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-4"&gt;&lt;/a&gt;&lt;span class="n"&gt;gamma&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;2.0&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="n"&gt;infectious_period&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-5" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-5" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-5"&gt;&lt;/a&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-6" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-6" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-6"&gt;&lt;/a&gt;&lt;span class="n"&gt;t0ran&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;array&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;100&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;40&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;52.5&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;65&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-7" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-7" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-7"&gt;&lt;/a&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-8" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-8" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-8"&gt;&lt;/a&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;mylab&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-9" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-9" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-9"&gt;&lt;/a&gt;    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-10" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-10" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-10"&gt;&lt;/a&gt;        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="s2"&gt;"Start at "&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="nb"&gt;str&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="s2"&gt;" days"&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-11" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-11" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-11"&gt;&lt;/a&gt;    &lt;span class="k"&gt;else&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-12" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-12" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-12"&gt;&lt;/a&gt;        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="s2"&gt;"Baseline"&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-13" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-13" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-13"&gt;&lt;/a&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-14" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-14" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-14"&gt;&lt;/a&gt;&lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;[]&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-15" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-15" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-15"&gt;&lt;/a&gt;&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;tt&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t0ran&lt;/span&gt;&lt;span class="p"&gt;)):&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-16" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-16" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-16"&gt;&lt;/a&gt;    &lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;append&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;integrate&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;solve_ivp&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;lambda&lt;/span&gt; &lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;odefun&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;beta0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;betat&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;t0ran&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;&lt;span class="n"&gt;t0ran&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="n"&gt;tend&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;sigma&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;gamma&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-17" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-17" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-17"&gt;&lt;/a&gt;                              &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;0.0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;tlast&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-18" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-18" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-18"&gt;&lt;/a&gt;                              &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;array&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="mf"&gt;1.0&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;2.0&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;i0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;0.0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;0.0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;i0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;i0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;0.0&lt;/span&gt;&lt;span class="p"&gt;]),&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-19" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-19" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-19"&gt;&lt;/a&gt;                              &lt;span class="s1"&gt;'RK45'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-20" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-20" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-20"&gt;&lt;/a&gt;                              &lt;span class="n"&gt;atol&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mf"&gt;1e-8&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-21" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-21" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-21"&gt;&lt;/a&gt;                              &lt;span class="n"&gt;rtol&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mf"&gt;1e-9&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="code"&gt;&lt;pre class="code ipython3"&gt;&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-1" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-1" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-1"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;figure&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;figsize&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-2" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-2" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-2"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;subplot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-3" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-3" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-3"&gt;&lt;/a&gt;&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;tt&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t0ran&lt;/span&gt;&lt;span class="p"&gt;)):&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-4" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-4" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-4"&gt;&lt;/a&gt;    &lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;plot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;T&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;label&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;mylab&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t0ran&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]))&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-5" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-5" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-5"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xlim&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="mi"&gt;30&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;70&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-6" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-6" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-6"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ylim&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mf"&gt;7e6&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-7" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-7" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-7"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'Time (days)'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-8" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-8" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-8"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ylabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'Number of infectious cases'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-9" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-9" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-9"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;legend&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-10" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-10" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-10"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;subplot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-11" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-11" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-11"&gt;&lt;/a&gt;&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;tt&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t0ran&lt;/span&gt;&lt;span class="p"&gt;)):&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-12" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-12" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-12"&gt;&lt;/a&gt;    &lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;plot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;T&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;label&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;mylab&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t0ran&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]))&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-13" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-13" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-13"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'Time (days)'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-14" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-14" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-14"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ylabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'Cumulative infections'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-15" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-15" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-15"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;legend&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-16" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-16" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-16"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xlim&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="mi"&gt;30&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;70&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-17" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-17" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-17"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ylim&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mf"&gt;1e7&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-18" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-18" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-18"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;tight_layout&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-19" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-19" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-19"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;show&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="code"&gt;&lt;pre class="code ipython3"&gt;&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-1" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-1" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-1"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;figure&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;figsize&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-2" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-2" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-2"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;subplot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-3" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-3" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-3"&gt;&lt;/a&gt;&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;tt&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t0ran&lt;/span&gt;&lt;span class="p"&gt;)):&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-4" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-4" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-4"&gt;&lt;/a&gt;    &lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;plot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;T&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;label&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;mylab&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t0ran&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]))&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-5" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-5" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-5"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xlim&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;tlast&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-6" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-6" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-6"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ylim&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mf"&gt;1.2e7&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-7" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-7" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-7"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'Time (days)'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-8" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-8" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-8"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ylabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'Number of infectious cases'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-9" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-9" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-9"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;legend&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-10" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-10" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-10"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;subplot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-11" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-11" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-11"&gt;&lt;/a&gt;&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;tt&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t0ran&lt;/span&gt;&lt;span class="p"&gt;)):&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-12" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-12" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-12"&gt;&lt;/a&gt;    &lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;plot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;T&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;label&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;mylab&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t0ran&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]))&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-13" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-13" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-13"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'Time (days)'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-14" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-14" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-14"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ylabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'Cumulative infections'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-15" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-15" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-15"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;legend&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-16" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-16" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-16"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xlim&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;tlast&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-17" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-17" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-17"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ylim&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mf"&gt;6.2e7&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-18" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-18" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-18"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;tight_layout&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-19" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-19" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-19"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;show&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;&lt;/body&gt;&lt;/html&gt;

&lt;div class="code"&gt;&lt;pre class="code ipython3"&gt;&lt;a id="rest_code_a60b412ba835495c84442a608a58c6ec-1" name="rest_code_a60b412ba835495c84442a608a58c6ec-1" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a60b412ba835495c84442a608a58c6ec-1"&gt;&lt;/a&gt;&lt;span class="c1"&gt;# Pull in libraries needed&lt;/span&gt;
&lt;a id="rest_code_a60b412ba835495c84442a608a58c6ec-2" name="rest_code_a60b412ba835495c84442a608a58c6ec-2" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a60b412ba835495c84442a608a58c6ec-2"&gt;&lt;/a&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="k"&gt;matplotlib&lt;/span&gt; inline
&lt;a id="rest_code_a60b412ba835495c84442a608a58c6ec-3" name="rest_code_a60b412ba835495c84442a608a58c6ec-3" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a60b412ba835495c84442a608a58c6ec-3"&gt;&lt;/a&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;numpy&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;np&lt;/span&gt;
&lt;a id="rest_code_a60b412ba835495c84442a608a58c6ec-4" name="rest_code_a60b412ba835495c84442a608a58c6ec-4" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a60b412ba835495c84442a608a58c6ec-4"&gt;&lt;/a&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;scipy&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;integrate&lt;/span&gt;
&lt;a id="rest_code_a60b412ba835495c84442a608a58c6ec-5" name="rest_code_a60b412ba835495c84442a608a58c6ec-5" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a60b412ba835495c84442a608a58c6ec-5"&gt;&lt;/a&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;matplotlib.pyplot&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;plt&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="code"&gt;&lt;pre class="code ipython3"&gt;&lt;a id="rest_code_50ccf7005e66491dbad8d1af960e52e0-1" name="rest_code_50ccf7005e66491dbad8d1af960e52e0-1" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_50ccf7005e66491dbad8d1af960e52e0-1"&gt;&lt;/a&gt;&lt;span class="c1"&gt;# Represent the basic dynamics&lt;/span&gt;
&lt;a id="rest_code_50ccf7005e66491dbad8d1af960e52e0-2" name="rest_code_50ccf7005e66491dbad8d1af960e52e0-2" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_50ccf7005e66491dbad8d1af960e52e0-2"&gt;&lt;/a&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;odefun&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;beta0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;betat&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;t0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;t1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;sigma&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;gamma&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_50ccf7005e66491dbad8d1af960e52e0-3" name="rest_code_50ccf7005e66491dbad8d1af960e52e0-3" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_50ccf7005e66491dbad8d1af960e52e0-3"&gt;&lt;/a&gt;    &lt;span class="n"&gt;dx&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;6&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_50ccf7005e66491dbad8d1af960e52e0-4" name="rest_code_50ccf7005e66491dbad8d1af960e52e0-4" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_50ccf7005e66491dbad8d1af960e52e0-4"&gt;&lt;/a&gt;    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;=&lt;/span&gt;&lt;span class="n"&gt;t0&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="ow"&gt;and&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;=&lt;/span&gt;&lt;span class="n"&gt;t1&lt;/span&gt;&lt;span class="p"&gt;)):&lt;/span&gt;
&lt;a id="rest_code_50ccf7005e66491dbad8d1af960e52e0-5" name="rest_code_50ccf7005e66491dbad8d1af960e52e0-5" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_50ccf7005e66491dbad8d1af960e52e0-5"&gt;&lt;/a&gt;        &lt;span class="n"&gt;beta&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;betat&lt;/span&gt;
&lt;a id="rest_code_50ccf7005e66491dbad8d1af960e52e0-6" name="rest_code_50ccf7005e66491dbad8d1af960e52e0-6" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_50ccf7005e66491dbad8d1af960e52e0-6"&gt;&lt;/a&gt;    &lt;span class="k"&gt;else&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a id="rest_code_50ccf7005e66491dbad8d1af960e52e0-7" name="rest_code_50ccf7005e66491dbad8d1af960e52e0-7" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_50ccf7005e66491dbad8d1af960e52e0-7"&gt;&lt;/a&gt;        &lt;span class="n"&gt;beta&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;beta0&lt;/span&gt;
&lt;a id="rest_code_50ccf7005e66491dbad8d1af960e52e0-8" name="rest_code_50ccf7005e66491dbad8d1af960e52e0-8" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_50ccf7005e66491dbad8d1af960e52e0-8"&gt;&lt;/a&gt;    &lt;span class="n"&gt;dx&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;beta&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_50ccf7005e66491dbad8d1af960e52e0-9" name="rest_code_50ccf7005e66491dbad8d1af960e52e0-9" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_50ccf7005e66491dbad8d1af960e52e0-9"&gt;&lt;/a&gt;    &lt;span class="n"&gt;dx&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;beta&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;sigma&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_50ccf7005e66491dbad8d1af960e52e0-10" name="rest_code_50ccf7005e66491dbad8d1af960e52e0-10" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_50ccf7005e66491dbad8d1af960e52e0-10"&gt;&lt;/a&gt;    &lt;span class="n"&gt;dx&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;sigma&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;sigma&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_50ccf7005e66491dbad8d1af960e52e0-11" name="rest_code_50ccf7005e66491dbad8d1af960e52e0-11" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_50ccf7005e66491dbad8d1af960e52e0-11"&gt;&lt;/a&gt;    &lt;span class="n"&gt;dx&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;sigma&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;gamma&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_50ccf7005e66491dbad8d1af960e52e0-12" name="rest_code_50ccf7005e66491dbad8d1af960e52e0-12" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_50ccf7005e66491dbad8d1af960e52e0-12"&gt;&lt;/a&gt;    &lt;span class="n"&gt;dx&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;gamma&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;gamma&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_50ccf7005e66491dbad8d1af960e52e0-13" name="rest_code_50ccf7005e66491dbad8d1af960e52e0-13" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_50ccf7005e66491dbad8d1af960e52e0-13"&gt;&lt;/a&gt;    &lt;span class="n"&gt;dx&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;gamma&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_50ccf7005e66491dbad8d1af960e52e0-14" name="rest_code_50ccf7005e66491dbad8d1af960e52e0-14" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_50ccf7005e66491dbad8d1af960e52e0-14"&gt;&lt;/a&gt;    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;dx&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="code"&gt;&lt;pre class="code ipython3"&gt;&lt;a id="rest_code_235f3c6356b64e44a3496d2d004cdec2-1" name="rest_code_235f3c6356b64e44a3496d2d004cdec2-1" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_235f3c6356b64e44a3496d2d004cdec2-1"&gt;&lt;/a&gt;&lt;span class="c1"&gt;# Parameters of the model&lt;/span&gt;
&lt;a id="rest_code_235f3c6356b64e44a3496d2d004cdec2-2" name="rest_code_235f3c6356b64e44a3496d2d004cdec2-2" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_235f3c6356b64e44a3496d2d004cdec2-2"&gt;&lt;/a&gt;&lt;span class="n"&gt;N&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;6.7e7&lt;/span&gt; &lt;span class="c1"&gt;# Total population&lt;/span&gt;
&lt;a id="rest_code_235f3c6356b64e44a3496d2d004cdec2-3" name="rest_code_235f3c6356b64e44a3496d2d004cdec2-3" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_235f3c6356b64e44a3496d2d004cdec2-3"&gt;&lt;/a&gt;&lt;span class="n"&gt;i0&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;1e-4&lt;/span&gt; &lt;span class="c1"&gt;# 0.5*Proportion of the population infected on day 0&lt;/span&gt;
&lt;a id="rest_code_235f3c6356b64e44a3496d2d004cdec2-4" name="rest_code_235f3c6356b64e44a3496d2d004cdec2-4" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_235f3c6356b64e44a3496d2d004cdec2-4"&gt;&lt;/a&gt;&lt;span class="n"&gt;tlast&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;365.0&lt;/span&gt; &lt;span class="c1"&gt;# Consider a year&lt;/span&gt;
&lt;a id="rest_code_235f3c6356b64e44a3496d2d004cdec2-5" name="rest_code_235f3c6356b64e44a3496d2d004cdec2-5" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_235f3c6356b64e44a3496d2d004cdec2-5"&gt;&lt;/a&gt;&lt;span class="n"&gt;latent_period&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;5.0&lt;/span&gt; &lt;span class="c1"&gt;# Days between being infected and becoming infectious&lt;/span&gt;
&lt;a id="rest_code_235f3c6356b64e44a3496d2d004cdec2-6" name="rest_code_235f3c6356b64e44a3496d2d004cdec2-6" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_235f3c6356b64e44a3496d2d004cdec2-6"&gt;&lt;/a&gt;&lt;span class="n"&gt;infectious_period&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;7.0&lt;/span&gt; &lt;span class="c1"&gt;# Days infectious&lt;/span&gt;
&lt;a id="rest_code_235f3c6356b64e44a3496d2d004cdec2-7" name="rest_code_235f3c6356b64e44a3496d2d004cdec2-7" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_235f3c6356b64e44a3496d2d004cdec2-7"&gt;&lt;/a&gt;&lt;span class="n"&gt;R0&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;2.5&lt;/span&gt; &lt;span class="c1"&gt;# Basic reproduction number in the absence of interventions&lt;/span&gt;
&lt;a id="rest_code_235f3c6356b64e44a3496d2d004cdec2-8" name="rest_code_235f3c6356b64e44a3496d2d004cdec2-8" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_235f3c6356b64e44a3496d2d004cdec2-8"&gt;&lt;/a&gt;&lt;span class="n"&gt;Rt&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;0.75&lt;/span&gt; &lt;span class="c1"&gt;# Reproduction number in the presence of interventions&lt;/span&gt;
&lt;a id="rest_code_235f3c6356b64e44a3496d2d004cdec2-9" name="rest_code_235f3c6356b64e44a3496d2d004cdec2-9" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_235f3c6356b64e44a3496d2d004cdec2-9"&gt;&lt;/a&gt;&lt;span class="n"&gt;tend&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;21.0&lt;/span&gt; &lt;span class="c1"&gt;# Number of days of interventions&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="code"&gt;&lt;pre class="code ipython3"&gt;&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-1" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-1" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-1"&gt;&lt;/a&gt;&lt;span class="n"&gt;beta0&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;R0&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="n"&gt;infectious_period&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-2" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-2" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-2"&gt;&lt;/a&gt;&lt;span class="n"&gt;betat&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Rt&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="n"&gt;infectious_period&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-3" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-3" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-3"&gt;&lt;/a&gt;&lt;span class="n"&gt;sigma&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;2.0&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="n"&gt;latent_period&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-4" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-4" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-4"&gt;&lt;/a&gt;&lt;span class="n"&gt;gamma&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;2.0&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="n"&gt;infectious_period&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-5" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-5" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-5"&gt;&lt;/a&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-6" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-6" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-6"&gt;&lt;/a&gt;&lt;span class="n"&gt;t0ran&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;array&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;100&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;40&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;52.5&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;65&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-7" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-7" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-7"&gt;&lt;/a&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-8" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-8" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-8"&gt;&lt;/a&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;mylab&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-9" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-9" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-9"&gt;&lt;/a&gt;    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-10" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-10" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-10"&gt;&lt;/a&gt;        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="s2"&gt;"Start at "&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="nb"&gt;str&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="s2"&gt;" days"&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-11" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-11" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-11"&gt;&lt;/a&gt;    &lt;span class="k"&gt;else&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-12" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-12" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-12"&gt;&lt;/a&gt;        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="s2"&gt;"Baseline"&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-13" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-13" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-13"&gt;&lt;/a&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-14" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-14" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-14"&gt;&lt;/a&gt;&lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;[]&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-15" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-15" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-15"&gt;&lt;/a&gt;&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;tt&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t0ran&lt;/span&gt;&lt;span class="p"&gt;)):&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-16" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-16" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-16"&gt;&lt;/a&gt;    &lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;append&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;integrate&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;solve_ivp&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;lambda&lt;/span&gt; &lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;odefun&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;beta0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;betat&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;t0ran&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;&lt;span class="n"&gt;t0ran&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="n"&gt;tend&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;sigma&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;gamma&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-17" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-17" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-17"&gt;&lt;/a&gt;                              &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;0.0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;tlast&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-18" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-18" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-18"&gt;&lt;/a&gt;                              &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;array&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="mf"&gt;1.0&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;2.0&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;i0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;0.0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;0.0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;i0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;i0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;0.0&lt;/span&gt;&lt;span class="p"&gt;]),&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-19" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-19" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-19"&gt;&lt;/a&gt;                              &lt;span class="s1"&gt;'RK45'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-20" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-20" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-20"&gt;&lt;/a&gt;                              &lt;span class="n"&gt;atol&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mf"&gt;1e-8&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-21" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-21" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-21"&gt;&lt;/a&gt;                              &lt;span class="n"&gt;rtol&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mf"&gt;1e-9&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="code"&gt;&lt;pre class="code ipython3"&gt;&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-1" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-1" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-1"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;figure&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;figsize&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-2" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-2" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-2"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;subplot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-3" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-3" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-3"&gt;&lt;/a&gt;&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;tt&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t0ran&lt;/span&gt;&lt;span class="p"&gt;)):&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-4" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-4" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-4"&gt;&lt;/a&gt;    &lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;plot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;T&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;label&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;mylab&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t0ran&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]))&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-5" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-5" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-5"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xlim&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="mi"&gt;30&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;70&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-6" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-6" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-6"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ylim&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mf"&gt;7e6&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-7" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-7" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-7"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'Time (days)'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-8" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-8" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-8"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ylabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'Number of infectious cases'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-9" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-9" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-9"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;legend&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-10" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-10" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-10"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;subplot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-11" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-11" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-11"&gt;&lt;/a&gt;&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;tt&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t0ran&lt;/span&gt;&lt;span class="p"&gt;)):&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-12" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-12" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-12"&gt;&lt;/a&gt;    &lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;plot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;T&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;label&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;mylab&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t0ran&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]))&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-13" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-13" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-13"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'Time (days)'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-14" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-14" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-14"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ylabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'Cumulative infections'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-15" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-15" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-15"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;legend&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-16" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-16" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-16"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xlim&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="mi"&gt;30&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;70&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-17" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-17" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-17"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ylim&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mf"&gt;1e7&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-18" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-18" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-18"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;tight_layout&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-19" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-19" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-19"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;show&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="code"&gt;&lt;pre class="code ipython3"&gt;&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-1" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-1" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-1"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;figure&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;figsize&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-2" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-2" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-2"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;subplot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-3" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-3" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-3"&gt;&lt;/a&gt;&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;tt&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t0ran&lt;/span&gt;&lt;span class="p"&gt;)):&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-4" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-4" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-4"&gt;&lt;/a&gt;    &lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;plot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;T&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;label&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;mylab&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t0ran&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]))&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-5" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-5" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-5"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xlim&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;tlast&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-6" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-6" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-6"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ylim&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mf"&gt;1.2e7&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-7" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-7" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-7"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'Time (days)'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-8" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-8" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-8"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ylabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'Number of infectious cases'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-9" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-9" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-9"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;legend&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-10" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-10" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-10"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;subplot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-11" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-11" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-11"&gt;&lt;/a&gt;&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;tt&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t0ran&lt;/span&gt;&lt;span class="p"&gt;)):&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-12" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-12" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-12"&gt;&lt;/a&gt;    &lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;plot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;T&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;label&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;mylab&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t0ran&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]))&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-13" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-13" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-13"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'Time (days)'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-14" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-14" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-14"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ylabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'Cumulative infections'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-15" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-15" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-15"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;legend&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-16" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-16" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-16"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xlim&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;tlast&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-17" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-17" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-17"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ylim&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mf"&gt;6.2e7&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-18" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-18" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-18"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;tight_layout&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-19" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-19" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-19"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;show&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;&lt;/body&gt;&lt;/html&gt;

&lt;div class="code"&gt;&lt;pre class="code ipython3"&gt;&lt;a id="rest_code_50ccf7005e66491dbad8d1af960e52e0-1" name="rest_code_50ccf7005e66491dbad8d1af960e52e0-1" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_50ccf7005e66491dbad8d1af960e52e0-1"&gt;&lt;/a&gt;&lt;span class="c1"&gt;# Represent the basic dynamics&lt;/span&gt;
&lt;a id="rest_code_50ccf7005e66491dbad8d1af960e52e0-2" name="rest_code_50ccf7005e66491dbad8d1af960e52e0-2" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_50ccf7005e66491dbad8d1af960e52e0-2"&gt;&lt;/a&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;odefun&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;beta0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;betat&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;t0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;t1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;sigma&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;gamma&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_50ccf7005e66491dbad8d1af960e52e0-3" name="rest_code_50ccf7005e66491dbad8d1af960e52e0-3" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_50ccf7005e66491dbad8d1af960e52e0-3"&gt;&lt;/a&gt;    &lt;span class="n"&gt;dx&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;6&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_50ccf7005e66491dbad8d1af960e52e0-4" name="rest_code_50ccf7005e66491dbad8d1af960e52e0-4" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_50ccf7005e66491dbad8d1af960e52e0-4"&gt;&lt;/a&gt;    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;=&lt;/span&gt;&lt;span class="n"&gt;t0&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="ow"&gt;and&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;=&lt;/span&gt;&lt;span class="n"&gt;t1&lt;/span&gt;&lt;span class="p"&gt;)):&lt;/span&gt;
&lt;a id="rest_code_50ccf7005e66491dbad8d1af960e52e0-5" name="rest_code_50ccf7005e66491dbad8d1af960e52e0-5" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_50ccf7005e66491dbad8d1af960e52e0-5"&gt;&lt;/a&gt;        &lt;span class="n"&gt;beta&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;betat&lt;/span&gt;
&lt;a id="rest_code_50ccf7005e66491dbad8d1af960e52e0-6" name="rest_code_50ccf7005e66491dbad8d1af960e52e0-6" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_50ccf7005e66491dbad8d1af960e52e0-6"&gt;&lt;/a&gt;    &lt;span class="k"&gt;else&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a id="rest_code_50ccf7005e66491dbad8d1af960e52e0-7" name="rest_code_50ccf7005e66491dbad8d1af960e52e0-7" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_50ccf7005e66491dbad8d1af960e52e0-7"&gt;&lt;/a&gt;        &lt;span class="n"&gt;beta&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;beta0&lt;/span&gt;
&lt;a id="rest_code_50ccf7005e66491dbad8d1af960e52e0-8" name="rest_code_50ccf7005e66491dbad8d1af960e52e0-8" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_50ccf7005e66491dbad8d1af960e52e0-8"&gt;&lt;/a&gt;    &lt;span class="n"&gt;dx&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;beta&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_50ccf7005e66491dbad8d1af960e52e0-9" name="rest_code_50ccf7005e66491dbad8d1af960e52e0-9" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_50ccf7005e66491dbad8d1af960e52e0-9"&gt;&lt;/a&gt;    &lt;span class="n"&gt;dx&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;beta&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;sigma&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_50ccf7005e66491dbad8d1af960e52e0-10" name="rest_code_50ccf7005e66491dbad8d1af960e52e0-10" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_50ccf7005e66491dbad8d1af960e52e0-10"&gt;&lt;/a&gt;    &lt;span class="n"&gt;dx&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;sigma&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;sigma&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_50ccf7005e66491dbad8d1af960e52e0-11" name="rest_code_50ccf7005e66491dbad8d1af960e52e0-11" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_50ccf7005e66491dbad8d1af960e52e0-11"&gt;&lt;/a&gt;    &lt;span class="n"&gt;dx&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;sigma&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;gamma&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_50ccf7005e66491dbad8d1af960e52e0-12" name="rest_code_50ccf7005e66491dbad8d1af960e52e0-12" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_50ccf7005e66491dbad8d1af960e52e0-12"&gt;&lt;/a&gt;    &lt;span class="n"&gt;dx&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;gamma&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;gamma&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_50ccf7005e66491dbad8d1af960e52e0-13" name="rest_code_50ccf7005e66491dbad8d1af960e52e0-13" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_50ccf7005e66491dbad8d1af960e52e0-13"&gt;&lt;/a&gt;    &lt;span class="n"&gt;dx&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;gamma&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_50ccf7005e66491dbad8d1af960e52e0-14" name="rest_code_50ccf7005e66491dbad8d1af960e52e0-14" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_50ccf7005e66491dbad8d1af960e52e0-14"&gt;&lt;/a&gt;    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;dx&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="code"&gt;&lt;pre class="code ipython3"&gt;&lt;a id="rest_code_235f3c6356b64e44a3496d2d004cdec2-1" name="rest_code_235f3c6356b64e44a3496d2d004cdec2-1" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_235f3c6356b64e44a3496d2d004cdec2-1"&gt;&lt;/a&gt;&lt;span class="c1"&gt;# Parameters of the model&lt;/span&gt;
&lt;a id="rest_code_235f3c6356b64e44a3496d2d004cdec2-2" name="rest_code_235f3c6356b64e44a3496d2d004cdec2-2" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_235f3c6356b64e44a3496d2d004cdec2-2"&gt;&lt;/a&gt;&lt;span class="n"&gt;N&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;6.7e7&lt;/span&gt; &lt;span class="c1"&gt;# Total population&lt;/span&gt;
&lt;a id="rest_code_235f3c6356b64e44a3496d2d004cdec2-3" name="rest_code_235f3c6356b64e44a3496d2d004cdec2-3" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_235f3c6356b64e44a3496d2d004cdec2-3"&gt;&lt;/a&gt;&lt;span class="n"&gt;i0&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;1e-4&lt;/span&gt; &lt;span class="c1"&gt;# 0.5*Proportion of the population infected on day 0&lt;/span&gt;
&lt;a id="rest_code_235f3c6356b64e44a3496d2d004cdec2-4" name="rest_code_235f3c6356b64e44a3496d2d004cdec2-4" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_235f3c6356b64e44a3496d2d004cdec2-4"&gt;&lt;/a&gt;&lt;span class="n"&gt;tlast&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;365.0&lt;/span&gt; &lt;span class="c1"&gt;# Consider a year&lt;/span&gt;
&lt;a id="rest_code_235f3c6356b64e44a3496d2d004cdec2-5" name="rest_code_235f3c6356b64e44a3496d2d004cdec2-5" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_235f3c6356b64e44a3496d2d004cdec2-5"&gt;&lt;/a&gt;&lt;span class="n"&gt;latent_period&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;5.0&lt;/span&gt; &lt;span class="c1"&gt;# Days between being infected and becoming infectious&lt;/span&gt;
&lt;a id="rest_code_235f3c6356b64e44a3496d2d004cdec2-6" name="rest_code_235f3c6356b64e44a3496d2d004cdec2-6" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_235f3c6356b64e44a3496d2d004cdec2-6"&gt;&lt;/a&gt;&lt;span class="n"&gt;infectious_period&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;7.0&lt;/span&gt; &lt;span class="c1"&gt;# Days infectious&lt;/span&gt;
&lt;a id="rest_code_235f3c6356b64e44a3496d2d004cdec2-7" name="rest_code_235f3c6356b64e44a3496d2d004cdec2-7" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_235f3c6356b64e44a3496d2d004cdec2-7"&gt;&lt;/a&gt;&lt;span class="n"&gt;R0&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;2.5&lt;/span&gt; &lt;span class="c1"&gt;# Basic reproduction number in the absence of interventions&lt;/span&gt;
&lt;a id="rest_code_235f3c6356b64e44a3496d2d004cdec2-8" name="rest_code_235f3c6356b64e44a3496d2d004cdec2-8" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_235f3c6356b64e44a3496d2d004cdec2-8"&gt;&lt;/a&gt;&lt;span class="n"&gt;Rt&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;0.75&lt;/span&gt; &lt;span class="c1"&gt;# Reproduction number in the presence of interventions&lt;/span&gt;
&lt;a id="rest_code_235f3c6356b64e44a3496d2d004cdec2-9" name="rest_code_235f3c6356b64e44a3496d2d004cdec2-9" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_235f3c6356b64e44a3496d2d004cdec2-9"&gt;&lt;/a&gt;&lt;span class="n"&gt;tend&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;21.0&lt;/span&gt; &lt;span class="c1"&gt;# Number of days of interventions&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="code"&gt;&lt;pre class="code ipython3"&gt;&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-1" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-1" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-1"&gt;&lt;/a&gt;&lt;span class="n"&gt;beta0&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;R0&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="n"&gt;infectious_period&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-2" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-2" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-2"&gt;&lt;/a&gt;&lt;span class="n"&gt;betat&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Rt&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="n"&gt;infectious_period&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-3" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-3" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-3"&gt;&lt;/a&gt;&lt;span class="n"&gt;sigma&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;2.0&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="n"&gt;latent_period&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-4" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-4" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-4"&gt;&lt;/a&gt;&lt;span class="n"&gt;gamma&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;2.0&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="n"&gt;infectious_period&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-5" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-5" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-5"&gt;&lt;/a&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-6" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-6" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-6"&gt;&lt;/a&gt;&lt;span class="n"&gt;t0ran&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;array&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;100&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;40&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;52.5&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;65&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-7" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-7" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-7"&gt;&lt;/a&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-8" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-8" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-8"&gt;&lt;/a&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;mylab&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-9" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-9" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-9"&gt;&lt;/a&gt;    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-10" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-10" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-10"&gt;&lt;/a&gt;        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="s2"&gt;"Start at "&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="nb"&gt;str&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="s2"&gt;" days"&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-11" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-11" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-11"&gt;&lt;/a&gt;    &lt;span class="k"&gt;else&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-12" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-12" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-12"&gt;&lt;/a&gt;        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="s2"&gt;"Baseline"&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-13" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-13" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-13"&gt;&lt;/a&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-14" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-14" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-14"&gt;&lt;/a&gt;&lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;[]&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-15" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-15" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-15"&gt;&lt;/a&gt;&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;tt&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t0ran&lt;/span&gt;&lt;span class="p"&gt;)):&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-16" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-16" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-16"&gt;&lt;/a&gt;    &lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;append&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;integrate&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;solve_ivp&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;lambda&lt;/span&gt; &lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;odefun&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;beta0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;betat&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;t0ran&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;&lt;span class="n"&gt;t0ran&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="n"&gt;tend&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;sigma&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;gamma&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-17" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-17" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-17"&gt;&lt;/a&gt;                              &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;0.0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;tlast&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-18" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-18" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-18"&gt;&lt;/a&gt;                              &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;array&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="mf"&gt;1.0&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;2.0&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;i0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;0.0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;0.0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;i0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;i0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;0.0&lt;/span&gt;&lt;span class="p"&gt;]),&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-19" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-19" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-19"&gt;&lt;/a&gt;                              &lt;span class="s1"&gt;'RK45'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-20" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-20" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-20"&gt;&lt;/a&gt;                              &lt;span class="n"&gt;atol&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mf"&gt;1e-8&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-21" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-21" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-21"&gt;&lt;/a&gt;                              &lt;span class="n"&gt;rtol&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mf"&gt;1e-9&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="code"&gt;&lt;pre class="code ipython3"&gt;&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-1" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-1" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-1"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;figure&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;figsize&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-2" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-2" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-2"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;subplot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-3" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-3" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-3"&gt;&lt;/a&gt;&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;tt&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t0ran&lt;/span&gt;&lt;span class="p"&gt;)):&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-4" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-4" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-4"&gt;&lt;/a&gt;    &lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;plot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;T&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;label&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;mylab&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t0ran&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]))&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-5" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-5" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-5"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xlim&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="mi"&gt;30&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;70&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-6" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-6" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-6"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ylim&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mf"&gt;7e6&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-7" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-7" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-7"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'Time (days)'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-8" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-8" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-8"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ylabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'Number of infectious cases'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-9" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-9" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-9"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;legend&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-10" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-10" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-10"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;subplot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-11" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-11" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-11"&gt;&lt;/a&gt;&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;tt&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t0ran&lt;/span&gt;&lt;span class="p"&gt;)):&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-12" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-12" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-12"&gt;&lt;/a&gt;    &lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;plot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;T&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;label&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;mylab&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t0ran&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]))&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-13" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-13" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-13"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'Time (days)'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-14" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-14" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-14"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ylabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'Cumulative infections'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-15" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-15" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-15"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;legend&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-16" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-16" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-16"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xlim&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="mi"&gt;30&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;70&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-17" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-17" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-17"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ylim&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mf"&gt;1e7&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-18" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-18" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-18"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;tight_layout&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-19" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-19" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-19"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;show&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="code"&gt;&lt;pre class="code ipython3"&gt;&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-1" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-1" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-1"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;figure&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;figsize&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-2" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-2" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-2"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;subplot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-3" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-3" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-3"&gt;&lt;/a&gt;&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;tt&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t0ran&lt;/span&gt;&lt;span class="p"&gt;)):&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-4" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-4" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-4"&gt;&lt;/a&gt;    &lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;plot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;T&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;label&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;mylab&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t0ran&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]))&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-5" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-5" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-5"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xlim&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;tlast&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-6" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-6" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-6"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ylim&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mf"&gt;1.2e7&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-7" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-7" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-7"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'Time (days)'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-8" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-8" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-8"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ylabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'Number of infectious cases'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-9" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-9" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-9"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;legend&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-10" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-10" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-10"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;subplot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-11" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-11" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-11"&gt;&lt;/a&gt;&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;tt&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t0ran&lt;/span&gt;&lt;span class="p"&gt;)):&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-12" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-12" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-12"&gt;&lt;/a&gt;    &lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;plot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;T&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;label&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;mylab&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t0ran&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]))&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-13" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-13" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-13"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'Time (days)'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-14" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-14" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-14"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ylabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'Cumulative infections'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-15" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-15" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-15"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;legend&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-16" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-16" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-16"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xlim&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;tlast&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-17" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-17" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-17"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ylim&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mf"&gt;6.2e7&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-18" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-18" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-18"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;tight_layout&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-19" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-19" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-19"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;show&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;&lt;/body&gt;&lt;/html&gt;

&lt;div class="code"&gt;&lt;pre class="code ipython3"&gt;&lt;a id="rest_code_235f3c6356b64e44a3496d2d004cdec2-1" name="rest_code_235f3c6356b64e44a3496d2d004cdec2-1" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_235f3c6356b64e44a3496d2d004cdec2-1"&gt;&lt;/a&gt;&lt;span class="c1"&gt;# Parameters of the model&lt;/span&gt;
&lt;a id="rest_code_235f3c6356b64e44a3496d2d004cdec2-2" name="rest_code_235f3c6356b64e44a3496d2d004cdec2-2" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_235f3c6356b64e44a3496d2d004cdec2-2"&gt;&lt;/a&gt;&lt;span class="n"&gt;N&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;6.7e7&lt;/span&gt; &lt;span class="c1"&gt;# Total population&lt;/span&gt;
&lt;a id="rest_code_235f3c6356b64e44a3496d2d004cdec2-3" name="rest_code_235f3c6356b64e44a3496d2d004cdec2-3" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_235f3c6356b64e44a3496d2d004cdec2-3"&gt;&lt;/a&gt;&lt;span class="n"&gt;i0&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;1e-4&lt;/span&gt; &lt;span class="c1"&gt;# 0.5*Proportion of the population infected on day 0&lt;/span&gt;
&lt;a id="rest_code_235f3c6356b64e44a3496d2d004cdec2-4" name="rest_code_235f3c6356b64e44a3496d2d004cdec2-4" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_235f3c6356b64e44a3496d2d004cdec2-4"&gt;&lt;/a&gt;&lt;span class="n"&gt;tlast&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;365.0&lt;/span&gt; &lt;span class="c1"&gt;# Consider a year&lt;/span&gt;
&lt;a id="rest_code_235f3c6356b64e44a3496d2d004cdec2-5" name="rest_code_235f3c6356b64e44a3496d2d004cdec2-5" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_235f3c6356b64e44a3496d2d004cdec2-5"&gt;&lt;/a&gt;&lt;span class="n"&gt;latent_period&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;5.0&lt;/span&gt; &lt;span class="c1"&gt;# Days between being infected and becoming infectious&lt;/span&gt;
&lt;a id="rest_code_235f3c6356b64e44a3496d2d004cdec2-6" name="rest_code_235f3c6356b64e44a3496d2d004cdec2-6" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_235f3c6356b64e44a3496d2d004cdec2-6"&gt;&lt;/a&gt;&lt;span class="n"&gt;infectious_period&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;7.0&lt;/span&gt; &lt;span class="c1"&gt;# Days infectious&lt;/span&gt;
&lt;a id="rest_code_235f3c6356b64e44a3496d2d004cdec2-7" name="rest_code_235f3c6356b64e44a3496d2d004cdec2-7" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_235f3c6356b64e44a3496d2d004cdec2-7"&gt;&lt;/a&gt;&lt;span class="n"&gt;R0&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;2.5&lt;/span&gt; &lt;span class="c1"&gt;# Basic reproduction number in the absence of interventions&lt;/span&gt;
&lt;a id="rest_code_235f3c6356b64e44a3496d2d004cdec2-8" name="rest_code_235f3c6356b64e44a3496d2d004cdec2-8" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_235f3c6356b64e44a3496d2d004cdec2-8"&gt;&lt;/a&gt;&lt;span class="n"&gt;Rt&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;0.75&lt;/span&gt; &lt;span class="c1"&gt;# Reproduction number in the presence of interventions&lt;/span&gt;
&lt;a id="rest_code_235f3c6356b64e44a3496d2d004cdec2-9" name="rest_code_235f3c6356b64e44a3496d2d004cdec2-9" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_235f3c6356b64e44a3496d2d004cdec2-9"&gt;&lt;/a&gt;&lt;span class="n"&gt;tend&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;21.0&lt;/span&gt; &lt;span class="c1"&gt;# Number of days of interventions&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="code"&gt;&lt;pre class="code ipython3"&gt;&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-1" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-1" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-1"&gt;&lt;/a&gt;&lt;span class="n"&gt;beta0&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;R0&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="n"&gt;infectious_period&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-2" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-2" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-2"&gt;&lt;/a&gt;&lt;span class="n"&gt;betat&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Rt&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="n"&gt;infectious_period&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-3" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-3" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-3"&gt;&lt;/a&gt;&lt;span class="n"&gt;sigma&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;2.0&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="n"&gt;latent_period&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-4" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-4" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-4"&gt;&lt;/a&gt;&lt;span class="n"&gt;gamma&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;2.0&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="n"&gt;infectious_period&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-5" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-5" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-5"&gt;&lt;/a&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-6" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-6" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-6"&gt;&lt;/a&gt;&lt;span class="n"&gt;t0ran&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;array&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;100&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;40&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;52.5&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;65&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-7" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-7" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-7"&gt;&lt;/a&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-8" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-8" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-8"&gt;&lt;/a&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;mylab&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-9" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-9" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-9"&gt;&lt;/a&gt;    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-10" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-10" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-10"&gt;&lt;/a&gt;        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="s2"&gt;"Start at "&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="nb"&gt;str&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="s2"&gt;" days"&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-11" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-11" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-11"&gt;&lt;/a&gt;    &lt;span class="k"&gt;else&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-12" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-12" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-12"&gt;&lt;/a&gt;        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="s2"&gt;"Baseline"&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-13" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-13" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-13"&gt;&lt;/a&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-14" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-14" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-14"&gt;&lt;/a&gt;&lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;[]&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-15" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-15" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-15"&gt;&lt;/a&gt;&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;tt&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t0ran&lt;/span&gt;&lt;span class="p"&gt;)):&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-16" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-16" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-16"&gt;&lt;/a&gt;    &lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;append&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;integrate&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;solve_ivp&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;lambda&lt;/span&gt; &lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;odefun&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;beta0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;betat&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;t0ran&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;&lt;span class="n"&gt;t0ran&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="n"&gt;tend&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;sigma&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;gamma&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-17" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-17" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-17"&gt;&lt;/a&gt;                              &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;0.0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;tlast&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-18" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-18" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-18"&gt;&lt;/a&gt;                              &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;array&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="mf"&gt;1.0&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;2.0&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;i0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;0.0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;0.0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;i0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;i0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;0.0&lt;/span&gt;&lt;span class="p"&gt;]),&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-19" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-19" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-19"&gt;&lt;/a&gt;                              &lt;span class="s1"&gt;'RK45'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-20" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-20" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-20"&gt;&lt;/a&gt;                              &lt;span class="n"&gt;atol&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mf"&gt;1e-8&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-21" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-21" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-21"&gt;&lt;/a&gt;                              &lt;span class="n"&gt;rtol&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mf"&gt;1e-9&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="code"&gt;&lt;pre class="code ipython3"&gt;&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-1" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-1" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-1"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;figure&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;figsize&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-2" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-2" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-2"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;subplot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-3" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-3" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-3"&gt;&lt;/a&gt;&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;tt&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t0ran&lt;/span&gt;&lt;span class="p"&gt;)):&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-4" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-4" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-4"&gt;&lt;/a&gt;    &lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;plot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;T&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;label&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;mylab&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t0ran&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]))&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-5" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-5" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-5"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xlim&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="mi"&gt;30&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;70&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-6" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-6" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-6"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ylim&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mf"&gt;7e6&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-7" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-7" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-7"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'Time (days)'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-8" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-8" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-8"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ylabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'Number of infectious cases'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-9" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-9" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-9"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;legend&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-10" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-10" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-10"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;subplot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-11" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-11" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-11"&gt;&lt;/a&gt;&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;tt&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t0ran&lt;/span&gt;&lt;span class="p"&gt;)):&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-12" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-12" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-12"&gt;&lt;/a&gt;    &lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;plot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;T&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;label&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;mylab&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t0ran&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]))&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-13" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-13" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-13"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'Time (days)'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-14" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-14" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-14"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ylabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'Cumulative infections'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-15" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-15" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-15"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;legend&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-16" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-16" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-16"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xlim&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="mi"&gt;30&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;70&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-17" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-17" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-17"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ylim&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mf"&gt;1e7&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-18" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-18" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-18"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;tight_layout&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-19" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-19" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-19"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;show&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="code"&gt;&lt;pre class="code ipython3"&gt;&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-1" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-1" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-1"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;figure&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;figsize&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-2" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-2" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-2"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;subplot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-3" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-3" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-3"&gt;&lt;/a&gt;&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;tt&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t0ran&lt;/span&gt;&lt;span class="p"&gt;)):&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-4" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-4" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-4"&gt;&lt;/a&gt;    &lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;plot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;T&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;label&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;mylab&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t0ran&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]))&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-5" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-5" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-5"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xlim&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;tlast&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-6" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-6" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-6"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ylim&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mf"&gt;1.2e7&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-7" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-7" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-7"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'Time (days)'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-8" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-8" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-8"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ylabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'Number of infectious cases'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-9" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-9" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-9"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;legend&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-10" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-10" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-10"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;subplot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-11" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-11" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-11"&gt;&lt;/a&gt;&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;tt&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t0ran&lt;/span&gt;&lt;span class="p"&gt;)):&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-12" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-12" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-12"&gt;&lt;/a&gt;    &lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;plot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;T&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;label&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;mylab&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t0ran&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]))&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-13" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-13" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-13"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'Time (days)'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-14" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-14" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-14"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ylabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'Cumulative infections'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-15" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-15" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-15"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;legend&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-16" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-16" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-16"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xlim&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;tlast&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-17" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-17" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-17"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ylim&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mf"&gt;6.2e7&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-18" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-18" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-18"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;tight_layout&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-19" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-19" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-19"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;show&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;&lt;/body&gt;&lt;/html&gt;

&lt;div class="code"&gt;&lt;pre class="code ipython3"&gt;&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-1" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-1" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-1"&gt;&lt;/a&gt;&lt;span class="n"&gt;beta0&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;R0&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="n"&gt;infectious_period&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-2" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-2" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-2"&gt;&lt;/a&gt;&lt;span class="n"&gt;betat&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Rt&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="n"&gt;infectious_period&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-3" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-3" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-3"&gt;&lt;/a&gt;&lt;span class="n"&gt;sigma&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;2.0&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="n"&gt;latent_period&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-4" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-4" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-4"&gt;&lt;/a&gt;&lt;span class="n"&gt;gamma&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;2.0&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="n"&gt;infectious_period&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-5" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-5" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-5"&gt;&lt;/a&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-6" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-6" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-6"&gt;&lt;/a&gt;&lt;span class="n"&gt;t0ran&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;array&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;100&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;40&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;52.5&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;65&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-7" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-7" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-7"&gt;&lt;/a&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-8" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-8" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-8"&gt;&lt;/a&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;mylab&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-9" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-9" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-9"&gt;&lt;/a&gt;    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-10" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-10" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-10"&gt;&lt;/a&gt;        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="s2"&gt;"Start at "&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="nb"&gt;str&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="s2"&gt;" days"&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-11" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-11" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-11"&gt;&lt;/a&gt;    &lt;span class="k"&gt;else&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-12" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-12" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-12"&gt;&lt;/a&gt;        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="s2"&gt;"Baseline"&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-13" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-13" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-13"&gt;&lt;/a&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-14" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-14" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-14"&gt;&lt;/a&gt;&lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;[]&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-15" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-15" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-15"&gt;&lt;/a&gt;&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;tt&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t0ran&lt;/span&gt;&lt;span class="p"&gt;)):&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-16" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-16" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-16"&gt;&lt;/a&gt;    &lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;append&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;integrate&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;solve_ivp&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;lambda&lt;/span&gt; &lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;odefun&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;beta0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;betat&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;t0ran&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;&lt;span class="n"&gt;t0ran&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="n"&gt;tend&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;sigma&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;gamma&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-17" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-17" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-17"&gt;&lt;/a&gt;                              &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;0.0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;tlast&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-18" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-18" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-18"&gt;&lt;/a&gt;                              &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;array&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="mf"&gt;1.0&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;2.0&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;i0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;0.0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;0.0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;i0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;i0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;0.0&lt;/span&gt;&lt;span class="p"&gt;]),&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-19" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-19" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-19"&gt;&lt;/a&gt;                              &lt;span class="s1"&gt;'RK45'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-20" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-20" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-20"&gt;&lt;/a&gt;                              &lt;span class="n"&gt;atol&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mf"&gt;1e-8&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;a id="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-21" name="rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-21" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_6e016fbfb29a4db7879e6ce0d4164b5c-21"&gt;&lt;/a&gt;                              &lt;span class="n"&gt;rtol&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mf"&gt;1e-9&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="code"&gt;&lt;pre class="code ipython3"&gt;&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-1" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-1" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-1"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;figure&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;figsize&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-2" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-2" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-2"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;subplot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-3" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-3" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-3"&gt;&lt;/a&gt;&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;tt&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t0ran&lt;/span&gt;&lt;span class="p"&gt;)):&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-4" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-4" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-4"&gt;&lt;/a&gt;    &lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;plot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;T&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;label&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;mylab&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t0ran&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]))&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-5" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-5" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-5"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xlim&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="mi"&gt;30&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;70&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-6" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-6" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-6"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ylim&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mf"&gt;7e6&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-7" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-7" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-7"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'Time (days)'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-8" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-8" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-8"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ylabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'Number of infectious cases'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-9" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-9" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-9"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;legend&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-10" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-10" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-10"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;subplot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-11" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-11" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-11"&gt;&lt;/a&gt;&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;tt&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t0ran&lt;/span&gt;&lt;span class="p"&gt;)):&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-12" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-12" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-12"&gt;&lt;/a&gt;    &lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;plot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;T&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;label&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;mylab&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t0ran&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]))&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-13" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-13" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-13"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'Time (days)'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-14" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-14" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-14"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ylabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'Cumulative infections'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-15" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-15" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-15"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;legend&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-16" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-16" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-16"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xlim&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="mi"&gt;30&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;70&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-17" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-17" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-17"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ylim&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mf"&gt;1e7&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-18" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-18" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-18"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;tight_layout&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-19" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-19" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-19"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;show&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="code"&gt;&lt;pre class="code ipython3"&gt;&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-1" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-1" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-1"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;figure&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;figsize&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-2" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-2" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-2"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;subplot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-3" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-3" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-3"&gt;&lt;/a&gt;&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;tt&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t0ran&lt;/span&gt;&lt;span class="p"&gt;)):&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-4" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-4" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-4"&gt;&lt;/a&gt;    &lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;plot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;T&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;label&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;mylab&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t0ran&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]))&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-5" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-5" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-5"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xlim&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;tlast&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-6" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-6" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-6"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ylim&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mf"&gt;1.2e7&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-7" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-7" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-7"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'Time (days)'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-8" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-8" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-8"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ylabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'Number of infectious cases'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-9" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-9" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-9"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;legend&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-10" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-10" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-10"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;subplot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-11" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-11" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-11"&gt;&lt;/a&gt;&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;tt&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t0ran&lt;/span&gt;&lt;span class="p"&gt;)):&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-12" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-12" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-12"&gt;&lt;/a&gt;    &lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;plot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;T&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;label&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;mylab&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t0ran&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]))&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-13" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-13" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-13"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'Time (days)'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-14" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-14" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-14"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ylabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'Cumulative infections'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-15" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-15" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-15"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;legend&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-16" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-16" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-16"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xlim&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;tlast&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-17" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-17" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-17"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ylim&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mf"&gt;6.2e7&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-18" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-18" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-18"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;tight_layout&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-19" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-19" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-19"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;show&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;&lt;/body&gt;&lt;/html&gt;

&lt;div class="code"&gt;&lt;pre class="code ipython3"&gt;&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-1" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-1" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-1"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;figure&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;figsize&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-2" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-2" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-2"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;subplot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-3" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-3" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-3"&gt;&lt;/a&gt;&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;tt&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t0ran&lt;/span&gt;&lt;span class="p"&gt;)):&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-4" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-4" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-4"&gt;&lt;/a&gt;    &lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;plot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;T&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;label&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;mylab&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t0ran&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]))&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-5" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-5" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-5"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xlim&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="mi"&gt;30&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;70&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-6" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-6" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-6"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ylim&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mf"&gt;7e6&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-7" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-7" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-7"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'Time (days)'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-8" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-8" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-8"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ylabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'Number of infectious cases'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-9" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-9" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-9"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;legend&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-10" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-10" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-10"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;subplot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-11" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-11" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-11"&gt;&lt;/a&gt;&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;tt&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t0ran&lt;/span&gt;&lt;span class="p"&gt;)):&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-12" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-12" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-12"&gt;&lt;/a&gt;    &lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;plot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;T&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;label&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;mylab&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t0ran&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]))&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-13" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-13" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-13"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'Time (days)'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-14" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-14" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-14"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ylabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'Cumulative infections'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-15" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-15" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-15"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;legend&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-16" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-16" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-16"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xlim&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="mi"&gt;30&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;70&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-17" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-17" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-17"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ylim&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mf"&gt;1e7&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-18" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-18" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-18"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;tight_layout&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a id="rest_code_9e56909315b14b08b1774c01ebeb5cc3-19" name="rest_code_9e56909315b14b08b1774c01ebeb5cc3-19" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_9e56909315b14b08b1774c01ebeb5cc3-19"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;show&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="code"&gt;&lt;pre class="code ipython3"&gt;&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-1" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-1" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-1"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;figure&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;figsize&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-2" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-2" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-2"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;subplot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-3" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-3" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-3"&gt;&lt;/a&gt;&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;tt&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t0ran&lt;/span&gt;&lt;span class="p"&gt;)):&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-4" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-4" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-4"&gt;&lt;/a&gt;    &lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;plot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;T&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;label&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;mylab&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t0ran&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]))&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-5" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-5" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-5"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xlim&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;tlast&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-6" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-6" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-6"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ylim&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mf"&gt;1.2e7&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-7" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-7" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-7"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'Time (days)'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-8" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-8" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-8"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ylabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'Number of infectious cases'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-9" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-9" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-9"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;legend&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-10" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-10" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-10"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;subplot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-11" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-11" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-11"&gt;&lt;/a&gt;&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;tt&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t0ran&lt;/span&gt;&lt;span class="p"&gt;)):&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-12" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-12" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-12"&gt;&lt;/a&gt;    &lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;plot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;T&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;label&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;mylab&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t0ran&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]))&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-13" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-13" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-13"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'Time (days)'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-14" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-14" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-14"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ylabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'Cumulative infections'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-15" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-15" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-15"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;legend&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-16" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-16" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-16"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xlim&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;tlast&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-17" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-17" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-17"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ylim&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mf"&gt;6.2e7&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-18" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-18" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-18"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;tight_layout&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-19" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-19" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-19"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;show&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;&lt;/body&gt;&lt;/html&gt;

&lt;div class="code"&gt;&lt;pre class="code ipython3"&gt;&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-1" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-1" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-1"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;figure&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;figsize&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-2" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-2" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-2"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;subplot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-3" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-3" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-3"&gt;&lt;/a&gt;&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;tt&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t0ran&lt;/span&gt;&lt;span class="p"&gt;)):&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-4" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-4" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-4"&gt;&lt;/a&gt;    &lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;plot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;T&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;label&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;mylab&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t0ran&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]))&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-5" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-5" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-5"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xlim&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;tlast&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-6" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-6" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-6"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ylim&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mf"&gt;1.2e7&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-7" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-7" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-7"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'Time (days)'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-8" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-8" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-8"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ylabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'Number of infectious cases'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-9" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-9" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-9"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;legend&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-10" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-10" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-10"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;subplot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-11" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-11" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-11"&gt;&lt;/a&gt;&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;tt&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t0ran&lt;/span&gt;&lt;span class="p"&gt;)):&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-12" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-12" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-12"&gt;&lt;/a&gt;    &lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;plot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;T&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;label&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;mylab&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t0ran&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="p"&gt;]))&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-13" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-13" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-13"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'Time (days)'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-14" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-14" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-14"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ylabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'Cumulative infections'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-15" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-15" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-15"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;legend&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-16" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-16" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-16"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xlim&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;tlast&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-17" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-17" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-17"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ylim&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mf"&gt;6.2e7&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-18" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-18" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-18"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;tight_layout&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a id="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-19" name="rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-19" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html#rest_code_a76c825fd7ca4fc9b2e385a98ec6c6d7-19"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;show&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;&lt;/body&gt;&lt;/html&gt;
</description><guid>https://personalpages.manchester.ac.uk/staff/thomas.house/posts/modelling-herd-immunity.html</guid><pubDate>Sat, 14 Mar 2020 09:54:38 GMT</pubDate></item><item><title>Semester 1 2018</title><link>https://personalpages.manchester.ac.uk/staff/thomas.house/posts/semester-1-2018.html</link><dc:creator>Thomas House</dc:creator><description>&lt;p&gt;This table gives a rough idea of where I was in Semester 1, 2018; I'm putting
it here mainly in case I need to re-use the HTML.&lt;/p&gt;
&lt;p&gt;&lt;span class="raw-html"&gt;&lt;div align="center"&gt;
&lt;table class="timetable"&gt;
&lt;tr&gt;
&lt;th class="timetable"&gt;&lt;/th&gt;
&lt;th class="timetable"&gt;09:00 &lt;/th&gt;
&lt;th class="timetable"&gt;10:00 &lt;/th&gt;
&lt;th class="timetable"&gt;11:00 &lt;/th&gt;
&lt;th class="timetable"&gt;12:00 &lt;/th&gt;
&lt;th class="timetable"&gt;13:00 &lt;/th&gt;
&lt;th class="timetable"&gt;14:00 &lt;/th&gt;
&lt;th class="timetable"&gt;15:00 &lt;/th&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;th class="timetable"&gt;¬†&lt;br&gt;MON&lt;br&gt;¬†&lt;/th&gt;
&lt;td class="timetable freehour"&gt;¬†&lt;/td&gt; &lt;!--  9:00 --&gt;
&lt;td class="timetable" colspan="2"&gt;
Statstics and Machine Learning 1&lt;br&gt;
&lt;em&gt;Lecture&lt;/em&gt; &lt;br&gt;
Simon Building: 4.47&lt;br&gt;
&lt;/td&gt;
&lt;td class="timetable freehour"&gt;¬†&lt;/td&gt;
&lt;td class="timetable freehour"&gt;¬†&lt;/td&gt; &lt;!--  1:00 --&gt;
&lt;td class="timetable" colspan="2"&gt;
Statstics and Machine Learning 1&lt;br&gt;
&lt;em&gt;Computer Class&lt;/em&gt; &lt;br&gt;
Ellen Wilkinson: B3.3&lt;br&gt;
&lt;/td&gt;
&lt;/tr&gt;&lt;tr&gt;
&lt;th class="timetable"&gt;¬†&lt;br&gt;TUES&lt;br&gt;¬†&lt;/th&gt;
&lt;td class="timetable freehour"&gt;¬†&lt;/td&gt;      &lt;!--  9:00 --&gt;
&lt;td class="timetable freehour"&gt;¬†&lt;/td&gt;      &lt;!--  10:00 --&gt;
&lt;td class="timetable freehour"&gt;¬†&lt;/td&gt;      &lt;!--  11:00 --&gt;
&lt;td class="timetable"&gt;
SQUIDS&lt;br&gt;
&lt;em&gt;Seminar&lt;/em&gt;&lt;br&gt;
Frank Adams 1&lt;br&gt;
&lt;/td&gt;
&lt;td class="timetable freehour"&gt;¬†&lt;/td&gt;      &lt;!--  1:00 --&gt;
&lt;td class="timetable freehour"&gt;¬†&lt;/td&gt;      &lt;!--  2:00 --&gt;
&lt;td class="timetable freehour"&gt;¬†&lt;/td&gt;      &lt;!--  3:00 --&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;th class="timetable"&gt;¬†&lt;br&gt;WEDS&lt;br&gt;¬†&lt;/th&gt;
&lt;td class="timetable freehour"&gt;¬†&lt;/td&gt;      &lt;!--  9:00 --&gt;
&lt;td class="timetable" colspan="2"&gt;
Multivariate Statistics&lt;br&gt; &lt;em&gt;Lecture&lt;/em&gt;&lt;br&gt;
University Place 3.213
&lt;/td&gt;
&lt;td class="timetable"&gt;
IM(PA):CT!&lt;br&gt;
&lt;em&gt;Seminar&lt;/em&gt;&lt;br&gt;
Frank Adams 1&lt;br&gt;
&lt;/td&gt;
&lt;td class="timetable freehour"&gt;¬†&lt;/td&gt; &lt;!--  1:00 --&gt;
&lt;td class="timetable freehour"&gt;¬†&lt;/td&gt; &lt;!--  2:00 --&gt;
&lt;td class="timetable freehour"&gt;¬†&lt;/td&gt; &lt;!--  3:00 --&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;th class="timetable"&gt;¬†&lt;br&gt;THURS&lt;br&gt;¬†&lt;/th&gt;
&lt;td class="timetable freehour"&gt;¬†&lt;/td&gt; &lt;!--  9:00 --&gt;
&lt;td class="timetable freehour"&gt;¬†&lt;/td&gt; &lt;!-- 10:00 --&gt;
&lt;td class="timetable freehour"&gt;¬†&lt;/td&gt; &lt;!-- 11:00 --&gt;
&lt;td class="timetable freehour"&gt;¬†&lt;/td&gt; &lt;!-- 12:00 --&gt;
&lt;td class="timetable freehour"&gt;¬†&lt;/td&gt; &lt;!--  1:00 --&gt;
&lt;td class="timetable freehour"&gt;¬†&lt;/td&gt; &lt;!--  2:00 --&gt;
&lt;td class="timetable freehour"&gt;¬†&lt;/td&gt; &lt;!--  3:00 --&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;th class="timetable"&gt;¬†&lt;br&gt;FRI&lt;br&gt;¬†&lt;/th&gt;
&lt;td class="timetable"&gt;
Multivariate Statistics&lt;br&gt; &lt;em&gt;Lecture&lt;/em&gt;&lt;br&gt;
University Place 3.214
&lt;/td&gt;
&lt;td class="timetable"&gt;
Multivariate Statistics&lt;br&gt; &lt;em&gt;Tutorial&lt;/em&gt;&lt;br&gt;
University Place 3.214
&lt;/td&gt;
&lt;td class="timetable" colspan="2"&gt;
Office Hours&lt;br&gt; &lt;em&gt;(11.30-12.30 guaranteed)&lt;/em&gt;&lt;br&gt;
Alan Turing Building 1.114
&lt;/td&gt;
&lt;td class="timetable"&gt;
Calculus and Vectors&lt;br&gt; &lt;em&gt;Group 14 Supervision&lt;/em&gt;&lt;br&gt;
Alan Turing Building G.108
&lt;/td&gt;
&lt;td class="timetable freehour"&gt;¬†&lt;/td&gt; &lt;!--  2:00 --&gt;
&lt;td class="timetable"&gt;
Calculus and Vectors&lt;br&gt; &lt;em&gt;Group 38 Supervision&lt;/em&gt;&lt;br&gt;
Alan Turing Building G.221A
&lt;/td&gt;
&lt;/tr&gt;
&lt;/table&gt;
&lt;/div&gt;&lt;/span&gt;&lt;/p&gt;&lt;/body&gt;&lt;/html&gt;

&lt;p&gt;&lt;span class="raw-html"&gt;&lt;div align="center"&gt;
&lt;table class="timetable"&gt;
&lt;tr&gt;
&lt;th class="timetable"&gt;&lt;/th&gt;
&lt;th class="timetable"&gt;09:00 &lt;/th&gt;
&lt;th class="timetable"&gt;10:00 &lt;/th&gt;
&lt;th class="timetable"&gt;11:00 &lt;/th&gt;
&lt;th class="timetable"&gt;12:00 &lt;/th&gt;
&lt;th class="timetable"&gt;13:00 &lt;/th&gt;
&lt;th class="timetable"&gt;14:00 &lt;/th&gt;
&lt;th class="timetable"&gt;15:00 &lt;/th&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;th class="timetable"&gt;¬†&lt;br&gt;MON&lt;br&gt;¬†&lt;/th&gt;
&lt;td class="timetable freehour"&gt;¬†&lt;/td&gt; &lt;!--  9:00 --&gt;
&lt;td class="timetable" colspan="2"&gt;
Statstics and Machine Learning 1&lt;br&gt;
&lt;em&gt;Lecture&lt;/em&gt; &lt;br&gt;
Simon Building: 4.47&lt;br&gt;
&lt;/td&gt;
&lt;td class="timetable freehour"&gt;¬†&lt;/td&gt;
&lt;td class="timetable freehour"&gt;¬†&lt;/td&gt; &lt;!--  1:00 --&gt;
&lt;td class="timetable" colspan="2"&gt;
Statstics and Machine Learning 1&lt;br&gt;
&lt;em&gt;Computer Class&lt;/em&gt; &lt;br&gt;
Ellen Wilkinson: B3.3&lt;br&gt;
&lt;/td&gt;
&lt;/tr&gt;&lt;tr&gt;
&lt;th class="timetable"&gt;¬†&lt;br&gt;TUES&lt;br&gt;¬†&lt;/th&gt;
&lt;td class="timetable freehour"&gt;¬†&lt;/td&gt;      &lt;!--  9:00 --&gt;
&lt;td class="timetable freehour"&gt;¬†&lt;/td&gt;      &lt;!--  10:00 --&gt;
&lt;td class="timetable freehour"&gt;¬†&lt;/td&gt;      &lt;!--  11:00 --&gt;
&lt;td class="timetable"&gt;
SQUIDS&lt;br&gt;
&lt;em&gt;Seminar&lt;/em&gt;&lt;br&gt;
Frank Adams 1&lt;br&gt;
&lt;/td&gt;
&lt;td class="timetable freehour"&gt;¬†&lt;/td&gt;      &lt;!--  1:00 --&gt;
&lt;td class="timetable freehour"&gt;¬†&lt;/td&gt;      &lt;!--  2:00 --&gt;
&lt;td class="timetable freehour"&gt;¬†&lt;/td&gt;      &lt;!--  3:00 --&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;th class="timetable"&gt;¬†&lt;br&gt;WEDS&lt;br&gt;¬†&lt;/th&gt;
&lt;td class="timetable freehour"&gt;¬†&lt;/td&gt;      &lt;!--  9:00 --&gt;
&lt;td class="timetable" colspan="2"&gt;
Multivariate Statistics&lt;br&gt; &lt;em&gt;Lecture&lt;/em&gt;&lt;br&gt;
University Place 3.213
&lt;/td&gt;
&lt;td class="timetable"&gt;
IM(PA):CT!&lt;br&gt;
&lt;em&gt;Seminar&lt;/em&gt;&lt;br&gt;
Frank Adams 1&lt;br&gt;
&lt;/td&gt;
&lt;td class="timetable freehour"&gt;¬†&lt;/td&gt; &lt;!--  1:00 --&gt;
&lt;td class="timetable freehour"&gt;¬†&lt;/td&gt; &lt;!--  2:00 --&gt;
&lt;td class="timetable freehour"&gt;¬†&lt;/td&gt; &lt;!--  3:00 --&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;th class="timetable"&gt;¬†&lt;br&gt;THURS&lt;br&gt;¬†&lt;/th&gt;
&lt;td class="timetable freehour"&gt;¬†&lt;/td&gt; &lt;!--  9:00 --&gt;
&lt;td class="timetable freehour"&gt;¬†&lt;/td&gt; &lt;!-- 10:00 --&gt;
&lt;td class="timetable freehour"&gt;¬†&lt;/td&gt; &lt;!-- 11:00 --&gt;
&lt;td class="timetable freehour"&gt;¬†&lt;/td&gt; &lt;!-- 12:00 --&gt;
&lt;td class="timetable freehour"&gt;¬†&lt;/td&gt; &lt;!--  1:00 --&gt;
&lt;td class="timetable freehour"&gt;¬†&lt;/td&gt; &lt;!--  2:00 --&gt;
&lt;td class="timetable freehour"&gt;¬†&lt;/td&gt; &lt;!--  3:00 --&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;th class="timetable"&gt;¬†&lt;br&gt;FRI&lt;br&gt;¬†&lt;/th&gt;
&lt;td class="timetable"&gt;
Multivariate Statistics&lt;br&gt; &lt;em&gt;Lecture&lt;/em&gt;&lt;br&gt;
University Place 3.214
&lt;/td&gt;
&lt;td class="timetable"&gt;
Multivariate Statistics&lt;br&gt; &lt;em&gt;Tutorial&lt;/em&gt;&lt;br&gt;
University Place 3.214
&lt;/td&gt;
&lt;td class="timetable" colspan="2"&gt;
Office Hours&lt;br&gt; &lt;em&gt;(11.30-12.30 guaranteed)&lt;/em&gt;&lt;br&gt;
Alan Turing Building 1.114
&lt;/td&gt;
&lt;td class="timetable"&gt;
Calculus and Vectors&lt;br&gt; &lt;em&gt;Group 14 Supervision&lt;/em&gt;&lt;br&gt;
Alan Turing Building G.108
&lt;/td&gt;
&lt;td class="timetable freehour"&gt;¬†&lt;/td&gt; &lt;!--  2:00 --&gt;
&lt;td class="timetable"&gt;
Calculus and Vectors&lt;br&gt; &lt;em&gt;Group 38 Supervision&lt;/em&gt;&lt;br&gt;
Alan Turing Building G.221A
&lt;/td&gt;
&lt;/tr&gt;
&lt;/table&gt;
&lt;/div&gt;&lt;/span&gt;&lt;/p&gt;&lt;/body&gt;&lt;/html&gt;
</description><guid>https://personalpages.manchester.ac.uk/staff/thomas.house/posts/semester-1-2018.html</guid><pubDate>Fri, 21 Dec 2018 10:30:44 GMT</pubDate></item><item><title>Opportunities in Manchester</title><link>https://personalpages.manchester.ac.uk/staff/thomas.house/posts/opportunities-in-manchester.html</link><dc:creator>Thomas House</dc:creator><description>&lt;img alt="Mathematical Epidemiologists 2018" class="align-right" src="https://personalpages.manchester.ac.uk/staff/thomas.house/group_2018.jpg" style="width: 360px;"&gt;
&lt;p&gt;There are various opportunities to work in areas related to Mathematical
Epidemiology in Manchester at present - a recent meeting of our lively and
growing group is shown, please get in touch if you're interested!&lt;/p&gt;
&lt;section id="phd"&gt;
&lt;h2&gt;PhD:&lt;/h2&gt;
&lt;p&gt;&lt;a class="reference external" href="https://www.findaphd.com/search/projectdetails.aspx?PJID=80395"&gt;Understanding and Mitigating Against Organ Damage from Radiotherapy using
Statistical Learning from Large Cohort Data&lt;/a&gt; (Deadline
Friday 16 November) is a PhD programme looking at methods for cancer
radiotherapy data with the world-leading group at the Christie Hospital.&lt;/p&gt;
&lt;p&gt;&lt;a class="reference external" href="https://www.turing.ac.uk/phd-at-turing"&gt;Alan Turing Institute PhD Programme&lt;/a&gt; -
Lorenzo Pellis, Ian Hall and I are Alan Turing Institute Fellows and can support
applications to this scheme.&lt;/p&gt;
&lt;/section&gt;
&lt;section id="postdocotral"&gt;
&lt;h2&gt;Postdocotral:&lt;/h2&gt;
&lt;p&gt;&lt;a class="reference external" href="https://www.jobs.manchester.ac.uk/internal/displayjob.aspx?jobid=16284"&gt;Dame Kathleen Ollerenshaw Fellowships&lt;/a&gt;
(Deadline 23 November) are 5 year postdoctoral positions leading on to tenure.&lt;/p&gt;
&lt;/section&gt;
&lt;section id="faculty"&gt;
&lt;h2&gt;Faculty:&lt;/h2&gt;
&lt;p&gt;There are also two open Faculty positions:
&lt;a class="reference external" href="https://www.jobs.ac.uk/job/BOA591/lecturer-senior-lecturer-or-reader-in-applied-mathematics"&gt;Lecturer, Senior Lecturer or Reader in Applied Mathematics&lt;/a&gt;
and
&lt;a class="reference external" href="https://www.jobs.ac.uk/job/BOA582/lecturer-in-mathematical-finance-mathematical-statistics"&gt;Lecturer in Mathematical Finance / Mathematical Statistics&lt;/a&gt;
(Deadline 11 January).&lt;/p&gt;
&lt;/section&gt;&lt;/body&gt;&lt;/html&gt;

&lt;section id="phd"&gt;
&lt;h2&gt;PhD:&lt;/h2&gt;
&lt;p&gt;&lt;a class="reference external" href="https://www.findaphd.com/search/projectdetails.aspx?PJID=80395"&gt;Understanding and Mitigating Against Organ Damage from Radiotherapy using
Statistical Learning from Large Cohort Data&lt;/a&gt; (Deadline
Friday 16 November) is a PhD programme looking at methods for cancer
radiotherapy data with the world-leading group at the Christie Hospital.&lt;/p&gt;
&lt;p&gt;&lt;a class="reference external" href="https://www.turing.ac.uk/phd-at-turing"&gt;Alan Turing Institute PhD Programme&lt;/a&gt; -
Lorenzo Pellis, Ian Hall and I are Alan Turing Institute Fellows and can support
applications to this scheme.&lt;/p&gt;
&lt;/section&gt;
&lt;section id="postdocotral"&gt;
&lt;h2&gt;Postdocotral:&lt;/h2&gt;
&lt;p&gt;&lt;a class="reference external" href="https://www.jobs.manchester.ac.uk/internal/displayjob.aspx?jobid=16284"&gt;Dame Kathleen Ollerenshaw Fellowships&lt;/a&gt;
(Deadline 23 November) are 5 year postdoctoral positions leading on to tenure.&lt;/p&gt;
&lt;/section&gt;
&lt;section id="faculty"&gt;
&lt;h2&gt;Faculty:&lt;/h2&gt;
&lt;p&gt;There are also two open Faculty positions:
&lt;a class="reference external" href="https://www.jobs.ac.uk/job/BOA591/lecturer-senior-lecturer-or-reader-in-applied-mathematics"&gt;Lecturer, Senior Lecturer or Reader in Applied Mathematics&lt;/a&gt;
and
&lt;a class="reference external" href="https://www.jobs.ac.uk/job/BOA582/lecturer-in-mathematical-finance-mathematical-statistics"&gt;Lecturer in Mathematical Finance / Mathematical Statistics&lt;/a&gt;
(Deadline 11 January).&lt;/p&gt;
&lt;/section&gt;&lt;/body&gt;&lt;/html&gt;

&lt;section id="postdocotral"&gt;
&lt;h2&gt;Postdocotral:&lt;/h2&gt;
&lt;p&gt;&lt;a class="reference external" href="https://www.jobs.manchester.ac.uk/internal/displayjob.aspx?jobid=16284"&gt;Dame Kathleen Ollerenshaw Fellowships&lt;/a&gt;
(Deadline 23 November) are 5 year postdoctoral positions leading on to tenure.&lt;/p&gt;
&lt;/section&gt;
&lt;section id="faculty"&gt;
&lt;h2&gt;Faculty:&lt;/h2&gt;
&lt;p&gt;There are also two open Faculty positions:
&lt;a class="reference external" href="https://www.jobs.ac.uk/job/BOA591/lecturer-senior-lecturer-or-reader-in-applied-mathematics"&gt;Lecturer, Senior Lecturer or Reader in Applied Mathematics&lt;/a&gt;
and
&lt;a class="reference external" href="https://www.jobs.ac.uk/job/BOA582/lecturer-in-mathematical-finance-mathematical-statistics"&gt;Lecturer in Mathematical Finance / Mathematical Statistics&lt;/a&gt;
(Deadline 11 January).&lt;/p&gt;
&lt;/section&gt;&lt;/body&gt;&lt;/html&gt;

&lt;section id="faculty"&gt;
&lt;h2&gt;Faculty:&lt;/h2&gt;
&lt;p&gt;There are also two open Faculty positions:
&lt;a class="reference external" href="https://www.jobs.ac.uk/job/BOA591/lecturer-senior-lecturer-or-reader-in-applied-mathematics"&gt;Lecturer, Senior Lecturer or Reader in Applied Mathematics&lt;/a&gt;
and
&lt;a class="reference external" href="https://www.jobs.ac.uk/job/BOA582/lecturer-in-mathematical-finance-mathematical-statistics"&gt;Lecturer in Mathematical Finance / Mathematical Statistics&lt;/a&gt;
(Deadline 11 January).&lt;/p&gt;
&lt;/section&gt;&lt;/body&gt;&lt;/html&gt;
</description><guid>https://personalpages.manchester.ac.uk/staff/thomas.house/posts/opportunities-in-manchester.html</guid><pubDate>Mon, 12 Nov 2018 12:06:21 GMT</pubDate></item><item><title>Caffeine in Pregnancy, Weak Identifiability, and Working with the Media</title><link>https://personalpages.manchester.ac.uk/staff/thomas.house/posts/caffeine-in-pregnancy-weak-identifiability-and-working-with-the-media.html</link><dc:creator>Thomas House</dc:creator><description>&lt;p&gt;A recent &lt;a class="reference external" href="http://bmjopen.bmj.com/content/8/3/e018895/"&gt;Paper in BMJ Open&lt;/a&gt;
deals with the question of maternal caffeine intake and childhood obesity.&lt;/p&gt;
&lt;p&gt;I worked with the Science Media Centre to produce a &lt;a class="reference external" href="http://www.sciencemediacentre.org/expert-reaction-to-study-looking-at-caffeine-in-pregnancy-and-weight-gain-in-children/"&gt;Press Release&lt;/a&gt; in which I made
the comment:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;"This study makes the headline claim that in a population of over 50,000
mother-child pairs, caffeine intake is positively associated with risk of
childhood obesity.  Let us make a ‚Äòback of the envelope‚Äô calculation on one
of the outcome measures using the cup of instant coffee per day as a measure
of the mother‚Äôs caffeine intake.&lt;/p&gt;
&lt;p&gt;If we take 100 children whose mother group had the lowest caffeine intake (1
cup or less) then at age three, around 11 will be obese; in the next group
(1-4 cups) there will be one additional obese child (12 in total); in the
next (4-6 cups) there will be an additional two (14 in total) and in the
group with highest caffeine intake (6 or more cups) there will be an
additional three (17 in total).&lt;/p&gt;
&lt;p&gt;The main problem with the study is that
maternal caffeine intake is strongly correlated with other relevant factors,
and so these should be controlled for.  In the authors‚Äô statistical analyses,
the ‚Äòbest fit‚Äô models they‚Äôve used suggest around half of the additional
cases of obesity in children of age 3 are explained by caffeine rather than,
say, calorie intake of mothers.  But since the caffeine and calorie intake
are correlated, the existence of a ‚Äòbest fit‚Äô model with equal weighting on
both means we actually can‚Äôt say whether a model looking at just calorie
intake of mothers would be an equally good explanation of child obesity.  It
also says nothing about whether including a new explanatory measure, such as
the child‚Äôs calorie intake, would change the model.&lt;/p&gt;
&lt;p&gt;As such, the evidence
provided in the study for a causal effect is extremely weak and the statement
from the authors that 'complete avoidance might actually be advisable' seems
unjustified, particularly when we consider the effects that such a
restriction might have on wellbeing of mothers."&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;This story was quite widely covered, but most papers took the same approach as
&lt;a class="reference external" href="https://inews.co.uk/news/health/pregnant-women-babies-caffeine-consumption-overweight/"&gt;iNews&lt;/a&gt;
and only quoted my main conclusion, but not the reasoning.&lt;/p&gt;
&lt;p&gt;So let's consider a simple exaple that exhibits the main problem, in particular
the following contingency table. This is much smaller than the original study,
but the same phenomenon is exhibited by larger populations with more
explanatory factors:&lt;/p&gt;
&lt;table&gt;
&lt;tbody&gt;
&lt;tr&gt;&lt;td colspan="2" rowspan="2"&gt;&lt;/td&gt;
&lt;td colspan="4"&gt;&lt;p&gt;Caffeine Intake&lt;/p&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;&lt;td colspan="2"&gt;&lt;p&gt;Low&lt;/p&gt;&lt;/td&gt;
&lt;td colspan="2"&gt;&lt;p&gt;High&lt;/p&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;&lt;td rowspan="4"&gt;&lt;p&gt;Calorie
Intake&lt;/p&gt;&lt;/td&gt;
&lt;td rowspan="2"&gt;&lt;p&gt;Low&lt;/p&gt;&lt;/td&gt;
&lt;td&gt;&lt;p&gt;Healthy&lt;/p&gt;&lt;/td&gt;
&lt;td&gt;&lt;p&gt;Overweight&lt;/p&gt;&lt;/td&gt;
&lt;td&gt;&lt;p&gt;Healthy&lt;/p&gt;&lt;/td&gt;
&lt;td&gt;&lt;p&gt;Overweight&lt;/p&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;&lt;p&gt;63&lt;/p&gt;&lt;/td&gt;
&lt;td&gt;&lt;p&gt;7&lt;/p&gt;&lt;/td&gt;
&lt;td&gt;&lt;p&gt;3&lt;/p&gt;&lt;/td&gt;
&lt;td&gt;&lt;p&gt;2&lt;/p&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;&lt;td rowspan="2"&gt;&lt;p&gt;High&lt;/p&gt;&lt;/td&gt;
&lt;td&gt;&lt;p&gt;Healthy&lt;/p&gt;&lt;/td&gt;
&lt;td&gt;&lt;p&gt;Overweight&lt;/p&gt;&lt;/td&gt;
&lt;td&gt;&lt;p&gt;Healthy&lt;/p&gt;&lt;/td&gt;
&lt;td&gt;&lt;p&gt;Overweight&lt;/p&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;&lt;p&gt;2&lt;/p&gt;&lt;/td&gt;
&lt;td&gt;&lt;p&gt;3&lt;/p&gt;&lt;/td&gt;
&lt;td&gt;&lt;p&gt;5&lt;/p&gt;&lt;/td&gt;
&lt;td&gt;&lt;p&gt;15&lt;/p&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;Note that 68% of the high caffeine group is overweight, while only 13% of the
low caffeine group is, but we note that calorie intake may be an issue so let
us perform logistic regression as the authors did, letting
&lt;span class="raw-html"&gt;\[\mathrm{Pr}(\mathrm{Overweight}) = 1/(1+ \mathrm{exp}(-\beta_0
- \beta_1 \times \mathrm{HighCalorie} - \beta_2 \times \mathrm{HighCaffeine})) \mathrm{ ,}\]&lt;/span&gt;
where &lt;span class="raw-html"&gt;\(\beta_0\)&lt;/span&gt; is the intercept, &lt;span class="raw-html"&gt;\(\beta_1\)&lt;/span&gt; is the
log odds due to calories and &lt;span class="raw-html"&gt;\(\beta_2\)&lt;/span&gt; is the log odds due to
caffeine. Setting the intercept at its maximum likelihood value, the maximum
likelihood values for the other parameters are shown as the cross below, which
attributes roughly equal importance to the two factors:&lt;/p&gt;
&lt;img alt="Likelihood surface" src="https://personalpages.manchester.ac.uk/staff/thomas.house/likelihood.png" style="width: 400px;"&gt;
&lt;p&gt;Behind this cross is a shaded region with intensity equal to the likelihood of
different parameter combinations - and we note that there is still a reasonable
amount of shading in the area where &lt;span class="raw-html"&gt;\(\beta_2 \approx 0\)&lt;/span&gt;. This is
a special case of a general phenomenon called weak identifiability, and it is
something &lt;a class="reference external" href="http://rsif.royalsocietypublishing.org/content/13/121/20160279/"&gt;I've done a bit of work on&lt;/a&gt; - there
are various ways to deal with this, but its presence is the reason that
evidence for a causal effect is weak in the original study.&lt;/p&gt;&lt;/body&gt;&lt;/html&gt;

&lt;p&gt;I worked with the Science Media Centre to produce a &lt;a class="reference external" href="http://www.sciencemediacentre.org/expert-reaction-to-study-looking-at-caffeine-in-pregnancy-and-weight-gain-in-children/"&gt;Press Release&lt;/a&gt; in which I made
the comment:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;"This study makes the headline claim that in a population of over 50,000
mother-child pairs, caffeine intake is positively associated with risk of
childhood obesity.  Let us make a ‚Äòback of the envelope‚Äô calculation on one
of the outcome measures using the cup of instant coffee per day as a measure
of the mother‚Äôs caffeine intake.&lt;/p&gt;
&lt;p&gt;If we take 100 children whose mother group had the lowest caffeine intake (1
cup or less) then at age three, around 11 will be obese; in the next group
(1-4 cups) there will be one additional obese child (12 in total); in the
next (4-6 cups) there will be an additional two (14 in total) and in the
group with highest caffeine intake (6 or more cups) there will be an
additional three (17 in total).&lt;/p&gt;
&lt;p&gt;The main problem with the study is that
maternal caffeine intake is strongly correlated with other relevant factors,
and so these should be controlled for.  In the authors‚Äô statistical analyses,
the ‚Äòbest fit‚Äô models they‚Äôve used suggest around half of the additional
cases of obesity in children of age 3 are explained by caffeine rather than,
say, calorie intake of mothers.  But since the caffeine and calorie intake
are correlated, the existence of a ‚Äòbest fit‚Äô model with equal weighting on
both means we actually can‚Äôt say whether a model looking at just calorie
intake of mothers would be an equally good explanation of child obesity.  It
also says nothing about whether including a new explanatory measure, such as
the child‚Äôs calorie intake, would change the model.&lt;/p&gt;
&lt;p&gt;As such, the evidence
provided in the study for a causal effect is extremely weak and the statement
from the authors that 'complete avoidance might actually be advisable' seems
unjustified, particularly when we consider the effects that such a
restriction might have on wellbeing of mothers."&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;This story was quite widely covered, but most papers took the same approach as
&lt;a class="reference external" href="https://inews.co.uk/news/health/pregnant-women-babies-caffeine-consumption-overweight/"&gt;iNews&lt;/a&gt;
and only quoted my main conclusion, but not the reasoning.&lt;/p&gt;
&lt;p&gt;So let's consider a simple exaple that exhibits the main problem, in particular
the following contingency table. This is much smaller than the original study,
but the same phenomenon is exhibited by larger populations with more
explanatory factors:&lt;/p&gt;
&lt;table&gt;
&lt;tbody&gt;
&lt;tr&gt;&lt;td colspan="2" rowspan="2"&gt;&lt;/td&gt;
&lt;td colspan="4"&gt;&lt;p&gt;Caffeine Intake&lt;/p&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;&lt;td colspan="2"&gt;&lt;p&gt;Low&lt;/p&gt;&lt;/td&gt;
&lt;td colspan="2"&gt;&lt;p&gt;High&lt;/p&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;&lt;td rowspan="4"&gt;&lt;p&gt;Calorie
Intake&lt;/p&gt;&lt;/td&gt;
&lt;td rowspan="2"&gt;&lt;p&gt;Low&lt;/p&gt;&lt;/td&gt;
&lt;td&gt;&lt;p&gt;Healthy&lt;/p&gt;&lt;/td&gt;
&lt;td&gt;&lt;p&gt;Overweight&lt;/p&gt;&lt;/td&gt;
&lt;td&gt;&lt;p&gt;Healthy&lt;/p&gt;&lt;/td&gt;
&lt;td&gt;&lt;p&gt;Overweight&lt;/p&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;&lt;p&gt;63&lt;/p&gt;&lt;/td&gt;
&lt;td&gt;&lt;p&gt;7&lt;/p&gt;&lt;/td&gt;
&lt;td&gt;&lt;p&gt;3&lt;/p&gt;&lt;/td&gt;
&lt;td&gt;&lt;p&gt;2&lt;/p&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;&lt;td rowspan="2"&gt;&lt;p&gt;High&lt;/p&gt;&lt;/td&gt;
&lt;td&gt;&lt;p&gt;Healthy&lt;/p&gt;&lt;/td&gt;
&lt;td&gt;&lt;p&gt;Overweight&lt;/p&gt;&lt;/td&gt;
&lt;td&gt;&lt;p&gt;Healthy&lt;/p&gt;&lt;/td&gt;
&lt;td&gt;&lt;p&gt;Overweight&lt;/p&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;&lt;p&gt;2&lt;/p&gt;&lt;/td&gt;
&lt;td&gt;&lt;p&gt;3&lt;/p&gt;&lt;/td&gt;
&lt;td&gt;&lt;p&gt;5&lt;/p&gt;&lt;/td&gt;
&lt;td&gt;&lt;p&gt;15&lt;/p&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;Note that 68% of the high caffeine group is overweight, while only 13% of the
low caffeine group is, but we note that calorie intake may be an issue so let
us perform logistic regression as the authors did, letting
&lt;span class="raw-html"&gt;\[\mathrm{Pr}(\mathrm{Overweight}) = 1/(1+ \mathrm{exp}(-\beta_0
- \beta_1 \times \mathrm{HighCalorie} - \beta_2 \times \mathrm{HighCaffeine})) \mathrm{ ,}\]&lt;/span&gt;
where &lt;span class="raw-html"&gt;\(\beta_0\)&lt;/span&gt; is the intercept, &lt;span class="raw-html"&gt;\(\beta_1\)&lt;/span&gt; is the
log odds due to calories and &lt;span class="raw-html"&gt;\(\beta_2\)&lt;/span&gt; is the log odds due to
caffeine. Setting the intercept at its maximum likelihood value, the maximum
likelihood values for the other parameters are shown as the cross below, which
attributes roughly equal importance to the two factors:&lt;/p&gt;
&lt;img alt="Likelihood surface" src="https://personalpages.manchester.ac.uk/staff/thomas.house/likelihood.png" style="width: 400px;"&gt;
&lt;p&gt;Behind this cross is a shaded region with intensity equal to the likelihood of
different parameter combinations - and we note that there is still a reasonable
amount of shading in the area where &lt;span class="raw-html"&gt;\(\beta_2 \approx 0\)&lt;/span&gt;. This is
a special case of a general phenomenon called weak identifiability, and it is
something &lt;a class="reference external" href="http://rsif.royalsocietypublishing.org/content/13/121/20160279/"&gt;I've done a bit of work on&lt;/a&gt; - there
are various ways to deal with this, but its presence is the reason that
evidence for a causal effect is weak in the original study.&lt;/p&gt;&lt;/body&gt;&lt;/html&gt;

&lt;blockquote&gt;
&lt;p&gt;"This study makes the headline claim that in a population of over 50,000
mother-child pairs, caffeine intake is positively associated with risk of
childhood obesity.  Let us make a ‚Äòback of the envelope‚Äô calculation on one
of the outcome measures using the cup of instant coffee per day as a measure
of the mother‚Äôs caffeine intake.&lt;/p&gt;
&lt;p&gt;If we take 100 children whose mother group had the lowest caffeine intake (1
cup or less) then at age three, around 11 will be obese; in the next group
(1-4 cups) there will be one additional obese child (12 in total); in the
next (4-6 cups) there will be an additional two (14 in total) and in the
group with highest caffeine intake (6 or more cups) there will be an
additional three (17 in total).&lt;/p&gt;
&lt;p&gt;The main problem with the study is that
maternal caffeine intake is strongly correlated with other relevant factors,
and so these should be controlled for.  In the authors‚Äô statistical analyses,
the ‚Äòbest fit‚Äô models they‚Äôve used suggest around half of the additional
cases of obesity in children of age 3 are explained by caffeine rather than,
say, calorie intake of mothers.  But since the caffeine and calorie intake
are correlated, the existence of a ‚Äòbest fit‚Äô model with equal weighting on
both means we actually can‚Äôt say whether a model looking at just calorie
intake of mothers would be an equally good explanation of child obesity.  It
also says nothing about whether including a new explanatory measure, such as
the child‚Äôs calorie intake, would change the model.&lt;/p&gt;
&lt;p&gt;As such, the evidence
provided in the study for a causal effect is extremely weak and the statement
from the authors that 'complete avoidance might actually be advisable' seems
unjustified, particularly when we consider the effects that such a
restriction might have on wellbeing of mothers."&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;This story was quite widely covered, but most papers took the same approach as
&lt;a class="reference external" href="https://inews.co.uk/news/health/pregnant-women-babies-caffeine-consumption-overweight/"&gt;iNews&lt;/a&gt;
and only quoted my main conclusion, but not the reasoning.&lt;/p&gt;
&lt;p&gt;So let's consider a simple exaple that exhibits the main problem, in particular
the following contingency table. This is much smaller than the original study,
but the same phenomenon is exhibited by larger populations with more
explanatory factors:&lt;/p&gt;
&lt;table&gt;
&lt;tbody&gt;
&lt;tr&gt;&lt;td colspan="2" rowspan="2"&gt;&lt;/td&gt;
&lt;td colspan="4"&gt;&lt;p&gt;Caffeine Intake&lt;/p&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;&lt;td colspan="2"&gt;&lt;p&gt;Low&lt;/p&gt;&lt;/td&gt;
&lt;td colspan="2"&gt;&lt;p&gt;High&lt;/p&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;&lt;td rowspan="4"&gt;&lt;p&gt;Calorie
Intake&lt;/p&gt;&lt;/td&gt;
&lt;td rowspan="2"&gt;&lt;p&gt;Low&lt;/p&gt;&lt;/td&gt;
&lt;td&gt;&lt;p&gt;Healthy&lt;/p&gt;&lt;/td&gt;
&lt;td&gt;&lt;p&gt;Overweight&lt;/p&gt;&lt;/td&gt;
&lt;td&gt;&lt;p&gt;Healthy&lt;/p&gt;&lt;/td&gt;
&lt;td&gt;&lt;p&gt;Overweight&lt;/p&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;&lt;p&gt;63&lt;/p&gt;&lt;/td&gt;
&lt;td&gt;&lt;p&gt;7&lt;/p&gt;&lt;/td&gt;
&lt;td&gt;&lt;p&gt;3&lt;/p&gt;&lt;/td&gt;
&lt;td&gt;&lt;p&gt;2&lt;/p&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;&lt;td rowspan="2"&gt;&lt;p&gt;High&lt;/p&gt;&lt;/td&gt;
&lt;td&gt;&lt;p&gt;Healthy&lt;/p&gt;&lt;/td&gt;
&lt;td&gt;&lt;p&gt;Overweight&lt;/p&gt;&lt;/td&gt;
&lt;td&gt;&lt;p&gt;Healthy&lt;/p&gt;&lt;/td&gt;
&lt;td&gt;&lt;p&gt;Overweight&lt;/p&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;&lt;p&gt;2&lt;/p&gt;&lt;/td&gt;
&lt;td&gt;&lt;p&gt;3&lt;/p&gt;&lt;/td&gt;
&lt;td&gt;&lt;p&gt;5&lt;/p&gt;&lt;/td&gt;
&lt;td&gt;&lt;p&gt;15&lt;/p&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;Note that 68% of the high caffeine group is overweight, while only 13% of the
low caffeine group is, but we note that calorie intake may be an issue so let
us perform logistic regression as the authors did, letting
&lt;span class="raw-html"&gt;\[\mathrm{Pr}(\mathrm{Overweight}) = 1/(1+ \mathrm{exp}(-\beta_0
- \beta_1 \times \mathrm{HighCalorie} - \beta_2 \times \mathrm{HighCaffeine})) \mathrm{ ,}\]&lt;/span&gt;
where &lt;span class="raw-html"&gt;\(\beta_0\)&lt;/span&gt; is the intercept, &lt;span class="raw-html"&gt;\(\beta_1\)&lt;/span&gt; is the
log odds due to calories and &lt;span class="raw-html"&gt;\(\beta_2\)&lt;/span&gt; is the log odds due to
caffeine. Setting the intercept at its maximum likelihood value, the maximum
likelihood values for the other parameters are shown as the cross below, which
attributes roughly equal importance to the two factors:&lt;/p&gt;
&lt;img alt="Likelihood surface" src="https://personalpages.manchester.ac.uk/staff/thomas.house/likelihood.png" style="width: 400px;"&gt;
&lt;p&gt;Behind this cross is a shaded region with intensity equal to the likelihood of
different parameter combinations - and we note that there is still a reasonable
amount of shading in the area where &lt;span class="raw-html"&gt;\(\beta_2 \approx 0\)&lt;/span&gt;. This is
a special case of a general phenomenon called weak identifiability, and it is
something &lt;a class="reference external" href="http://rsif.royalsocietypublishing.org/content/13/121/20160279/"&gt;I've done a bit of work on&lt;/a&gt; - there
are various ways to deal with this, but its presence is the reason that
evidence for a causal effect is weak in the original study.&lt;/p&gt;&lt;/body&gt;&lt;/html&gt;

&lt;p&gt;This story was quite widely covered, but most papers took the same approach as
&lt;a class="reference external" href="https://inews.co.uk/news/health/pregnant-women-babies-caffeine-consumption-overweight/"&gt;iNews&lt;/a&gt;
and only quoted my main conclusion, but not the reasoning.&lt;/p&gt;
&lt;p&gt;So let's consider a simple exaple that exhibits the main problem, in particular
the following contingency table. This is much smaller than the original study,
but the same phenomenon is exhibited by larger populations with more
explanatory factors:&lt;/p&gt;
&lt;table&gt;
&lt;tbody&gt;
&lt;tr&gt;&lt;td colspan="2" rowspan="2"&gt;&lt;/td&gt;
&lt;td colspan="4"&gt;&lt;p&gt;Caffeine Intake&lt;/p&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;&lt;td colspan="2"&gt;&lt;p&gt;Low&lt;/p&gt;&lt;/td&gt;
&lt;td colspan="2"&gt;&lt;p&gt;High&lt;/p&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;&lt;td rowspan="4"&gt;&lt;p&gt;Calorie
Intake&lt;/p&gt;&lt;/td&gt;
&lt;td rowspan="2"&gt;&lt;p&gt;Low&lt;/p&gt;&lt;/td&gt;
&lt;td&gt;&lt;p&gt;Healthy&lt;/p&gt;&lt;/td&gt;
&lt;td&gt;&lt;p&gt;Overweight&lt;/p&gt;&lt;/td&gt;
&lt;td&gt;&lt;p&gt;Healthy&lt;/p&gt;&lt;/td&gt;
&lt;td&gt;&lt;p&gt;Overweight&lt;/p&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;&lt;p&gt;63&lt;/p&gt;&lt;/td&gt;
&lt;td&gt;&lt;p&gt;7&lt;/p&gt;&lt;/td&gt;
&lt;td&gt;&lt;p&gt;3&lt;/p&gt;&lt;/td&gt;
&lt;td&gt;&lt;p&gt;2&lt;/p&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;&lt;td rowspan="2"&gt;&lt;p&gt;High&lt;/p&gt;&lt;/td&gt;
&lt;td&gt;&lt;p&gt;Healthy&lt;/p&gt;&lt;/td&gt;
&lt;td&gt;&lt;p&gt;Overweight&lt;/p&gt;&lt;/td&gt;
&lt;td&gt;&lt;p&gt;Healthy&lt;/p&gt;&lt;/td&gt;
&lt;td&gt;&lt;p&gt;Overweight&lt;/p&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;&lt;p&gt;2&lt;/p&gt;&lt;/td&gt;
&lt;td&gt;&lt;p&gt;3&lt;/p&gt;&lt;/td&gt;
&lt;td&gt;&lt;p&gt;5&lt;/p&gt;&lt;/td&gt;
&lt;td&gt;&lt;p&gt;15&lt;/p&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;Note that 68% of the high caffeine group is overweight, while only 13% of the
low caffeine group is, but we note that calorie intake may be an issue so let
us perform logistic regression as the authors did, letting
&lt;span class="raw-html"&gt;\[\mathrm{Pr}(\mathrm{Overweight}) = 1/(1+ \mathrm{exp}(-\beta_0
- \beta_1 \times \mathrm{HighCalorie} - \beta_2 \times \mathrm{HighCaffeine})) \mathrm{ ,}\]&lt;/span&gt;
where &lt;span class="raw-html"&gt;\(\beta_0\)&lt;/span&gt; is the intercept, &lt;span class="raw-html"&gt;\(\beta_1\)&lt;/span&gt; is the
log odds due to calories and &lt;span class="raw-html"&gt;\(\beta_2\)&lt;/span&gt; is the log odds due to
caffeine. Setting the intercept at its maximum likelihood value, the maximum
likelihood values for the other parameters are shown as the cross below, which
attributes roughly equal importance to the two factors:&lt;/p&gt;
&lt;img alt="Likelihood surface" src="https://personalpages.manchester.ac.uk/staff/thomas.house/likelihood.png" style="width: 400px;"&gt;
&lt;p&gt;Behind this cross is a shaded region with intensity equal to the likelihood of
different parameter combinations - and we note that there is still a reasonable
amount of shading in the area where &lt;span class="raw-html"&gt;\(\beta_2 \approx 0\)&lt;/span&gt;. This is
a special case of a general phenomenon called weak identifiability, and it is
something &lt;a class="reference external" href="http://rsif.royalsocietypublishing.org/content/13/121/20160279/"&gt;I've done a bit of work on&lt;/a&gt; - there
are various ways to deal with this, but its presence is the reason that
evidence for a causal effect is weak in the original study.&lt;/p&gt;&lt;/body&gt;&lt;/html&gt;

&lt;p&gt;So let's consider a simple exaple that exhibits the main problem, in particular
the following contingency table. This is much smaller than the original study,
but the same phenomenon is exhibited by larger populations with more
explanatory factors:&lt;/p&gt;
&lt;table&gt;
&lt;tbody&gt;
&lt;tr&gt;&lt;td colspan="2" rowspan="2"&gt;&lt;/td&gt;
&lt;td colspan="4"&gt;&lt;p&gt;Caffeine Intake&lt;/p&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;&lt;td colspan="2"&gt;&lt;p&gt;Low&lt;/p&gt;&lt;/td&gt;
&lt;td colspan="2"&gt;&lt;p&gt;High&lt;/p&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;&lt;td rowspan="4"&gt;&lt;p&gt;Calorie
Intake&lt;/p&gt;&lt;/td&gt;
&lt;td rowspan="2"&gt;&lt;p&gt;Low&lt;/p&gt;&lt;/td&gt;
&lt;td&gt;&lt;p&gt;Healthy&lt;/p&gt;&lt;/td&gt;
&lt;td&gt;&lt;p&gt;Overweight&lt;/p&gt;&lt;/td&gt;
&lt;td&gt;&lt;p&gt;Healthy&lt;/p&gt;&lt;/td&gt;
&lt;td&gt;&lt;p&gt;Overweight&lt;/p&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;&lt;p&gt;63&lt;/p&gt;&lt;/td&gt;
&lt;td&gt;&lt;p&gt;7&lt;/p&gt;&lt;/td&gt;
&lt;td&gt;&lt;p&gt;3&lt;/p&gt;&lt;/td&gt;
&lt;td&gt;&lt;p&gt;2&lt;/p&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;&lt;td rowspan="2"&gt;&lt;p&gt;High&lt;/p&gt;&lt;/td&gt;
&lt;td&gt;&lt;p&gt;Healthy&lt;/p&gt;&lt;/td&gt;
&lt;td&gt;&lt;p&gt;Overweight&lt;/p&gt;&lt;/td&gt;
&lt;td&gt;&lt;p&gt;Healthy&lt;/p&gt;&lt;/td&gt;
&lt;td&gt;&lt;p&gt;Overweight&lt;/p&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;&lt;p&gt;2&lt;/p&gt;&lt;/td&gt;
&lt;td&gt;&lt;p&gt;3&lt;/p&gt;&lt;/td&gt;
&lt;td&gt;&lt;p&gt;5&lt;/p&gt;&lt;/td&gt;
&lt;td&gt;&lt;p&gt;15&lt;/p&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;Note that 68% of the high caffeine group is overweight, while only 13% of the
low caffeine group is, but we note that calorie intake may be an issue so let
us perform logistic regression as the authors did, letting
&lt;span class="raw-html"&gt;\[\mathrm{Pr}(\mathrm{Overweight}) = 1/(1+ \mathrm{exp}(-\beta_0
- \beta_1 \times \mathrm{HighCalorie} - \beta_2 \times \mathrm{HighCaffeine})) \mathrm{ ,}\]&lt;/span&gt;
where &lt;span class="raw-html"&gt;\(\beta_0\)&lt;/span&gt; is the intercept, &lt;span class="raw-html"&gt;\(\beta_1\)&lt;/span&gt; is the
log odds due to calories and &lt;span class="raw-html"&gt;\(\beta_2\)&lt;/span&gt; is the log odds due to
caffeine. Setting the intercept at its maximum likelihood value, the maximum
likelihood values for the other parameters are shown as the cross below, which
attributes roughly equal importance to the two factors:&lt;/p&gt;
&lt;img alt="Likelihood surface" src="https://personalpages.manchester.ac.uk/staff/thomas.house/likelihood.png" style="width: 400px;"&gt;
&lt;p&gt;Behind this cross is a shaded region with intensity equal to the likelihood of
different parameter combinations - and we note that there is still a reasonable
amount of shading in the area where &lt;span class="raw-html"&gt;\(\beta_2 \approx 0\)&lt;/span&gt;. This is
a special case of a general phenomenon called weak identifiability, and it is
something &lt;a class="reference external" href="http://rsif.royalsocietypublishing.org/content/13/121/20160279/"&gt;I've done a bit of work on&lt;/a&gt; - there
are various ways to deal with this, but its presence is the reason that
evidence for a causal effect is weak in the original study.&lt;/p&gt;&lt;/body&gt;&lt;/html&gt;

&lt;table&gt;
&lt;tbody&gt;
&lt;tr&gt;&lt;td colspan="2" rowspan="2"&gt;&lt;/td&gt;
&lt;td colspan="4"&gt;&lt;p&gt;Caffeine Intake&lt;/p&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;&lt;td colspan="2"&gt;&lt;p&gt;Low&lt;/p&gt;&lt;/td&gt;
&lt;td colspan="2"&gt;&lt;p&gt;High&lt;/p&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;&lt;td rowspan="4"&gt;&lt;p&gt;Calorie
Intake&lt;/p&gt;&lt;/td&gt;
&lt;td rowspan="2"&gt;&lt;p&gt;Low&lt;/p&gt;&lt;/td&gt;
&lt;td&gt;&lt;p&gt;Healthy&lt;/p&gt;&lt;/td&gt;
&lt;td&gt;&lt;p&gt;Overweight&lt;/p&gt;&lt;/td&gt;
&lt;td&gt;&lt;p&gt;Healthy&lt;/p&gt;&lt;/td&gt;
&lt;td&gt;&lt;p&gt;Overweight&lt;/p&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;&lt;p&gt;63&lt;/p&gt;&lt;/td&gt;
&lt;td&gt;&lt;p&gt;7&lt;/p&gt;&lt;/td&gt;
&lt;td&gt;&lt;p&gt;3&lt;/p&gt;&lt;/td&gt;
&lt;td&gt;&lt;p&gt;2&lt;/p&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;&lt;td rowspan="2"&gt;&lt;p&gt;High&lt;/p&gt;&lt;/td&gt;
&lt;td&gt;&lt;p&gt;Healthy&lt;/p&gt;&lt;/td&gt;
&lt;td&gt;&lt;p&gt;Overweight&lt;/p&gt;&lt;/td&gt;
&lt;td&gt;&lt;p&gt;Healthy&lt;/p&gt;&lt;/td&gt;
&lt;td&gt;&lt;p&gt;Overweight&lt;/p&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;&lt;p&gt;2&lt;/p&gt;&lt;/td&gt;
&lt;td&gt;&lt;p&gt;3&lt;/p&gt;&lt;/td&gt;
&lt;td&gt;&lt;p&gt;5&lt;/p&gt;&lt;/td&gt;
&lt;td&gt;&lt;p&gt;15&lt;/p&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;Note that 68% of the high caffeine group is overweight, while only 13% of the
low caffeine group is, but we note that calorie intake may be an issue so let
us perform logistic regression as the authors did, letting
&lt;span class="raw-html"&gt;\[\mathrm{Pr}(\mathrm{Overweight}) = 1/(1+ \mathrm{exp}(-\beta_0
- \beta_1 \times \mathrm{HighCalorie} - \beta_2 \times \mathrm{HighCaffeine})) \mathrm{ ,}\]&lt;/span&gt;
where &lt;span class="raw-html"&gt;\(\beta_0\)&lt;/span&gt; is the intercept, &lt;span class="raw-html"&gt;\(\beta_1\)&lt;/span&gt; is the
log odds due to calories and &lt;span class="raw-html"&gt;\(\beta_2\)&lt;/span&gt; is the log odds due to
caffeine. Setting the intercept at its maximum likelihood value, the maximum
likelihood values for the other parameters are shown as the cross below, which
attributes roughly equal importance to the two factors:&lt;/p&gt;
&lt;img alt="Likelihood surface" src="https://personalpages.manchester.ac.uk/staff/thomas.house/likelihood.png" style="width: 400px;"&gt;
&lt;p&gt;Behind this cross is a shaded region with intensity equal to the likelihood of
different parameter combinations - and we note that there is still a reasonable
amount of shading in the area where &lt;span class="raw-html"&gt;\(\beta_2 \approx 0\)&lt;/span&gt;. This is
a special case of a general phenomenon called weak identifiability, and it is
something &lt;a class="reference external" href="http://rsif.royalsocietypublishing.org/content/13/121/20160279/"&gt;I've done a bit of work on&lt;/a&gt; - there
are various ways to deal with this, but its presence is the reason that
evidence for a causal effect is weak in the original study.&lt;/p&gt;&lt;/body&gt;&lt;/html&gt;

&lt;p&gt;Note that 68% of the high caffeine group is overweight, while only 13% of the
low caffeine group is, but we note that calorie intake may be an issue so let
us perform logistic regression as the authors did, letting
&lt;span class="raw-html"&gt;\[\mathrm{Pr}(\mathrm{Overweight}) = 1/(1+ \mathrm{exp}(-\beta_0
- \beta_1 \times \mathrm{HighCalorie} - \beta_2 \times \mathrm{HighCaffeine})) \mathrm{ ,}\]&lt;/span&gt;
where &lt;span class="raw-html"&gt;\(\beta_0\)&lt;/span&gt; is the intercept, &lt;span class="raw-html"&gt;\(\beta_1\)&lt;/span&gt; is the
log odds due to calories and &lt;span class="raw-html"&gt;\(\beta_2\)&lt;/span&gt; is the log odds due to
caffeine. Setting the intercept at its maximum likelihood value, the maximum
likelihood values for the other parameters are shown as the cross below, which
attributes roughly equal importance to the two factors:&lt;/p&gt;
&lt;img alt="Likelihood surface" src="https://personalpages.manchester.ac.uk/staff/thomas.house/likelihood.png" style="width: 400px;"&gt;
&lt;p&gt;Behind this cross is a shaded region with intensity equal to the likelihood of
different parameter combinations - and we note that there is still a reasonable
amount of shading in the area where &lt;span class="raw-html"&gt;\(\beta_2 \approx 0\)&lt;/span&gt;. This is
a special case of a general phenomenon called weak identifiability, and it is
something &lt;a class="reference external" href="http://rsif.royalsocietypublishing.org/content/13/121/20160279/"&gt;I've done a bit of work on&lt;/a&gt; - there
are various ways to deal with this, but its presence is the reason that
evidence for a causal effect is weak in the original study.&lt;/p&gt;&lt;/body&gt;&lt;/html&gt;

&lt;img alt="Likelihood surface" src="https://personalpages.manchester.ac.uk/staff/thomas.house/likelihood.png" style="width: 400px;"&gt;
&lt;p&gt;Behind this cross is a shaded region with intensity equal to the likelihood of
different parameter combinations - and we note that there is still a reasonable
amount of shading in the area where &lt;span class="raw-html"&gt;\(\beta_2 \approx 0\)&lt;/span&gt;. This is
a special case of a general phenomenon called weak identifiability, and it is
something &lt;a class="reference external" href="http://rsif.royalsocietypublishing.org/content/13/121/20160279/"&gt;I've done a bit of work on&lt;/a&gt; - there
are various ways to deal with this, but its presence is the reason that
evidence for a causal effect is weak in the original study.&lt;/p&gt;&lt;/body&gt;&lt;/html&gt;
</description><guid>https://personalpages.manchester.ac.uk/staff/thomas.house/posts/caffeine-in-pregnancy-weak-identifiability-and-working-with-the-media.html</guid><pubDate>Wed, 25 Apr 2018 12:19:27 GMT</pubDate></item><item><title>Visualising the Wishart Distribution</title><link>https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html</link><dc:creator>Thomas House</dc:creator><description>&lt;p&gt;This semester, I have been teaching Multivariate Statistics, and one isse that comes up is how to think
about the Wishart distribution, which generalises the &lt;span class="raw-html"&gt;\(\chi^2 \)&lt;/span&gt; distribution. This has
probability density function&lt;/p&gt;
&lt;p&gt;&lt;span class="raw-html"&gt;$$ f_{\chi^2_k}(x) = \frac{1}{2\,\Gamma\!\left(\frac{k}{2}\right)} \left(\frac{x}{2}\right)^{\frac{k}{2}-1} {\rm e}^{-\frac{x}{2}} . $$&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;To visualise this at different degrees of freedom &lt;span class="raw-html"&gt;\(k \)&lt;/span&gt;, we use the following Python code.&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code ipython3"&gt;&lt;a id="rest_code_81efedfac39441e3b3ff970c0031d6ad-1" name="rest_code_81efedfac39441e3b3ff970c0031d6ad-1" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_81efedfac39441e3b3ff970c0031d6ad-1"&gt;&lt;/a&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="k"&gt;matplotlib&lt;/span&gt; inline
&lt;a id="rest_code_81efedfac39441e3b3ff970c0031d6ad-2" name="rest_code_81efedfac39441e3b3ff970c0031d6ad-2" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_81efedfac39441e3b3ff970c0031d6ad-2"&gt;&lt;/a&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;numpy&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;np&lt;/span&gt;
&lt;a id="rest_code_81efedfac39441e3b3ff970c0031d6ad-3" name="rest_code_81efedfac39441e3b3ff970c0031d6ad-3" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_81efedfac39441e3b3ff970c0031d6ad-3"&gt;&lt;/a&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;scipy.stats&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;st&lt;/span&gt;
&lt;a id="rest_code_81efedfac39441e3b3ff970c0031d6ad-4" name="rest_code_81efedfac39441e3b3ff970c0031d6ad-4" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_81efedfac39441e3b3ff970c0031d6ad-4"&gt;&lt;/a&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;matplotlib.pyplot&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;plt&lt;/span&gt;
&lt;a id="rest_code_81efedfac39441e3b3ff970c0031d6ad-5" name="rest_code_81efedfac39441e3b3ff970c0031d6ad-5" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_81efedfac39441e3b3ff970c0031d6ad-5"&gt;&lt;/a&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;mpl_toolkits.mplot3d&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;Axes3D&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="code"&gt;&lt;pre class="code ipython3"&gt;&lt;a id="rest_code_3d31a68eeecd430b9d94ef668b0d27bf-1" name="rest_code_3d31a68eeecd430b9d94ef668b0d27bf-1" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_3d31a68eeecd430b9d94ef668b0d27bf-1"&gt;&lt;/a&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;random&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;seed&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;42&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_3d31a68eeecd430b9d94ef668b0d27bf-2" name="rest_code_3d31a68eeecd430b9d94ef668b0d27bf-2" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_3d31a68eeecd430b9d94ef668b0d27bf-2"&gt;&lt;/a&gt;&lt;span class="n"&gt;Sig1&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;array&lt;/span&gt;&lt;span class="p"&gt;([[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mf"&gt;0.75&lt;/span&gt;&lt;span class="p"&gt;],[&lt;/span&gt;&lt;span class="mf"&gt;0.75&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;]])&lt;/span&gt;
&lt;a id="rest_code_3d31a68eeecd430b9d94ef668b0d27bf-3" name="rest_code_3d31a68eeecd430b9d94ef668b0d27bf-3" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_3d31a68eeecd430b9d94ef668b0d27bf-3"&gt;&lt;/a&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;1000&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="code"&gt;&lt;pre class="code ipython3"&gt;&lt;a id="rest_code_cc3ae6870b534a5eb55e0d2447174adb-1" name="rest_code_cc3ae6870b534a5eb55e0d2447174adb-1" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_cc3ae6870b534a5eb55e0d2447174adb-1"&gt;&lt;/a&gt;&lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;linspace&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1000&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_cc3ae6870b534a5eb55e0d2447174adb-2" name="rest_code_cc3ae6870b534a5eb55e0d2447174adb-2" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_cc3ae6870b534a5eb55e0d2447174adb-2"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;figure&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;figsize&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;8&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_cc3ae6870b534a5eb55e0d2447174adb-3" name="rest_code_cc3ae6870b534a5eb55e0d2447174adb-3" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_cc3ae6870b534a5eb55e0d2447174adb-3"&gt;&lt;/a&gt;&lt;span class="n"&gt;colors&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;cm&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Accent&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;linspace&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_cc3ae6870b534a5eb55e0d2447174adb-4" name="rest_code_cc3ae6870b534a5eb55e0d2447174adb-4" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_cc3ae6870b534a5eb55e0d2447174adb-4"&gt;&lt;/a&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;
&lt;a id="rest_code_cc3ae6870b534a5eb55e0d2447174adb-5" name="rest_code_cc3ae6870b534a5eb55e0d2447174adb-5" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_cc3ae6870b534a5eb55e0d2447174adb-5"&gt;&lt;/a&gt;&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;k&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_cc3ae6870b534a5eb55e0d2447174adb-6" name="rest_code_cc3ae6870b534a5eb55e0d2447174adb-6" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_cc3ae6870b534a5eb55e0d2447174adb-6"&gt;&lt;/a&gt;    &lt;span class="n"&gt;c&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;st&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;chi2&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;pdf&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;k&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;a id="rest_code_cc3ae6870b534a5eb55e0d2447174adb-7" name="rest_code_cc3ae6870b534a5eb55e0d2447174adb-7" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_cc3ae6870b534a5eb55e0d2447174adb-7"&gt;&lt;/a&gt;    &lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;plot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;c&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;label&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'k = '&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="nb"&gt;str&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;k&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;color&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;colors&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;&lt;span class="n"&gt;linewidth&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_cc3ae6870b534a5eb55e0d2447174adb-8" name="rest_code_cc3ae6870b534a5eb55e0d2447174adb-8" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_cc3ae6870b534a5eb55e0d2447174adb-8"&gt;&lt;/a&gt;    &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;+=&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;
&lt;a id="rest_code_cc3ae6870b534a5eb55e0d2447174adb-9" name="rest_code_cc3ae6870b534a5eb55e0d2447174adb-9" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_cc3ae6870b534a5eb55e0d2447174adb-9"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xlim&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_cc3ae6870b534a5eb55e0d2447174adb-10" name="rest_code_cc3ae6870b534a5eb55e0d2447174adb-10" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_cc3ae6870b534a5eb55e0d2447174adb-10"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ylim&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mf"&gt;0.5&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_cc3ae6870b534a5eb55e0d2447174adb-11" name="rest_code_cc3ae6870b534a5eb55e0d2447174adb-11" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_cc3ae6870b534a5eb55e0d2447174adb-11"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'x'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_cc3ae6870b534a5eb55e0d2447174adb-12" name="rest_code_cc3ae6870b534a5eb55e0d2447174adb-12" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_cc3ae6870b534a5eb55e0d2447174adb-12"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ylabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'f(x)'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_cc3ae6870b534a5eb55e0d2447174adb-13" name="rest_code_cc3ae6870b534a5eb55e0d2447174adb-13" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_cc3ae6870b534a5eb55e0d2447174adb-13"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;legend&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;img alt="../output_2_1.png" src="https://personalpages.manchester.ac.uk/staff/thomas.house/output_2_1.png"&gt;
&lt;p&gt;The Wishart emerges when we make &lt;span class="raw-html"&gt;\(k \)&lt;/span&gt; observations each with &lt;span class="raw-html"&gt;\(p \)&lt;/span&gt; variables; the
sampling distribution for the covariance matrix of these data if the population is multivariate normal is
Wishart and has probability density function&lt;/p&gt;
&lt;p&gt;&lt;span class="raw-html"&gt;$$ f_{\mathcal{W}_p(k,\boldsymbol{\Sigma})}(\boldsymbol{V}) = \frac{\mathrm{det}(\boldsymbol{V})^{\frac{k - p - 1}{2}}}{2^{ \frac{k p}{2} } \mathrm{det}(\boldsymbol{\Sigma})^\frac{k}{2} \Gamma_p\!\left(\frac{k}{2} \right)} \exp\left( -\frac12 \mathrm{Tr}(\boldsymbol{\Sigma}^{-1} \boldsymbol{V}) \right) . $$&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;In general, this cannot be visualised, but for the &lt;span class="raw-html"&gt;\(p=2 \)&lt;/span&gt; case, one option is to pick random
numbers from this distribution and then produce a three-dimensional scatter plot of these. The code and results
below show that this can be seen as behaving somewhat like the chi-squared distribution that it generalises as
the degrees of freedom &lt;span class="raw-html"&gt;\(k \)&lt;/span&gt; are increased.&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code ipython3"&gt;&lt;a id="rest_code_2a204a6d0b0b40ddb307802c80ca763c-1" name="rest_code_2a204a6d0b0b40ddb307802c80ca763c-1" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_2a204a6d0b0b40ddb307802c80ca763c-1"&gt;&lt;/a&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_2a204a6d0b0b40ddb307802c80ca763c-2" name="rest_code_2a204a6d0b0b40ddb307802c80ca763c-2" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_2a204a6d0b0b40ddb307802c80ca763c-2"&gt;&lt;/a&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_2a204a6d0b0b40ddb307802c80ca763c-3" name="rest_code_2a204a6d0b0b40ddb307802c80ca763c-3" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_2a204a6d0b0b40ddb307802c80ca763c-3"&gt;&lt;/a&gt;&lt;span class="n"&gt;z&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_2a204a6d0b0b40ddb307802c80ca763c-4" name="rest_code_2a204a6d0b0b40ddb307802c80ca763c-4" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_2a204a6d0b0b40ddb307802c80ca763c-4"&gt;&lt;/a&gt;&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_2a204a6d0b0b40ddb307802c80ca763c-5" name="rest_code_2a204a6d0b0b40ddb307802c80ca763c-5" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_2a204a6d0b0b40ddb307802c80ca763c-5"&gt;&lt;/a&gt;    &lt;span class="n"&gt;M&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;st&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;wishart&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;rvs&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;scale&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;Sig1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;size&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_2a204a6d0b0b40ddb307802c80ca763c-6" name="rest_code_2a204a6d0b0b40ddb307802c80ca763c-6" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_2a204a6d0b0b40ddb307802c80ca763c-6"&gt;&lt;/a&gt;    &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;M&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_2a204a6d0b0b40ddb307802c80ca763c-7" name="rest_code_2a204a6d0b0b40ddb307802c80ca763c-7" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_2a204a6d0b0b40ddb307802c80ca763c-7"&gt;&lt;/a&gt;    &lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;M&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_2a204a6d0b0b40ddb307802c80ca763c-8" name="rest_code_2a204a6d0b0b40ddb307802c80ca763c-8" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_2a204a6d0b0b40ddb307802c80ca763c-8"&gt;&lt;/a&gt;    &lt;span class="n"&gt;z&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;M&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_2a204a6d0b0b40ddb307802c80ca763c-9" name="rest_code_2a204a6d0b0b40ddb307802c80ca763c-9" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_2a204a6d0b0b40ddb307802c80ca763c-9"&gt;&lt;/a&gt;&lt;span class="n"&gt;fig&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;figure&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;figsize&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;8&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_2a204a6d0b0b40ddb307802c80ca763c-10" name="rest_code_2a204a6d0b0b40ddb307802c80ca763c-10" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_2a204a6d0b0b40ddb307802c80ca763c-10"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;fig&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;add_subplot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;111&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;projection&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'3d'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_2a204a6d0b0b40ddb307802c80ca763c-11" name="rest_code_2a204a6d0b0b40ddb307802c80ca763c-11" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_2a204a6d0b0b40ddb307802c80ca763c-11"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;scatter3D&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;z&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;marker&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'o'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;c&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;z&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;cmap&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'seismic'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_2a204a6d0b0b40ddb307802c80ca763c-12" name="rest_code_2a204a6d0b0b40ddb307802c80ca763c-12" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_2a204a6d0b0b40ddb307802c80ca763c-12"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_xlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'V11'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_2a204a6d0b0b40ddb307802c80ca763c-13" name="rest_code_2a204a6d0b0b40ddb307802c80ca763c-13" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_2a204a6d0b0b40ddb307802c80ca763c-13"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_ylabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'V22'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_2a204a6d0b0b40ddb307802c80ca763c-14" name="rest_code_2a204a6d0b0b40ddb307802c80ca763c-14" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_2a204a6d0b0b40ddb307802c80ca763c-14"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_zlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'V12=V21'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_2a204a6d0b0b40ddb307802c80ca763c-15" name="rest_code_2a204a6d0b0b40ddb307802c80ca763c-15" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_2a204a6d0b0b40ddb307802c80ca763c-15"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_xlim&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;30&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_2a204a6d0b0b40ddb307802c80ca763c-16" name="rest_code_2a204a6d0b0b40ddb307802c80ca763c-16" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_2a204a6d0b0b40ddb307802c80ca763c-16"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_ylim&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;70&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_2a204a6d0b0b40ddb307802c80ca763c-17" name="rest_code_2a204a6d0b0b40ddb307802c80ca763c-17" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_2a204a6d0b0b40ddb307802c80ca763c-17"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_zlim&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;30&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_2a204a6d0b0b40ddb307802c80ca763c-18" name="rest_code_2a204a6d0b0b40ddb307802c80ca763c-18" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_2a204a6d0b0b40ddb307802c80ca763c-18"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;tight_layout&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;img alt="../output_3_0.png" src="https://personalpages.manchester.ac.uk/staff/thomas.house/output_3_0.png"&gt;
&lt;div class="code"&gt;&lt;pre class="code ipython3"&gt;&lt;a id="rest_code_a676d237e9c8464d88906f5cf10f4924-1" name="rest_code_a676d237e9c8464d88906f5cf10f4924-1" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_a676d237e9c8464d88906f5cf10f4924-1"&gt;&lt;/a&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_a676d237e9c8464d88906f5cf10f4924-2" name="rest_code_a676d237e9c8464d88906f5cf10f4924-2" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_a676d237e9c8464d88906f5cf10f4924-2"&gt;&lt;/a&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_a676d237e9c8464d88906f5cf10f4924-3" name="rest_code_a676d237e9c8464d88906f5cf10f4924-3" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_a676d237e9c8464d88906f5cf10f4924-3"&gt;&lt;/a&gt;&lt;span class="n"&gt;z&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_a676d237e9c8464d88906f5cf10f4924-4" name="rest_code_a676d237e9c8464d88906f5cf10f4924-4" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_a676d237e9c8464d88906f5cf10f4924-4"&gt;&lt;/a&gt;&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_a676d237e9c8464d88906f5cf10f4924-5" name="rest_code_a676d237e9c8464d88906f5cf10f4924-5" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_a676d237e9c8464d88906f5cf10f4924-5"&gt;&lt;/a&gt;    &lt;span class="n"&gt;M&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;st&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;wishart&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;rvs&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;scale&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;Sig1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;size&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_a676d237e9c8464d88906f5cf10f4924-6" name="rest_code_a676d237e9c8464d88906f5cf10f4924-6" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_a676d237e9c8464d88906f5cf10f4924-6"&gt;&lt;/a&gt;    &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;M&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_a676d237e9c8464d88906f5cf10f4924-7" name="rest_code_a676d237e9c8464d88906f5cf10f4924-7" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_a676d237e9c8464d88906f5cf10f4924-7"&gt;&lt;/a&gt;    &lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;M&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_a676d237e9c8464d88906f5cf10f4924-8" name="rest_code_a676d237e9c8464d88906f5cf10f4924-8" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_a676d237e9c8464d88906f5cf10f4924-8"&gt;&lt;/a&gt;    &lt;span class="n"&gt;z&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;M&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_a676d237e9c8464d88906f5cf10f4924-9" name="rest_code_a676d237e9c8464d88906f5cf10f4924-9" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_a676d237e9c8464d88906f5cf10f4924-9"&gt;&lt;/a&gt;&lt;span class="n"&gt;fig&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;figure&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;figsize&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;8&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_a676d237e9c8464d88906f5cf10f4924-10" name="rest_code_a676d237e9c8464d88906f5cf10f4924-10" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_a676d237e9c8464d88906f5cf10f4924-10"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;fig&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;add_subplot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;111&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;projection&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'3d'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_a676d237e9c8464d88906f5cf10f4924-11" name="rest_code_a676d237e9c8464d88906f5cf10f4924-11" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_a676d237e9c8464d88906f5cf10f4924-11"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;scatter3D&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;z&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;marker&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'o'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;c&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;z&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;cmap&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'seismic'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_a676d237e9c8464d88906f5cf10f4924-12" name="rest_code_a676d237e9c8464d88906f5cf10f4924-12" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_a676d237e9c8464d88906f5cf10f4924-12"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_xlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'V11'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_a676d237e9c8464d88906f5cf10f4924-13" name="rest_code_a676d237e9c8464d88906f5cf10f4924-13" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_a676d237e9c8464d88906f5cf10f4924-13"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_ylabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'V22'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_a676d237e9c8464d88906f5cf10f4924-14" name="rest_code_a676d237e9c8464d88906f5cf10f4924-14" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_a676d237e9c8464d88906f5cf10f4924-14"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_zlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'V12=V21'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_a676d237e9c8464d88906f5cf10f4924-15" name="rest_code_a676d237e9c8464d88906f5cf10f4924-15" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_a676d237e9c8464d88906f5cf10f4924-15"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_xlim&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;30&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_a676d237e9c8464d88906f5cf10f4924-16" name="rest_code_a676d237e9c8464d88906f5cf10f4924-16" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_a676d237e9c8464d88906f5cf10f4924-16"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_ylim&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;70&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_a676d237e9c8464d88906f5cf10f4924-17" name="rest_code_a676d237e9c8464d88906f5cf10f4924-17" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_a676d237e9c8464d88906f5cf10f4924-17"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_zlim&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;30&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_a676d237e9c8464d88906f5cf10f4924-18" name="rest_code_a676d237e9c8464d88906f5cf10f4924-18" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_a676d237e9c8464d88906f5cf10f4924-18"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;tight_layout&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;img alt="../output_4_0.png" src="https://personalpages.manchester.ac.uk/staff/thomas.house/output_4_0.png"&gt;
&lt;div class="code"&gt;&lt;pre class="code ipython3"&gt;&lt;a id="rest_code_76116a44a2574bca8e27ed73d13dd183-1" name="rest_code_76116a44a2574bca8e27ed73d13dd183-1" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_76116a44a2574bca8e27ed73d13dd183-1"&gt;&lt;/a&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_76116a44a2574bca8e27ed73d13dd183-2" name="rest_code_76116a44a2574bca8e27ed73d13dd183-2" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_76116a44a2574bca8e27ed73d13dd183-2"&gt;&lt;/a&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_76116a44a2574bca8e27ed73d13dd183-3" name="rest_code_76116a44a2574bca8e27ed73d13dd183-3" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_76116a44a2574bca8e27ed73d13dd183-3"&gt;&lt;/a&gt;&lt;span class="n"&gt;z&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_76116a44a2574bca8e27ed73d13dd183-4" name="rest_code_76116a44a2574bca8e27ed73d13dd183-4" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_76116a44a2574bca8e27ed73d13dd183-4"&gt;&lt;/a&gt;&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_76116a44a2574bca8e27ed73d13dd183-5" name="rest_code_76116a44a2574bca8e27ed73d13dd183-5" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_76116a44a2574bca8e27ed73d13dd183-5"&gt;&lt;/a&gt;    &lt;span class="n"&gt;M&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;st&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;wishart&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;rvs&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;scale&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;Sig1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;size&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_76116a44a2574bca8e27ed73d13dd183-6" name="rest_code_76116a44a2574bca8e27ed73d13dd183-6" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_76116a44a2574bca8e27ed73d13dd183-6"&gt;&lt;/a&gt;    &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;M&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_76116a44a2574bca8e27ed73d13dd183-7" name="rest_code_76116a44a2574bca8e27ed73d13dd183-7" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_76116a44a2574bca8e27ed73d13dd183-7"&gt;&lt;/a&gt;    &lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;M&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_76116a44a2574bca8e27ed73d13dd183-8" name="rest_code_76116a44a2574bca8e27ed73d13dd183-8" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_76116a44a2574bca8e27ed73d13dd183-8"&gt;&lt;/a&gt;    &lt;span class="n"&gt;z&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;M&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_76116a44a2574bca8e27ed73d13dd183-9" name="rest_code_76116a44a2574bca8e27ed73d13dd183-9" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_76116a44a2574bca8e27ed73d13dd183-9"&gt;&lt;/a&gt;&lt;span class="n"&gt;fig&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;figure&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;figsize&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;8&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_76116a44a2574bca8e27ed73d13dd183-10" name="rest_code_76116a44a2574bca8e27ed73d13dd183-10" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_76116a44a2574bca8e27ed73d13dd183-10"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;fig&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;add_subplot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;111&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;projection&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'3d'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_76116a44a2574bca8e27ed73d13dd183-11" name="rest_code_76116a44a2574bca8e27ed73d13dd183-11" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_76116a44a2574bca8e27ed73d13dd183-11"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;scatter3D&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;z&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;marker&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'o'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;c&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;z&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;cmap&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'seismic'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_76116a44a2574bca8e27ed73d13dd183-12" name="rest_code_76116a44a2574bca8e27ed73d13dd183-12" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_76116a44a2574bca8e27ed73d13dd183-12"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_xlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'V11'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_76116a44a2574bca8e27ed73d13dd183-13" name="rest_code_76116a44a2574bca8e27ed73d13dd183-13" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_76116a44a2574bca8e27ed73d13dd183-13"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_ylabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'V22'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_76116a44a2574bca8e27ed73d13dd183-14" name="rest_code_76116a44a2574bca8e27ed73d13dd183-14" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_76116a44a2574bca8e27ed73d13dd183-14"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_zlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'V12=V21'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_76116a44a2574bca8e27ed73d13dd183-15" name="rest_code_76116a44a2574bca8e27ed73d13dd183-15" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_76116a44a2574bca8e27ed73d13dd183-15"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_xlim&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;30&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_76116a44a2574bca8e27ed73d13dd183-16" name="rest_code_76116a44a2574bca8e27ed73d13dd183-16" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_76116a44a2574bca8e27ed73d13dd183-16"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_ylim&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;70&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_76116a44a2574bca8e27ed73d13dd183-17" name="rest_code_76116a44a2574bca8e27ed73d13dd183-17" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_76116a44a2574bca8e27ed73d13dd183-17"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_zlim&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;30&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_76116a44a2574bca8e27ed73d13dd183-18" name="rest_code_76116a44a2574bca8e27ed73d13dd183-18" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_76116a44a2574bca8e27ed73d13dd183-18"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;tight_layout&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;img alt="../output_5_0.png" src="https://personalpages.manchester.ac.uk/staff/thomas.house/output_5_0.png"&gt;&lt;/body&gt;&lt;/html&gt;

&lt;p&gt;&lt;span class="raw-html"&gt;$$ f_{\chi^2_k}(x) = \frac{1}{2\,\Gamma\!\left(\frac{k}{2}\right)} \left(\frac{x}{2}\right)^{\frac{k}{2}-1} {\rm e}^{-\frac{x}{2}} . $$&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;To visualise this at different degrees of freedom &lt;span class="raw-html"&gt;\(k \)&lt;/span&gt;, we use the following Python code.&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code ipython3"&gt;&lt;a id="rest_code_81efedfac39441e3b3ff970c0031d6ad-1" name="rest_code_81efedfac39441e3b3ff970c0031d6ad-1" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_81efedfac39441e3b3ff970c0031d6ad-1"&gt;&lt;/a&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="k"&gt;matplotlib&lt;/span&gt; inline
&lt;a id="rest_code_81efedfac39441e3b3ff970c0031d6ad-2" name="rest_code_81efedfac39441e3b3ff970c0031d6ad-2" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_81efedfac39441e3b3ff970c0031d6ad-2"&gt;&lt;/a&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;numpy&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;np&lt;/span&gt;
&lt;a id="rest_code_81efedfac39441e3b3ff970c0031d6ad-3" name="rest_code_81efedfac39441e3b3ff970c0031d6ad-3" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_81efedfac39441e3b3ff970c0031d6ad-3"&gt;&lt;/a&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;scipy.stats&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;st&lt;/span&gt;
&lt;a id="rest_code_81efedfac39441e3b3ff970c0031d6ad-4" name="rest_code_81efedfac39441e3b3ff970c0031d6ad-4" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_81efedfac39441e3b3ff970c0031d6ad-4"&gt;&lt;/a&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;matplotlib.pyplot&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;plt&lt;/span&gt;
&lt;a id="rest_code_81efedfac39441e3b3ff970c0031d6ad-5" name="rest_code_81efedfac39441e3b3ff970c0031d6ad-5" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_81efedfac39441e3b3ff970c0031d6ad-5"&gt;&lt;/a&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;mpl_toolkits.mplot3d&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;Axes3D&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="code"&gt;&lt;pre class="code ipython3"&gt;&lt;a id="rest_code_3d31a68eeecd430b9d94ef668b0d27bf-1" name="rest_code_3d31a68eeecd430b9d94ef668b0d27bf-1" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_3d31a68eeecd430b9d94ef668b0d27bf-1"&gt;&lt;/a&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;random&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;seed&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;42&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_3d31a68eeecd430b9d94ef668b0d27bf-2" name="rest_code_3d31a68eeecd430b9d94ef668b0d27bf-2" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_3d31a68eeecd430b9d94ef668b0d27bf-2"&gt;&lt;/a&gt;&lt;span class="n"&gt;Sig1&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;array&lt;/span&gt;&lt;span class="p"&gt;([[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mf"&gt;0.75&lt;/span&gt;&lt;span class="p"&gt;],[&lt;/span&gt;&lt;span class="mf"&gt;0.75&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;]])&lt;/span&gt;
&lt;a id="rest_code_3d31a68eeecd430b9d94ef668b0d27bf-3" name="rest_code_3d31a68eeecd430b9d94ef668b0d27bf-3" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_3d31a68eeecd430b9d94ef668b0d27bf-3"&gt;&lt;/a&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;1000&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="code"&gt;&lt;pre class="code ipython3"&gt;&lt;a id="rest_code_cc3ae6870b534a5eb55e0d2447174adb-1" name="rest_code_cc3ae6870b534a5eb55e0d2447174adb-1" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_cc3ae6870b534a5eb55e0d2447174adb-1"&gt;&lt;/a&gt;&lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;linspace&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1000&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_cc3ae6870b534a5eb55e0d2447174adb-2" name="rest_code_cc3ae6870b534a5eb55e0d2447174adb-2" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_cc3ae6870b534a5eb55e0d2447174adb-2"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;figure&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;figsize&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;8&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_cc3ae6870b534a5eb55e0d2447174adb-3" name="rest_code_cc3ae6870b534a5eb55e0d2447174adb-3" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_cc3ae6870b534a5eb55e0d2447174adb-3"&gt;&lt;/a&gt;&lt;span class="n"&gt;colors&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;cm&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Accent&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;linspace&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_cc3ae6870b534a5eb55e0d2447174adb-4" name="rest_code_cc3ae6870b534a5eb55e0d2447174adb-4" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_cc3ae6870b534a5eb55e0d2447174adb-4"&gt;&lt;/a&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;
&lt;a id="rest_code_cc3ae6870b534a5eb55e0d2447174adb-5" name="rest_code_cc3ae6870b534a5eb55e0d2447174adb-5" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_cc3ae6870b534a5eb55e0d2447174adb-5"&gt;&lt;/a&gt;&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;k&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_cc3ae6870b534a5eb55e0d2447174adb-6" name="rest_code_cc3ae6870b534a5eb55e0d2447174adb-6" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_cc3ae6870b534a5eb55e0d2447174adb-6"&gt;&lt;/a&gt;    &lt;span class="n"&gt;c&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;st&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;chi2&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;pdf&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;k&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;a id="rest_code_cc3ae6870b534a5eb55e0d2447174adb-7" name="rest_code_cc3ae6870b534a5eb55e0d2447174adb-7" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_cc3ae6870b534a5eb55e0d2447174adb-7"&gt;&lt;/a&gt;    &lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;plot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;c&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;label&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'k = '&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="nb"&gt;str&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;k&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;color&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;colors&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;&lt;span class="n"&gt;linewidth&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_cc3ae6870b534a5eb55e0d2447174adb-8" name="rest_code_cc3ae6870b534a5eb55e0d2447174adb-8" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_cc3ae6870b534a5eb55e0d2447174adb-8"&gt;&lt;/a&gt;    &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;+=&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;
&lt;a id="rest_code_cc3ae6870b534a5eb55e0d2447174adb-9" name="rest_code_cc3ae6870b534a5eb55e0d2447174adb-9" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_cc3ae6870b534a5eb55e0d2447174adb-9"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xlim&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_cc3ae6870b534a5eb55e0d2447174adb-10" name="rest_code_cc3ae6870b534a5eb55e0d2447174adb-10" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_cc3ae6870b534a5eb55e0d2447174adb-10"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ylim&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mf"&gt;0.5&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_cc3ae6870b534a5eb55e0d2447174adb-11" name="rest_code_cc3ae6870b534a5eb55e0d2447174adb-11" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_cc3ae6870b534a5eb55e0d2447174adb-11"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'x'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_cc3ae6870b534a5eb55e0d2447174adb-12" name="rest_code_cc3ae6870b534a5eb55e0d2447174adb-12" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_cc3ae6870b534a5eb55e0d2447174adb-12"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ylabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'f(x)'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_cc3ae6870b534a5eb55e0d2447174adb-13" name="rest_code_cc3ae6870b534a5eb55e0d2447174adb-13" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_cc3ae6870b534a5eb55e0d2447174adb-13"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;legend&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;img alt="../output_2_1.png" src="https://personalpages.manchester.ac.uk/staff/thomas.house/output_2_1.png"&gt;
&lt;p&gt;The Wishart emerges when we make &lt;span class="raw-html"&gt;\(k \)&lt;/span&gt; observations each with &lt;span class="raw-html"&gt;\(p \)&lt;/span&gt; variables; the
sampling distribution for the covariance matrix of these data if the population is multivariate normal is
Wishart and has probability density function&lt;/p&gt;
&lt;p&gt;&lt;span class="raw-html"&gt;$$ f_{\mathcal{W}_p(k,\boldsymbol{\Sigma})}(\boldsymbol{V}) = \frac{\mathrm{det}(\boldsymbol{V})^{\frac{k - p - 1}{2}}}{2^{ \frac{k p}{2} } \mathrm{det}(\boldsymbol{\Sigma})^\frac{k}{2} \Gamma_p\!\left(\frac{k}{2} \right)} \exp\left( -\frac12 \mathrm{Tr}(\boldsymbol{\Sigma}^{-1} \boldsymbol{V}) \right) . $$&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;In general, this cannot be visualised, but for the &lt;span class="raw-html"&gt;\(p=2 \)&lt;/span&gt; case, one option is to pick random
numbers from this distribution and then produce a three-dimensional scatter plot of these. The code and results
below show that this can be seen as behaving somewhat like the chi-squared distribution that it generalises as
the degrees of freedom &lt;span class="raw-html"&gt;\(k \)&lt;/span&gt; are increased.&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code ipython3"&gt;&lt;a id="rest_code_2a204a6d0b0b40ddb307802c80ca763c-1" name="rest_code_2a204a6d0b0b40ddb307802c80ca763c-1" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_2a204a6d0b0b40ddb307802c80ca763c-1"&gt;&lt;/a&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_2a204a6d0b0b40ddb307802c80ca763c-2" name="rest_code_2a204a6d0b0b40ddb307802c80ca763c-2" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_2a204a6d0b0b40ddb307802c80ca763c-2"&gt;&lt;/a&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_2a204a6d0b0b40ddb307802c80ca763c-3" name="rest_code_2a204a6d0b0b40ddb307802c80ca763c-3" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_2a204a6d0b0b40ddb307802c80ca763c-3"&gt;&lt;/a&gt;&lt;span class="n"&gt;z&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_2a204a6d0b0b40ddb307802c80ca763c-4" name="rest_code_2a204a6d0b0b40ddb307802c80ca763c-4" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_2a204a6d0b0b40ddb307802c80ca763c-4"&gt;&lt;/a&gt;&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_2a204a6d0b0b40ddb307802c80ca763c-5" name="rest_code_2a204a6d0b0b40ddb307802c80ca763c-5" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_2a204a6d0b0b40ddb307802c80ca763c-5"&gt;&lt;/a&gt;    &lt;span class="n"&gt;M&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;st&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;wishart&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;rvs&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;scale&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;Sig1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;size&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_2a204a6d0b0b40ddb307802c80ca763c-6" name="rest_code_2a204a6d0b0b40ddb307802c80ca763c-6" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_2a204a6d0b0b40ddb307802c80ca763c-6"&gt;&lt;/a&gt;    &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;M&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_2a204a6d0b0b40ddb307802c80ca763c-7" name="rest_code_2a204a6d0b0b40ddb307802c80ca763c-7" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_2a204a6d0b0b40ddb307802c80ca763c-7"&gt;&lt;/a&gt;    &lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;M&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_2a204a6d0b0b40ddb307802c80ca763c-8" name="rest_code_2a204a6d0b0b40ddb307802c80ca763c-8" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_2a204a6d0b0b40ddb307802c80ca763c-8"&gt;&lt;/a&gt;    &lt;span class="n"&gt;z&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;M&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_2a204a6d0b0b40ddb307802c80ca763c-9" name="rest_code_2a204a6d0b0b40ddb307802c80ca763c-9" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_2a204a6d0b0b40ddb307802c80ca763c-9"&gt;&lt;/a&gt;&lt;span class="n"&gt;fig&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;figure&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;figsize&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;8&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_2a204a6d0b0b40ddb307802c80ca763c-10" name="rest_code_2a204a6d0b0b40ddb307802c80ca763c-10" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_2a204a6d0b0b40ddb307802c80ca763c-10"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;fig&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;add_subplot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;111&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;projection&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'3d'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_2a204a6d0b0b40ddb307802c80ca763c-11" name="rest_code_2a204a6d0b0b40ddb307802c80ca763c-11" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_2a204a6d0b0b40ddb307802c80ca763c-11"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;scatter3D&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;z&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;marker&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'o'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;c&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;z&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;cmap&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'seismic'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_2a204a6d0b0b40ddb307802c80ca763c-12" name="rest_code_2a204a6d0b0b40ddb307802c80ca763c-12" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_2a204a6d0b0b40ddb307802c80ca763c-12"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_xlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'V11'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_2a204a6d0b0b40ddb307802c80ca763c-13" name="rest_code_2a204a6d0b0b40ddb307802c80ca763c-13" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_2a204a6d0b0b40ddb307802c80ca763c-13"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_ylabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'V22'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_2a204a6d0b0b40ddb307802c80ca763c-14" name="rest_code_2a204a6d0b0b40ddb307802c80ca763c-14" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_2a204a6d0b0b40ddb307802c80ca763c-14"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_zlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'V12=V21'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_2a204a6d0b0b40ddb307802c80ca763c-15" name="rest_code_2a204a6d0b0b40ddb307802c80ca763c-15" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_2a204a6d0b0b40ddb307802c80ca763c-15"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_xlim&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;30&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_2a204a6d0b0b40ddb307802c80ca763c-16" name="rest_code_2a204a6d0b0b40ddb307802c80ca763c-16" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_2a204a6d0b0b40ddb307802c80ca763c-16"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_ylim&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;70&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_2a204a6d0b0b40ddb307802c80ca763c-17" name="rest_code_2a204a6d0b0b40ddb307802c80ca763c-17" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_2a204a6d0b0b40ddb307802c80ca763c-17"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_zlim&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;30&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_2a204a6d0b0b40ddb307802c80ca763c-18" name="rest_code_2a204a6d0b0b40ddb307802c80ca763c-18" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_2a204a6d0b0b40ddb307802c80ca763c-18"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;tight_layout&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;img alt="../output_3_0.png" src="https://personalpages.manchester.ac.uk/staff/thomas.house/output_3_0.png"&gt;
&lt;div class="code"&gt;&lt;pre class="code ipython3"&gt;&lt;a id="rest_code_a676d237e9c8464d88906f5cf10f4924-1" name="rest_code_a676d237e9c8464d88906f5cf10f4924-1" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_a676d237e9c8464d88906f5cf10f4924-1"&gt;&lt;/a&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_a676d237e9c8464d88906f5cf10f4924-2" name="rest_code_a676d237e9c8464d88906f5cf10f4924-2" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_a676d237e9c8464d88906f5cf10f4924-2"&gt;&lt;/a&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_a676d237e9c8464d88906f5cf10f4924-3" name="rest_code_a676d237e9c8464d88906f5cf10f4924-3" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_a676d237e9c8464d88906f5cf10f4924-3"&gt;&lt;/a&gt;&lt;span class="n"&gt;z&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_a676d237e9c8464d88906f5cf10f4924-4" name="rest_code_a676d237e9c8464d88906f5cf10f4924-4" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_a676d237e9c8464d88906f5cf10f4924-4"&gt;&lt;/a&gt;&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_a676d237e9c8464d88906f5cf10f4924-5" name="rest_code_a676d237e9c8464d88906f5cf10f4924-5" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_a676d237e9c8464d88906f5cf10f4924-5"&gt;&lt;/a&gt;    &lt;span class="n"&gt;M&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;st&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;wishart&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;rvs&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;scale&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;Sig1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;size&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_a676d237e9c8464d88906f5cf10f4924-6" name="rest_code_a676d237e9c8464d88906f5cf10f4924-6" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_a676d237e9c8464d88906f5cf10f4924-6"&gt;&lt;/a&gt;    &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;M&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_a676d237e9c8464d88906f5cf10f4924-7" name="rest_code_a676d237e9c8464d88906f5cf10f4924-7" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_a676d237e9c8464d88906f5cf10f4924-7"&gt;&lt;/a&gt;    &lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;M&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_a676d237e9c8464d88906f5cf10f4924-8" name="rest_code_a676d237e9c8464d88906f5cf10f4924-8" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_a676d237e9c8464d88906f5cf10f4924-8"&gt;&lt;/a&gt;    &lt;span class="n"&gt;z&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;M&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_a676d237e9c8464d88906f5cf10f4924-9" name="rest_code_a676d237e9c8464d88906f5cf10f4924-9" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_a676d237e9c8464d88906f5cf10f4924-9"&gt;&lt;/a&gt;&lt;span class="n"&gt;fig&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;figure&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;figsize&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;8&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_a676d237e9c8464d88906f5cf10f4924-10" name="rest_code_a676d237e9c8464d88906f5cf10f4924-10" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_a676d237e9c8464d88906f5cf10f4924-10"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;fig&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;add_subplot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;111&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;projection&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'3d'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_a676d237e9c8464d88906f5cf10f4924-11" name="rest_code_a676d237e9c8464d88906f5cf10f4924-11" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_a676d237e9c8464d88906f5cf10f4924-11"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;scatter3D&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;z&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;marker&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'o'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;c&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;z&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;cmap&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'seismic'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_a676d237e9c8464d88906f5cf10f4924-12" name="rest_code_a676d237e9c8464d88906f5cf10f4924-12" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_a676d237e9c8464d88906f5cf10f4924-12"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_xlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'V11'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_a676d237e9c8464d88906f5cf10f4924-13" name="rest_code_a676d237e9c8464d88906f5cf10f4924-13" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_a676d237e9c8464d88906f5cf10f4924-13"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_ylabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'V22'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_a676d237e9c8464d88906f5cf10f4924-14" name="rest_code_a676d237e9c8464d88906f5cf10f4924-14" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_a676d237e9c8464d88906f5cf10f4924-14"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_zlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'V12=V21'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_a676d237e9c8464d88906f5cf10f4924-15" name="rest_code_a676d237e9c8464d88906f5cf10f4924-15" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_a676d237e9c8464d88906f5cf10f4924-15"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_xlim&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;30&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_a676d237e9c8464d88906f5cf10f4924-16" name="rest_code_a676d237e9c8464d88906f5cf10f4924-16" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_a676d237e9c8464d88906f5cf10f4924-16"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_ylim&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;70&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_a676d237e9c8464d88906f5cf10f4924-17" name="rest_code_a676d237e9c8464d88906f5cf10f4924-17" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_a676d237e9c8464d88906f5cf10f4924-17"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_zlim&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;30&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_a676d237e9c8464d88906f5cf10f4924-18" name="rest_code_a676d237e9c8464d88906f5cf10f4924-18" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_a676d237e9c8464d88906f5cf10f4924-18"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;tight_layout&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;img alt="../output_4_0.png" src="https://personalpages.manchester.ac.uk/staff/thomas.house/output_4_0.png"&gt;
&lt;div class="code"&gt;&lt;pre class="code ipython3"&gt;&lt;a id="rest_code_76116a44a2574bca8e27ed73d13dd183-1" name="rest_code_76116a44a2574bca8e27ed73d13dd183-1" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_76116a44a2574bca8e27ed73d13dd183-1"&gt;&lt;/a&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_76116a44a2574bca8e27ed73d13dd183-2" name="rest_code_76116a44a2574bca8e27ed73d13dd183-2" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_76116a44a2574bca8e27ed73d13dd183-2"&gt;&lt;/a&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_76116a44a2574bca8e27ed73d13dd183-3" name="rest_code_76116a44a2574bca8e27ed73d13dd183-3" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_76116a44a2574bca8e27ed73d13dd183-3"&gt;&lt;/a&gt;&lt;span class="n"&gt;z&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_76116a44a2574bca8e27ed73d13dd183-4" name="rest_code_76116a44a2574bca8e27ed73d13dd183-4" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_76116a44a2574bca8e27ed73d13dd183-4"&gt;&lt;/a&gt;&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_76116a44a2574bca8e27ed73d13dd183-5" name="rest_code_76116a44a2574bca8e27ed73d13dd183-5" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_76116a44a2574bca8e27ed73d13dd183-5"&gt;&lt;/a&gt;    &lt;span class="n"&gt;M&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;st&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;wishart&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;rvs&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;scale&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;Sig1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;size&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_76116a44a2574bca8e27ed73d13dd183-6" name="rest_code_76116a44a2574bca8e27ed73d13dd183-6" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_76116a44a2574bca8e27ed73d13dd183-6"&gt;&lt;/a&gt;    &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;M&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_76116a44a2574bca8e27ed73d13dd183-7" name="rest_code_76116a44a2574bca8e27ed73d13dd183-7" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_76116a44a2574bca8e27ed73d13dd183-7"&gt;&lt;/a&gt;    &lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;M&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_76116a44a2574bca8e27ed73d13dd183-8" name="rest_code_76116a44a2574bca8e27ed73d13dd183-8" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_76116a44a2574bca8e27ed73d13dd183-8"&gt;&lt;/a&gt;    &lt;span class="n"&gt;z&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;M&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_76116a44a2574bca8e27ed73d13dd183-9" name="rest_code_76116a44a2574bca8e27ed73d13dd183-9" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_76116a44a2574bca8e27ed73d13dd183-9"&gt;&lt;/a&gt;&lt;span class="n"&gt;fig&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;figure&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;figsize&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;8&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_76116a44a2574bca8e27ed73d13dd183-10" name="rest_code_76116a44a2574bca8e27ed73d13dd183-10" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_76116a44a2574bca8e27ed73d13dd183-10"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;fig&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;add_subplot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;111&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;projection&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'3d'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_76116a44a2574bca8e27ed73d13dd183-11" name="rest_code_76116a44a2574bca8e27ed73d13dd183-11" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_76116a44a2574bca8e27ed73d13dd183-11"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;scatter3D&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;z&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;marker&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'o'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;c&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;z&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;cmap&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'seismic'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_76116a44a2574bca8e27ed73d13dd183-12" name="rest_code_76116a44a2574bca8e27ed73d13dd183-12" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_76116a44a2574bca8e27ed73d13dd183-12"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_xlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'V11'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_76116a44a2574bca8e27ed73d13dd183-13" name="rest_code_76116a44a2574bca8e27ed73d13dd183-13" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_76116a44a2574bca8e27ed73d13dd183-13"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_ylabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'V22'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_76116a44a2574bca8e27ed73d13dd183-14" name="rest_code_76116a44a2574bca8e27ed73d13dd183-14" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_76116a44a2574bca8e27ed73d13dd183-14"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_zlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'V12=V21'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_76116a44a2574bca8e27ed73d13dd183-15" name="rest_code_76116a44a2574bca8e27ed73d13dd183-15" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_76116a44a2574bca8e27ed73d13dd183-15"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_xlim&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;30&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_76116a44a2574bca8e27ed73d13dd183-16" name="rest_code_76116a44a2574bca8e27ed73d13dd183-16" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_76116a44a2574bca8e27ed73d13dd183-16"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_ylim&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;70&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_76116a44a2574bca8e27ed73d13dd183-17" name="rest_code_76116a44a2574bca8e27ed73d13dd183-17" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_76116a44a2574bca8e27ed73d13dd183-17"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_zlim&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;30&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_76116a44a2574bca8e27ed73d13dd183-18" name="rest_code_76116a44a2574bca8e27ed73d13dd183-18" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_76116a44a2574bca8e27ed73d13dd183-18"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;tight_layout&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;img alt="../output_5_0.png" src="https://personalpages.manchester.ac.uk/staff/thomas.house/output_5_0.png"&gt;&lt;/body&gt;&lt;/html&gt;

&lt;p&gt;To visualise this at different degrees of freedom &lt;span class="raw-html"&gt;\(k \)&lt;/span&gt;, we use the following Python code.&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code ipython3"&gt;&lt;a id="rest_code_81efedfac39441e3b3ff970c0031d6ad-1" name="rest_code_81efedfac39441e3b3ff970c0031d6ad-1" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_81efedfac39441e3b3ff970c0031d6ad-1"&gt;&lt;/a&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="k"&gt;matplotlib&lt;/span&gt; inline
&lt;a id="rest_code_81efedfac39441e3b3ff970c0031d6ad-2" name="rest_code_81efedfac39441e3b3ff970c0031d6ad-2" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_81efedfac39441e3b3ff970c0031d6ad-2"&gt;&lt;/a&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;numpy&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;np&lt;/span&gt;
&lt;a id="rest_code_81efedfac39441e3b3ff970c0031d6ad-3" name="rest_code_81efedfac39441e3b3ff970c0031d6ad-3" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_81efedfac39441e3b3ff970c0031d6ad-3"&gt;&lt;/a&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;scipy.stats&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;st&lt;/span&gt;
&lt;a id="rest_code_81efedfac39441e3b3ff970c0031d6ad-4" name="rest_code_81efedfac39441e3b3ff970c0031d6ad-4" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_81efedfac39441e3b3ff970c0031d6ad-4"&gt;&lt;/a&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;matplotlib.pyplot&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;plt&lt;/span&gt;
&lt;a id="rest_code_81efedfac39441e3b3ff970c0031d6ad-5" name="rest_code_81efedfac39441e3b3ff970c0031d6ad-5" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_81efedfac39441e3b3ff970c0031d6ad-5"&gt;&lt;/a&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;mpl_toolkits.mplot3d&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;Axes3D&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="code"&gt;&lt;pre class="code ipython3"&gt;&lt;a id="rest_code_3d31a68eeecd430b9d94ef668b0d27bf-1" name="rest_code_3d31a68eeecd430b9d94ef668b0d27bf-1" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_3d31a68eeecd430b9d94ef668b0d27bf-1"&gt;&lt;/a&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;random&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;seed&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;42&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_3d31a68eeecd430b9d94ef668b0d27bf-2" name="rest_code_3d31a68eeecd430b9d94ef668b0d27bf-2" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_3d31a68eeecd430b9d94ef668b0d27bf-2"&gt;&lt;/a&gt;&lt;span class="n"&gt;Sig1&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;array&lt;/span&gt;&lt;span class="p"&gt;([[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mf"&gt;0.75&lt;/span&gt;&lt;span class="p"&gt;],[&lt;/span&gt;&lt;span class="mf"&gt;0.75&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;]])&lt;/span&gt;
&lt;a id="rest_code_3d31a68eeecd430b9d94ef668b0d27bf-3" name="rest_code_3d31a68eeecd430b9d94ef668b0d27bf-3" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_3d31a68eeecd430b9d94ef668b0d27bf-3"&gt;&lt;/a&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;1000&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="code"&gt;&lt;pre class="code ipython3"&gt;&lt;a id="rest_code_cc3ae6870b534a5eb55e0d2447174adb-1" name="rest_code_cc3ae6870b534a5eb55e0d2447174adb-1" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_cc3ae6870b534a5eb55e0d2447174adb-1"&gt;&lt;/a&gt;&lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;linspace&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1000&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_cc3ae6870b534a5eb55e0d2447174adb-2" name="rest_code_cc3ae6870b534a5eb55e0d2447174adb-2" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_cc3ae6870b534a5eb55e0d2447174adb-2"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;figure&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;figsize&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;8&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_cc3ae6870b534a5eb55e0d2447174adb-3" name="rest_code_cc3ae6870b534a5eb55e0d2447174adb-3" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_cc3ae6870b534a5eb55e0d2447174adb-3"&gt;&lt;/a&gt;&lt;span class="n"&gt;colors&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;cm&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Accent&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;linspace&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_cc3ae6870b534a5eb55e0d2447174adb-4" name="rest_code_cc3ae6870b534a5eb55e0d2447174adb-4" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_cc3ae6870b534a5eb55e0d2447174adb-4"&gt;&lt;/a&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;
&lt;a id="rest_code_cc3ae6870b534a5eb55e0d2447174adb-5" name="rest_code_cc3ae6870b534a5eb55e0d2447174adb-5" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_cc3ae6870b534a5eb55e0d2447174adb-5"&gt;&lt;/a&gt;&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;k&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_cc3ae6870b534a5eb55e0d2447174adb-6" name="rest_code_cc3ae6870b534a5eb55e0d2447174adb-6" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_cc3ae6870b534a5eb55e0d2447174adb-6"&gt;&lt;/a&gt;    &lt;span class="n"&gt;c&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;st&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;chi2&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;pdf&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;k&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;a id="rest_code_cc3ae6870b534a5eb55e0d2447174adb-7" name="rest_code_cc3ae6870b534a5eb55e0d2447174adb-7" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_cc3ae6870b534a5eb55e0d2447174adb-7"&gt;&lt;/a&gt;    &lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;plot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;c&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;label&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'k = '&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="nb"&gt;str&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;k&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;color&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;colors&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;&lt;span class="n"&gt;linewidth&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_cc3ae6870b534a5eb55e0d2447174adb-8" name="rest_code_cc3ae6870b534a5eb55e0d2447174adb-8" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_cc3ae6870b534a5eb55e0d2447174adb-8"&gt;&lt;/a&gt;    &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;+=&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;
&lt;a id="rest_code_cc3ae6870b534a5eb55e0d2447174adb-9" name="rest_code_cc3ae6870b534a5eb55e0d2447174adb-9" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_cc3ae6870b534a5eb55e0d2447174adb-9"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xlim&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_cc3ae6870b534a5eb55e0d2447174adb-10" name="rest_code_cc3ae6870b534a5eb55e0d2447174adb-10" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_cc3ae6870b534a5eb55e0d2447174adb-10"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ylim&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mf"&gt;0.5&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_cc3ae6870b534a5eb55e0d2447174adb-11" name="rest_code_cc3ae6870b534a5eb55e0d2447174adb-11" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_cc3ae6870b534a5eb55e0d2447174adb-11"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'x'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_cc3ae6870b534a5eb55e0d2447174adb-12" name="rest_code_cc3ae6870b534a5eb55e0d2447174adb-12" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_cc3ae6870b534a5eb55e0d2447174adb-12"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ylabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'f(x)'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_cc3ae6870b534a5eb55e0d2447174adb-13" name="rest_code_cc3ae6870b534a5eb55e0d2447174adb-13" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_cc3ae6870b534a5eb55e0d2447174adb-13"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;legend&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;img alt="../output_2_1.png" src="https://personalpages.manchester.ac.uk/staff/thomas.house/output_2_1.png"&gt;
&lt;p&gt;The Wishart emerges when we make &lt;span class="raw-html"&gt;\(k \)&lt;/span&gt; observations each with &lt;span class="raw-html"&gt;\(p \)&lt;/span&gt; variables; the
sampling distribution for the covariance matrix of these data if the population is multivariate normal is
Wishart and has probability density function&lt;/p&gt;
&lt;p&gt;&lt;span class="raw-html"&gt;$$ f_{\mathcal{W}_p(k,\boldsymbol{\Sigma})}(\boldsymbol{V}) = \frac{\mathrm{det}(\boldsymbol{V})^{\frac{k - p - 1}{2}}}{2^{ \frac{k p}{2} } \mathrm{det}(\boldsymbol{\Sigma})^\frac{k}{2} \Gamma_p\!\left(\frac{k}{2} \right)} \exp\left( -\frac12 \mathrm{Tr}(\boldsymbol{\Sigma}^{-1} \boldsymbol{V}) \right) . $$&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;In general, this cannot be visualised, but for the &lt;span class="raw-html"&gt;\(p=2 \)&lt;/span&gt; case, one option is to pick random
numbers from this distribution and then produce a three-dimensional scatter plot of these. The code and results
below show that this can be seen as behaving somewhat like the chi-squared distribution that it generalises as
the degrees of freedom &lt;span class="raw-html"&gt;\(k \)&lt;/span&gt; are increased.&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code ipython3"&gt;&lt;a id="rest_code_2a204a6d0b0b40ddb307802c80ca763c-1" name="rest_code_2a204a6d0b0b40ddb307802c80ca763c-1" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_2a204a6d0b0b40ddb307802c80ca763c-1"&gt;&lt;/a&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_2a204a6d0b0b40ddb307802c80ca763c-2" name="rest_code_2a204a6d0b0b40ddb307802c80ca763c-2" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_2a204a6d0b0b40ddb307802c80ca763c-2"&gt;&lt;/a&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_2a204a6d0b0b40ddb307802c80ca763c-3" name="rest_code_2a204a6d0b0b40ddb307802c80ca763c-3" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_2a204a6d0b0b40ddb307802c80ca763c-3"&gt;&lt;/a&gt;&lt;span class="n"&gt;z&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_2a204a6d0b0b40ddb307802c80ca763c-4" name="rest_code_2a204a6d0b0b40ddb307802c80ca763c-4" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_2a204a6d0b0b40ddb307802c80ca763c-4"&gt;&lt;/a&gt;&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_2a204a6d0b0b40ddb307802c80ca763c-5" name="rest_code_2a204a6d0b0b40ddb307802c80ca763c-5" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_2a204a6d0b0b40ddb307802c80ca763c-5"&gt;&lt;/a&gt;    &lt;span class="n"&gt;M&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;st&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;wishart&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;rvs&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;scale&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;Sig1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;size&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_2a204a6d0b0b40ddb307802c80ca763c-6" name="rest_code_2a204a6d0b0b40ddb307802c80ca763c-6" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_2a204a6d0b0b40ddb307802c80ca763c-6"&gt;&lt;/a&gt;    &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;M&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_2a204a6d0b0b40ddb307802c80ca763c-7" name="rest_code_2a204a6d0b0b40ddb307802c80ca763c-7" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_2a204a6d0b0b40ddb307802c80ca763c-7"&gt;&lt;/a&gt;    &lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;M&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_2a204a6d0b0b40ddb307802c80ca763c-8" name="rest_code_2a204a6d0b0b40ddb307802c80ca763c-8" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_2a204a6d0b0b40ddb307802c80ca763c-8"&gt;&lt;/a&gt;    &lt;span class="n"&gt;z&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;M&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_2a204a6d0b0b40ddb307802c80ca763c-9" name="rest_code_2a204a6d0b0b40ddb307802c80ca763c-9" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_2a204a6d0b0b40ddb307802c80ca763c-9"&gt;&lt;/a&gt;&lt;span class="n"&gt;fig&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;figure&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;figsize&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;8&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_2a204a6d0b0b40ddb307802c80ca763c-10" name="rest_code_2a204a6d0b0b40ddb307802c80ca763c-10" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_2a204a6d0b0b40ddb307802c80ca763c-10"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;fig&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;add_subplot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;111&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;projection&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'3d'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_2a204a6d0b0b40ddb307802c80ca763c-11" name="rest_code_2a204a6d0b0b40ddb307802c80ca763c-11" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_2a204a6d0b0b40ddb307802c80ca763c-11"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;scatter3D&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;z&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;marker&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'o'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;c&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;z&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;cmap&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'seismic'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_2a204a6d0b0b40ddb307802c80ca763c-12" name="rest_code_2a204a6d0b0b40ddb307802c80ca763c-12" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_2a204a6d0b0b40ddb307802c80ca763c-12"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_xlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'V11'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_2a204a6d0b0b40ddb307802c80ca763c-13" name="rest_code_2a204a6d0b0b40ddb307802c80ca763c-13" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_2a204a6d0b0b40ddb307802c80ca763c-13"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_ylabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'V22'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_2a204a6d0b0b40ddb307802c80ca763c-14" name="rest_code_2a204a6d0b0b40ddb307802c80ca763c-14" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_2a204a6d0b0b40ddb307802c80ca763c-14"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_zlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'V12=V21'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_2a204a6d0b0b40ddb307802c80ca763c-15" name="rest_code_2a204a6d0b0b40ddb307802c80ca763c-15" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_2a204a6d0b0b40ddb307802c80ca763c-15"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_xlim&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;30&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_2a204a6d0b0b40ddb307802c80ca763c-16" name="rest_code_2a204a6d0b0b40ddb307802c80ca763c-16" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_2a204a6d0b0b40ddb307802c80ca763c-16"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_ylim&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;70&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_2a204a6d0b0b40ddb307802c80ca763c-17" name="rest_code_2a204a6d0b0b40ddb307802c80ca763c-17" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_2a204a6d0b0b40ddb307802c80ca763c-17"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_zlim&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;30&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_2a204a6d0b0b40ddb307802c80ca763c-18" name="rest_code_2a204a6d0b0b40ddb307802c80ca763c-18" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_2a204a6d0b0b40ddb307802c80ca763c-18"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;tight_layout&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;img alt="../output_3_0.png" src="https://personalpages.manchester.ac.uk/staff/thomas.house/output_3_0.png"&gt;
&lt;div class="code"&gt;&lt;pre class="code ipython3"&gt;&lt;a id="rest_code_a676d237e9c8464d88906f5cf10f4924-1" name="rest_code_a676d237e9c8464d88906f5cf10f4924-1" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_a676d237e9c8464d88906f5cf10f4924-1"&gt;&lt;/a&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_a676d237e9c8464d88906f5cf10f4924-2" name="rest_code_a676d237e9c8464d88906f5cf10f4924-2" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_a676d237e9c8464d88906f5cf10f4924-2"&gt;&lt;/a&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_a676d237e9c8464d88906f5cf10f4924-3" name="rest_code_a676d237e9c8464d88906f5cf10f4924-3" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_a676d237e9c8464d88906f5cf10f4924-3"&gt;&lt;/a&gt;&lt;span class="n"&gt;z&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_a676d237e9c8464d88906f5cf10f4924-4" name="rest_code_a676d237e9c8464d88906f5cf10f4924-4" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_a676d237e9c8464d88906f5cf10f4924-4"&gt;&lt;/a&gt;&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_a676d237e9c8464d88906f5cf10f4924-5" name="rest_code_a676d237e9c8464d88906f5cf10f4924-5" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_a676d237e9c8464d88906f5cf10f4924-5"&gt;&lt;/a&gt;    &lt;span class="n"&gt;M&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;st&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;wishart&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;rvs&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;scale&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;Sig1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;size&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_a676d237e9c8464d88906f5cf10f4924-6" name="rest_code_a676d237e9c8464d88906f5cf10f4924-6" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_a676d237e9c8464d88906f5cf10f4924-6"&gt;&lt;/a&gt;    &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;M&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_a676d237e9c8464d88906f5cf10f4924-7" name="rest_code_a676d237e9c8464d88906f5cf10f4924-7" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_a676d237e9c8464d88906f5cf10f4924-7"&gt;&lt;/a&gt;    &lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;M&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_a676d237e9c8464d88906f5cf10f4924-8" name="rest_code_a676d237e9c8464d88906f5cf10f4924-8" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_a676d237e9c8464d88906f5cf10f4924-8"&gt;&lt;/a&gt;    &lt;span class="n"&gt;z&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;M&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_a676d237e9c8464d88906f5cf10f4924-9" name="rest_code_a676d237e9c8464d88906f5cf10f4924-9" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_a676d237e9c8464d88906f5cf10f4924-9"&gt;&lt;/a&gt;&lt;span class="n"&gt;fig&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;figure&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;figsize&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;8&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_a676d237e9c8464d88906f5cf10f4924-10" name="rest_code_a676d237e9c8464d88906f5cf10f4924-10" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_a676d237e9c8464d88906f5cf10f4924-10"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;fig&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;add_subplot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;111&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;projection&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'3d'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_a676d237e9c8464d88906f5cf10f4924-11" name="rest_code_a676d237e9c8464d88906f5cf10f4924-11" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_a676d237e9c8464d88906f5cf10f4924-11"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;scatter3D&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;z&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;marker&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'o'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;c&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;z&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;cmap&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'seismic'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_a676d237e9c8464d88906f5cf10f4924-12" name="rest_code_a676d237e9c8464d88906f5cf10f4924-12" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_a676d237e9c8464d88906f5cf10f4924-12"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_xlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'V11'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_a676d237e9c8464d88906f5cf10f4924-13" name="rest_code_a676d237e9c8464d88906f5cf10f4924-13" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_a676d237e9c8464d88906f5cf10f4924-13"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_ylabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'V22'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_a676d237e9c8464d88906f5cf10f4924-14" name="rest_code_a676d237e9c8464d88906f5cf10f4924-14" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_a676d237e9c8464d88906f5cf10f4924-14"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_zlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'V12=V21'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_a676d237e9c8464d88906f5cf10f4924-15" name="rest_code_a676d237e9c8464d88906f5cf10f4924-15" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_a676d237e9c8464d88906f5cf10f4924-15"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_xlim&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;30&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_a676d237e9c8464d88906f5cf10f4924-16" name="rest_code_a676d237e9c8464d88906f5cf10f4924-16" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_a676d237e9c8464d88906f5cf10f4924-16"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_ylim&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;70&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_a676d237e9c8464d88906f5cf10f4924-17" name="rest_code_a676d237e9c8464d88906f5cf10f4924-17" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_a676d237e9c8464d88906f5cf10f4924-17"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_zlim&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;30&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_a676d237e9c8464d88906f5cf10f4924-18" name="rest_code_a676d237e9c8464d88906f5cf10f4924-18" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_a676d237e9c8464d88906f5cf10f4924-18"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;tight_layout&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;img alt="../output_4_0.png" src="https://personalpages.manchester.ac.uk/staff/thomas.house/output_4_0.png"&gt;
&lt;div class="code"&gt;&lt;pre class="code ipython3"&gt;&lt;a id="rest_code_76116a44a2574bca8e27ed73d13dd183-1" name="rest_code_76116a44a2574bca8e27ed73d13dd183-1" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_76116a44a2574bca8e27ed73d13dd183-1"&gt;&lt;/a&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_76116a44a2574bca8e27ed73d13dd183-2" name="rest_code_76116a44a2574bca8e27ed73d13dd183-2" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_76116a44a2574bca8e27ed73d13dd183-2"&gt;&lt;/a&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_76116a44a2574bca8e27ed73d13dd183-3" name="rest_code_76116a44a2574bca8e27ed73d13dd183-3" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_76116a44a2574bca8e27ed73d13dd183-3"&gt;&lt;/a&gt;&lt;span class="n"&gt;z&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_76116a44a2574bca8e27ed73d13dd183-4" name="rest_code_76116a44a2574bca8e27ed73d13dd183-4" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_76116a44a2574bca8e27ed73d13dd183-4"&gt;&lt;/a&gt;&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_76116a44a2574bca8e27ed73d13dd183-5" name="rest_code_76116a44a2574bca8e27ed73d13dd183-5" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_76116a44a2574bca8e27ed73d13dd183-5"&gt;&lt;/a&gt;    &lt;span class="n"&gt;M&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;st&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;wishart&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;rvs&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;scale&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;Sig1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;size&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_76116a44a2574bca8e27ed73d13dd183-6" name="rest_code_76116a44a2574bca8e27ed73d13dd183-6" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_76116a44a2574bca8e27ed73d13dd183-6"&gt;&lt;/a&gt;    &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;M&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_76116a44a2574bca8e27ed73d13dd183-7" name="rest_code_76116a44a2574bca8e27ed73d13dd183-7" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_76116a44a2574bca8e27ed73d13dd183-7"&gt;&lt;/a&gt;    &lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;M&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_76116a44a2574bca8e27ed73d13dd183-8" name="rest_code_76116a44a2574bca8e27ed73d13dd183-8" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_76116a44a2574bca8e27ed73d13dd183-8"&gt;&lt;/a&gt;    &lt;span class="n"&gt;z&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;M&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_76116a44a2574bca8e27ed73d13dd183-9" name="rest_code_76116a44a2574bca8e27ed73d13dd183-9" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_76116a44a2574bca8e27ed73d13dd183-9"&gt;&lt;/a&gt;&lt;span class="n"&gt;fig&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;figure&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;figsize&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;8&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_76116a44a2574bca8e27ed73d13dd183-10" name="rest_code_76116a44a2574bca8e27ed73d13dd183-10" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_76116a44a2574bca8e27ed73d13dd183-10"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;fig&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;add_subplot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;111&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;projection&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'3d'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_76116a44a2574bca8e27ed73d13dd183-11" name="rest_code_76116a44a2574bca8e27ed73d13dd183-11" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_76116a44a2574bca8e27ed73d13dd183-11"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;scatter3D&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;z&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;marker&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'o'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;c&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;z&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;cmap&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'seismic'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_76116a44a2574bca8e27ed73d13dd183-12" name="rest_code_76116a44a2574bca8e27ed73d13dd183-12" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_76116a44a2574bca8e27ed73d13dd183-12"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_xlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'V11'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_76116a44a2574bca8e27ed73d13dd183-13" name="rest_code_76116a44a2574bca8e27ed73d13dd183-13" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_76116a44a2574bca8e27ed73d13dd183-13"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_ylabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'V22'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_76116a44a2574bca8e27ed73d13dd183-14" name="rest_code_76116a44a2574bca8e27ed73d13dd183-14" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_76116a44a2574bca8e27ed73d13dd183-14"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_zlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'V12=V21'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_76116a44a2574bca8e27ed73d13dd183-15" name="rest_code_76116a44a2574bca8e27ed73d13dd183-15" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_76116a44a2574bca8e27ed73d13dd183-15"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_xlim&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;30&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_76116a44a2574bca8e27ed73d13dd183-16" name="rest_code_76116a44a2574bca8e27ed73d13dd183-16" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_76116a44a2574bca8e27ed73d13dd183-16"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_ylim&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;70&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_76116a44a2574bca8e27ed73d13dd183-17" name="rest_code_76116a44a2574bca8e27ed73d13dd183-17" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_76116a44a2574bca8e27ed73d13dd183-17"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_zlim&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;30&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_76116a44a2574bca8e27ed73d13dd183-18" name="rest_code_76116a44a2574bca8e27ed73d13dd183-18" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_76116a44a2574bca8e27ed73d13dd183-18"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;tight_layout&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;img alt="../output_5_0.png" src="https://personalpages.manchester.ac.uk/staff/thomas.house/output_5_0.png"&gt;&lt;/body&gt;&lt;/html&gt;

&lt;div class="code"&gt;&lt;pre class="code ipython3"&gt;&lt;a id="rest_code_81efedfac39441e3b3ff970c0031d6ad-1" name="rest_code_81efedfac39441e3b3ff970c0031d6ad-1" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_81efedfac39441e3b3ff970c0031d6ad-1"&gt;&lt;/a&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="k"&gt;matplotlib&lt;/span&gt; inline
&lt;a id="rest_code_81efedfac39441e3b3ff970c0031d6ad-2" name="rest_code_81efedfac39441e3b3ff970c0031d6ad-2" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_81efedfac39441e3b3ff970c0031d6ad-2"&gt;&lt;/a&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;numpy&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;np&lt;/span&gt;
&lt;a id="rest_code_81efedfac39441e3b3ff970c0031d6ad-3" name="rest_code_81efedfac39441e3b3ff970c0031d6ad-3" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_81efedfac39441e3b3ff970c0031d6ad-3"&gt;&lt;/a&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;scipy.stats&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;st&lt;/span&gt;
&lt;a id="rest_code_81efedfac39441e3b3ff970c0031d6ad-4" name="rest_code_81efedfac39441e3b3ff970c0031d6ad-4" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_81efedfac39441e3b3ff970c0031d6ad-4"&gt;&lt;/a&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;matplotlib.pyplot&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;plt&lt;/span&gt;
&lt;a id="rest_code_81efedfac39441e3b3ff970c0031d6ad-5" name="rest_code_81efedfac39441e3b3ff970c0031d6ad-5" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_81efedfac39441e3b3ff970c0031d6ad-5"&gt;&lt;/a&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;mpl_toolkits.mplot3d&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;Axes3D&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="code"&gt;&lt;pre class="code ipython3"&gt;&lt;a id="rest_code_3d31a68eeecd430b9d94ef668b0d27bf-1" name="rest_code_3d31a68eeecd430b9d94ef668b0d27bf-1" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_3d31a68eeecd430b9d94ef668b0d27bf-1"&gt;&lt;/a&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;random&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;seed&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;42&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_3d31a68eeecd430b9d94ef668b0d27bf-2" name="rest_code_3d31a68eeecd430b9d94ef668b0d27bf-2" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_3d31a68eeecd430b9d94ef668b0d27bf-2"&gt;&lt;/a&gt;&lt;span class="n"&gt;Sig1&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;array&lt;/span&gt;&lt;span class="p"&gt;([[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mf"&gt;0.75&lt;/span&gt;&lt;span class="p"&gt;],[&lt;/span&gt;&lt;span class="mf"&gt;0.75&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;]])&lt;/span&gt;
&lt;a id="rest_code_3d31a68eeecd430b9d94ef668b0d27bf-3" name="rest_code_3d31a68eeecd430b9d94ef668b0d27bf-3" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_3d31a68eeecd430b9d94ef668b0d27bf-3"&gt;&lt;/a&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;1000&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="code"&gt;&lt;pre class="code ipython3"&gt;&lt;a id="rest_code_cc3ae6870b534a5eb55e0d2447174adb-1" name="rest_code_cc3ae6870b534a5eb55e0d2447174adb-1" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_cc3ae6870b534a5eb55e0d2447174adb-1"&gt;&lt;/a&gt;&lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;linspace&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1000&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_cc3ae6870b534a5eb55e0d2447174adb-2" name="rest_code_cc3ae6870b534a5eb55e0d2447174adb-2" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_cc3ae6870b534a5eb55e0d2447174adb-2"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;figure&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;figsize&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;8&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_cc3ae6870b534a5eb55e0d2447174adb-3" name="rest_code_cc3ae6870b534a5eb55e0d2447174adb-3" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_cc3ae6870b534a5eb55e0d2447174adb-3"&gt;&lt;/a&gt;&lt;span class="n"&gt;colors&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;cm&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Accent&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;linspace&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_cc3ae6870b534a5eb55e0d2447174adb-4" name="rest_code_cc3ae6870b534a5eb55e0d2447174adb-4" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_cc3ae6870b534a5eb55e0d2447174adb-4"&gt;&lt;/a&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;
&lt;a id="rest_code_cc3ae6870b534a5eb55e0d2447174adb-5" name="rest_code_cc3ae6870b534a5eb55e0d2447174adb-5" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_cc3ae6870b534a5eb55e0d2447174adb-5"&gt;&lt;/a&gt;&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;k&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_cc3ae6870b534a5eb55e0d2447174adb-6" name="rest_code_cc3ae6870b534a5eb55e0d2447174adb-6" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_cc3ae6870b534a5eb55e0d2447174adb-6"&gt;&lt;/a&gt;    &lt;span class="n"&gt;c&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;st&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;chi2&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;pdf&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;k&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;a id="rest_code_cc3ae6870b534a5eb55e0d2447174adb-7" name="rest_code_cc3ae6870b534a5eb55e0d2447174adb-7" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_cc3ae6870b534a5eb55e0d2447174adb-7"&gt;&lt;/a&gt;    &lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;plot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;c&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;label&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'k = '&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="nb"&gt;str&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;k&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;color&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;colors&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;&lt;span class="n"&gt;linewidth&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_cc3ae6870b534a5eb55e0d2447174adb-8" name="rest_code_cc3ae6870b534a5eb55e0d2447174adb-8" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_cc3ae6870b534a5eb55e0d2447174adb-8"&gt;&lt;/a&gt;    &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;+=&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;
&lt;a id="rest_code_cc3ae6870b534a5eb55e0d2447174adb-9" name="rest_code_cc3ae6870b534a5eb55e0d2447174adb-9" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_cc3ae6870b534a5eb55e0d2447174adb-9"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xlim&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_cc3ae6870b534a5eb55e0d2447174adb-10" name="rest_code_cc3ae6870b534a5eb55e0d2447174adb-10" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_cc3ae6870b534a5eb55e0d2447174adb-10"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ylim&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mf"&gt;0.5&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_cc3ae6870b534a5eb55e0d2447174adb-11" name="rest_code_cc3ae6870b534a5eb55e0d2447174adb-11" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_cc3ae6870b534a5eb55e0d2447174adb-11"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'x'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_cc3ae6870b534a5eb55e0d2447174adb-12" name="rest_code_cc3ae6870b534a5eb55e0d2447174adb-12" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_cc3ae6870b534a5eb55e0d2447174adb-12"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ylabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'f(x)'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_cc3ae6870b534a5eb55e0d2447174adb-13" name="rest_code_cc3ae6870b534a5eb55e0d2447174adb-13" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_cc3ae6870b534a5eb55e0d2447174adb-13"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;legend&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;img alt="../output_2_1.png" src="https://personalpages.manchester.ac.uk/staff/thomas.house/output_2_1.png"&gt;
&lt;p&gt;The Wishart emerges when we make &lt;span class="raw-html"&gt;\(k \)&lt;/span&gt; observations each with &lt;span class="raw-html"&gt;\(p \)&lt;/span&gt; variables; the
sampling distribution for the covariance matrix of these data if the population is multivariate normal is
Wishart and has probability density function&lt;/p&gt;
&lt;p&gt;&lt;span class="raw-html"&gt;$$ f_{\mathcal{W}_p(k,\boldsymbol{\Sigma})}(\boldsymbol{V}) = \frac{\mathrm{det}(\boldsymbol{V})^{\frac{k - p - 1}{2}}}{2^{ \frac{k p}{2} } \mathrm{det}(\boldsymbol{\Sigma})^\frac{k}{2} \Gamma_p\!\left(\frac{k}{2} \right)} \exp\left( -\frac12 \mathrm{Tr}(\boldsymbol{\Sigma}^{-1} \boldsymbol{V}) \right) . $$&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;In general, this cannot be visualised, but for the &lt;span class="raw-html"&gt;\(p=2 \)&lt;/span&gt; case, one option is to pick random
numbers from this distribution and then produce a three-dimensional scatter plot of these. The code and results
below show that this can be seen as behaving somewhat like the chi-squared distribution that it generalises as
the degrees of freedom &lt;span class="raw-html"&gt;\(k \)&lt;/span&gt; are increased.&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code ipython3"&gt;&lt;a id="rest_code_2a204a6d0b0b40ddb307802c80ca763c-1" name="rest_code_2a204a6d0b0b40ddb307802c80ca763c-1" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_2a204a6d0b0b40ddb307802c80ca763c-1"&gt;&lt;/a&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_2a204a6d0b0b40ddb307802c80ca763c-2" name="rest_code_2a204a6d0b0b40ddb307802c80ca763c-2" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_2a204a6d0b0b40ddb307802c80ca763c-2"&gt;&lt;/a&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_2a204a6d0b0b40ddb307802c80ca763c-3" name="rest_code_2a204a6d0b0b40ddb307802c80ca763c-3" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_2a204a6d0b0b40ddb307802c80ca763c-3"&gt;&lt;/a&gt;&lt;span class="n"&gt;z&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_2a204a6d0b0b40ddb307802c80ca763c-4" name="rest_code_2a204a6d0b0b40ddb307802c80ca763c-4" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_2a204a6d0b0b40ddb307802c80ca763c-4"&gt;&lt;/a&gt;&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_2a204a6d0b0b40ddb307802c80ca763c-5" name="rest_code_2a204a6d0b0b40ddb307802c80ca763c-5" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_2a204a6d0b0b40ddb307802c80ca763c-5"&gt;&lt;/a&gt;    &lt;span class="n"&gt;M&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;st&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;wishart&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;rvs&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;scale&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;Sig1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;size&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_2a204a6d0b0b40ddb307802c80ca763c-6" name="rest_code_2a204a6d0b0b40ddb307802c80ca763c-6" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_2a204a6d0b0b40ddb307802c80ca763c-6"&gt;&lt;/a&gt;    &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;M&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_2a204a6d0b0b40ddb307802c80ca763c-7" name="rest_code_2a204a6d0b0b40ddb307802c80ca763c-7" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_2a204a6d0b0b40ddb307802c80ca763c-7"&gt;&lt;/a&gt;    &lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;M&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_2a204a6d0b0b40ddb307802c80ca763c-8" name="rest_code_2a204a6d0b0b40ddb307802c80ca763c-8" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_2a204a6d0b0b40ddb307802c80ca763c-8"&gt;&lt;/a&gt;    &lt;span class="n"&gt;z&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;M&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_2a204a6d0b0b40ddb307802c80ca763c-9" name="rest_code_2a204a6d0b0b40ddb307802c80ca763c-9" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_2a204a6d0b0b40ddb307802c80ca763c-9"&gt;&lt;/a&gt;&lt;span class="n"&gt;fig&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;figure&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;figsize&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;8&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_2a204a6d0b0b40ddb307802c80ca763c-10" name="rest_code_2a204a6d0b0b40ddb307802c80ca763c-10" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_2a204a6d0b0b40ddb307802c80ca763c-10"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;fig&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;add_subplot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;111&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;projection&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'3d'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_2a204a6d0b0b40ddb307802c80ca763c-11" name="rest_code_2a204a6d0b0b40ddb307802c80ca763c-11" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_2a204a6d0b0b40ddb307802c80ca763c-11"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;scatter3D&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;z&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;marker&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'o'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;c&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;z&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;cmap&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'seismic'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_2a204a6d0b0b40ddb307802c80ca763c-12" name="rest_code_2a204a6d0b0b40ddb307802c80ca763c-12" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_2a204a6d0b0b40ddb307802c80ca763c-12"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_xlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'V11'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_2a204a6d0b0b40ddb307802c80ca763c-13" name="rest_code_2a204a6d0b0b40ddb307802c80ca763c-13" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_2a204a6d0b0b40ddb307802c80ca763c-13"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_ylabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'V22'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_2a204a6d0b0b40ddb307802c80ca763c-14" name="rest_code_2a204a6d0b0b40ddb307802c80ca763c-14" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_2a204a6d0b0b40ddb307802c80ca763c-14"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_zlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'V12=V21'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_2a204a6d0b0b40ddb307802c80ca763c-15" name="rest_code_2a204a6d0b0b40ddb307802c80ca763c-15" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_2a204a6d0b0b40ddb307802c80ca763c-15"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_xlim&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;30&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_2a204a6d0b0b40ddb307802c80ca763c-16" name="rest_code_2a204a6d0b0b40ddb307802c80ca763c-16" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_2a204a6d0b0b40ddb307802c80ca763c-16"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_ylim&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;70&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_2a204a6d0b0b40ddb307802c80ca763c-17" name="rest_code_2a204a6d0b0b40ddb307802c80ca763c-17" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_2a204a6d0b0b40ddb307802c80ca763c-17"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_zlim&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;30&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_2a204a6d0b0b40ddb307802c80ca763c-18" name="rest_code_2a204a6d0b0b40ddb307802c80ca763c-18" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_2a204a6d0b0b40ddb307802c80ca763c-18"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;tight_layout&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;img alt="../output_3_0.png" src="https://personalpages.manchester.ac.uk/staff/thomas.house/output_3_0.png"&gt;
&lt;div class="code"&gt;&lt;pre class="code ipython3"&gt;&lt;a id="rest_code_a676d237e9c8464d88906f5cf10f4924-1" name="rest_code_a676d237e9c8464d88906f5cf10f4924-1" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_a676d237e9c8464d88906f5cf10f4924-1"&gt;&lt;/a&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_a676d237e9c8464d88906f5cf10f4924-2" name="rest_code_a676d237e9c8464d88906f5cf10f4924-2" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_a676d237e9c8464d88906f5cf10f4924-2"&gt;&lt;/a&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_a676d237e9c8464d88906f5cf10f4924-3" name="rest_code_a676d237e9c8464d88906f5cf10f4924-3" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_a676d237e9c8464d88906f5cf10f4924-3"&gt;&lt;/a&gt;&lt;span class="n"&gt;z&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_a676d237e9c8464d88906f5cf10f4924-4" name="rest_code_a676d237e9c8464d88906f5cf10f4924-4" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_a676d237e9c8464d88906f5cf10f4924-4"&gt;&lt;/a&gt;&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_a676d237e9c8464d88906f5cf10f4924-5" name="rest_code_a676d237e9c8464d88906f5cf10f4924-5" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_a676d237e9c8464d88906f5cf10f4924-5"&gt;&lt;/a&gt;    &lt;span class="n"&gt;M&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;st&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;wishart&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;rvs&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;scale&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;Sig1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;size&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_a676d237e9c8464d88906f5cf10f4924-6" name="rest_code_a676d237e9c8464d88906f5cf10f4924-6" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_a676d237e9c8464d88906f5cf10f4924-6"&gt;&lt;/a&gt;    &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;M&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_a676d237e9c8464d88906f5cf10f4924-7" name="rest_code_a676d237e9c8464d88906f5cf10f4924-7" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_a676d237e9c8464d88906f5cf10f4924-7"&gt;&lt;/a&gt;    &lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;M&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_a676d237e9c8464d88906f5cf10f4924-8" name="rest_code_a676d237e9c8464d88906f5cf10f4924-8" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_a676d237e9c8464d88906f5cf10f4924-8"&gt;&lt;/a&gt;    &lt;span class="n"&gt;z&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;M&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_a676d237e9c8464d88906f5cf10f4924-9" name="rest_code_a676d237e9c8464d88906f5cf10f4924-9" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_a676d237e9c8464d88906f5cf10f4924-9"&gt;&lt;/a&gt;&lt;span class="n"&gt;fig&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;figure&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;figsize&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;8&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_a676d237e9c8464d88906f5cf10f4924-10" name="rest_code_a676d237e9c8464d88906f5cf10f4924-10" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_a676d237e9c8464d88906f5cf10f4924-10"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;fig&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;add_subplot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;111&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;projection&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'3d'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_a676d237e9c8464d88906f5cf10f4924-11" name="rest_code_a676d237e9c8464d88906f5cf10f4924-11" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_a676d237e9c8464d88906f5cf10f4924-11"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;scatter3D&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;z&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;marker&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'o'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;c&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;z&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;cmap&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'seismic'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_a676d237e9c8464d88906f5cf10f4924-12" name="rest_code_a676d237e9c8464d88906f5cf10f4924-12" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_a676d237e9c8464d88906f5cf10f4924-12"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_xlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'V11'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_a676d237e9c8464d88906f5cf10f4924-13" name="rest_code_a676d237e9c8464d88906f5cf10f4924-13" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_a676d237e9c8464d88906f5cf10f4924-13"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_ylabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'V22'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_a676d237e9c8464d88906f5cf10f4924-14" name="rest_code_a676d237e9c8464d88906f5cf10f4924-14" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_a676d237e9c8464d88906f5cf10f4924-14"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_zlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'V12=V21'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_a676d237e9c8464d88906f5cf10f4924-15" name="rest_code_a676d237e9c8464d88906f5cf10f4924-15" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_a676d237e9c8464d88906f5cf10f4924-15"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_xlim&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;30&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_a676d237e9c8464d88906f5cf10f4924-16" name="rest_code_a676d237e9c8464d88906f5cf10f4924-16" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_a676d237e9c8464d88906f5cf10f4924-16"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_ylim&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;70&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_a676d237e9c8464d88906f5cf10f4924-17" name="rest_code_a676d237e9c8464d88906f5cf10f4924-17" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_a676d237e9c8464d88906f5cf10f4924-17"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_zlim&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;30&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_a676d237e9c8464d88906f5cf10f4924-18" name="rest_code_a676d237e9c8464d88906f5cf10f4924-18" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_a676d237e9c8464d88906f5cf10f4924-18"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;tight_layout&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;img alt="../output_4_0.png" src="https://personalpages.manchester.ac.uk/staff/thomas.house/output_4_0.png"&gt;
&lt;div class="code"&gt;&lt;pre class="code ipython3"&gt;&lt;a id="rest_code_76116a44a2574bca8e27ed73d13dd183-1" name="rest_code_76116a44a2574bca8e27ed73d13dd183-1" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_76116a44a2574bca8e27ed73d13dd183-1"&gt;&lt;/a&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_76116a44a2574bca8e27ed73d13dd183-2" name="rest_code_76116a44a2574bca8e27ed73d13dd183-2" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_76116a44a2574bca8e27ed73d13dd183-2"&gt;&lt;/a&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_76116a44a2574bca8e27ed73d13dd183-3" name="rest_code_76116a44a2574bca8e27ed73d13dd183-3" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_76116a44a2574bca8e27ed73d13dd183-3"&gt;&lt;/a&gt;&lt;span class="n"&gt;z&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_76116a44a2574bca8e27ed73d13dd183-4" name="rest_code_76116a44a2574bca8e27ed73d13dd183-4" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_76116a44a2574bca8e27ed73d13dd183-4"&gt;&lt;/a&gt;&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_76116a44a2574bca8e27ed73d13dd183-5" name="rest_code_76116a44a2574bca8e27ed73d13dd183-5" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_76116a44a2574bca8e27ed73d13dd183-5"&gt;&lt;/a&gt;    &lt;span class="n"&gt;M&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;st&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;wishart&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;rvs&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;scale&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;Sig1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;size&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_76116a44a2574bca8e27ed73d13dd183-6" name="rest_code_76116a44a2574bca8e27ed73d13dd183-6" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_76116a44a2574bca8e27ed73d13dd183-6"&gt;&lt;/a&gt;    &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;M&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_76116a44a2574bca8e27ed73d13dd183-7" name="rest_code_76116a44a2574bca8e27ed73d13dd183-7" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_76116a44a2574bca8e27ed73d13dd183-7"&gt;&lt;/a&gt;    &lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;M&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_76116a44a2574bca8e27ed73d13dd183-8" name="rest_code_76116a44a2574bca8e27ed73d13dd183-8" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_76116a44a2574bca8e27ed73d13dd183-8"&gt;&lt;/a&gt;    &lt;span class="n"&gt;z&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;M&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_76116a44a2574bca8e27ed73d13dd183-9" name="rest_code_76116a44a2574bca8e27ed73d13dd183-9" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_76116a44a2574bca8e27ed73d13dd183-9"&gt;&lt;/a&gt;&lt;span class="n"&gt;fig&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;figure&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;figsize&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;8&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_76116a44a2574bca8e27ed73d13dd183-10" name="rest_code_76116a44a2574bca8e27ed73d13dd183-10" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_76116a44a2574bca8e27ed73d13dd183-10"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;fig&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;add_subplot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;111&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;projection&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'3d'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_76116a44a2574bca8e27ed73d13dd183-11" name="rest_code_76116a44a2574bca8e27ed73d13dd183-11" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_76116a44a2574bca8e27ed73d13dd183-11"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;scatter3D&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;z&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;marker&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'o'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;c&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;z&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;cmap&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'seismic'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_76116a44a2574bca8e27ed73d13dd183-12" name="rest_code_76116a44a2574bca8e27ed73d13dd183-12" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_76116a44a2574bca8e27ed73d13dd183-12"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_xlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'V11'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_76116a44a2574bca8e27ed73d13dd183-13" name="rest_code_76116a44a2574bca8e27ed73d13dd183-13" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_76116a44a2574bca8e27ed73d13dd183-13"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_ylabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'V22'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_76116a44a2574bca8e27ed73d13dd183-14" name="rest_code_76116a44a2574bca8e27ed73d13dd183-14" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_76116a44a2574bca8e27ed73d13dd183-14"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_zlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'V12=V21'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_76116a44a2574bca8e27ed73d13dd183-15" name="rest_code_76116a44a2574bca8e27ed73d13dd183-15" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_76116a44a2574bca8e27ed73d13dd183-15"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_xlim&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;30&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_76116a44a2574bca8e27ed73d13dd183-16" name="rest_code_76116a44a2574bca8e27ed73d13dd183-16" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_76116a44a2574bca8e27ed73d13dd183-16"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_ylim&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;70&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_76116a44a2574bca8e27ed73d13dd183-17" name="rest_code_76116a44a2574bca8e27ed73d13dd183-17" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_76116a44a2574bca8e27ed73d13dd183-17"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_zlim&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;30&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_76116a44a2574bca8e27ed73d13dd183-18" name="rest_code_76116a44a2574bca8e27ed73d13dd183-18" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_76116a44a2574bca8e27ed73d13dd183-18"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;tight_layout&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;img alt="../output_5_0.png" src="https://personalpages.manchester.ac.uk/staff/thomas.house/output_5_0.png"&gt;&lt;/body&gt;&lt;/html&gt;

&lt;div class="code"&gt;&lt;pre class="code ipython3"&gt;&lt;a id="rest_code_3d31a68eeecd430b9d94ef668b0d27bf-1" name="rest_code_3d31a68eeecd430b9d94ef668b0d27bf-1" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_3d31a68eeecd430b9d94ef668b0d27bf-1"&gt;&lt;/a&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;random&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;seed&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;42&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_3d31a68eeecd430b9d94ef668b0d27bf-2" name="rest_code_3d31a68eeecd430b9d94ef668b0d27bf-2" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_3d31a68eeecd430b9d94ef668b0d27bf-2"&gt;&lt;/a&gt;&lt;span class="n"&gt;Sig1&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;array&lt;/span&gt;&lt;span class="p"&gt;([[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mf"&gt;0.75&lt;/span&gt;&lt;span class="p"&gt;],[&lt;/span&gt;&lt;span class="mf"&gt;0.75&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;]])&lt;/span&gt;
&lt;a id="rest_code_3d31a68eeecd430b9d94ef668b0d27bf-3" name="rest_code_3d31a68eeecd430b9d94ef668b0d27bf-3" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_3d31a68eeecd430b9d94ef668b0d27bf-3"&gt;&lt;/a&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;1000&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="code"&gt;&lt;pre class="code ipython3"&gt;&lt;a id="rest_code_cc3ae6870b534a5eb55e0d2447174adb-1" name="rest_code_cc3ae6870b534a5eb55e0d2447174adb-1" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_cc3ae6870b534a5eb55e0d2447174adb-1"&gt;&lt;/a&gt;&lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;linspace&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1000&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_cc3ae6870b534a5eb55e0d2447174adb-2" name="rest_code_cc3ae6870b534a5eb55e0d2447174adb-2" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_cc3ae6870b534a5eb55e0d2447174adb-2"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;figure&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;figsize&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;8&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_cc3ae6870b534a5eb55e0d2447174adb-3" name="rest_code_cc3ae6870b534a5eb55e0d2447174adb-3" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_cc3ae6870b534a5eb55e0d2447174adb-3"&gt;&lt;/a&gt;&lt;span class="n"&gt;colors&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;cm&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Accent&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;linspace&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_cc3ae6870b534a5eb55e0d2447174adb-4" name="rest_code_cc3ae6870b534a5eb55e0d2447174adb-4" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_cc3ae6870b534a5eb55e0d2447174adb-4"&gt;&lt;/a&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;
&lt;a id="rest_code_cc3ae6870b534a5eb55e0d2447174adb-5" name="rest_code_cc3ae6870b534a5eb55e0d2447174adb-5" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_cc3ae6870b534a5eb55e0d2447174adb-5"&gt;&lt;/a&gt;&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;k&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_cc3ae6870b534a5eb55e0d2447174adb-6" name="rest_code_cc3ae6870b534a5eb55e0d2447174adb-6" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_cc3ae6870b534a5eb55e0d2447174adb-6"&gt;&lt;/a&gt;    &lt;span class="n"&gt;c&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;st&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;chi2&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;pdf&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;k&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;a id="rest_code_cc3ae6870b534a5eb55e0d2447174adb-7" name="rest_code_cc3ae6870b534a5eb55e0d2447174adb-7" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_cc3ae6870b534a5eb55e0d2447174adb-7"&gt;&lt;/a&gt;    &lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;plot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;c&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;label&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'k = '&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="nb"&gt;str&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;k&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;color&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;colors&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;&lt;span class="n"&gt;linewidth&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_cc3ae6870b534a5eb55e0d2447174adb-8" name="rest_code_cc3ae6870b534a5eb55e0d2447174adb-8" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_cc3ae6870b534a5eb55e0d2447174adb-8"&gt;&lt;/a&gt;    &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;+=&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;
&lt;a id="rest_code_cc3ae6870b534a5eb55e0d2447174adb-9" name="rest_code_cc3ae6870b534a5eb55e0d2447174adb-9" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_cc3ae6870b534a5eb55e0d2447174adb-9"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xlim&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_cc3ae6870b534a5eb55e0d2447174adb-10" name="rest_code_cc3ae6870b534a5eb55e0d2447174adb-10" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_cc3ae6870b534a5eb55e0d2447174adb-10"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ylim&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mf"&gt;0.5&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_cc3ae6870b534a5eb55e0d2447174adb-11" name="rest_code_cc3ae6870b534a5eb55e0d2447174adb-11" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_cc3ae6870b534a5eb55e0d2447174adb-11"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'x'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_cc3ae6870b534a5eb55e0d2447174adb-12" name="rest_code_cc3ae6870b534a5eb55e0d2447174adb-12" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_cc3ae6870b534a5eb55e0d2447174adb-12"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ylabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'f(x)'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_cc3ae6870b534a5eb55e0d2447174adb-13" name="rest_code_cc3ae6870b534a5eb55e0d2447174adb-13" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_cc3ae6870b534a5eb55e0d2447174adb-13"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;legend&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;img alt="../output_2_1.png" src="https://personalpages.manchester.ac.uk/staff/thomas.house/output_2_1.png"&gt;
&lt;p&gt;The Wishart emerges when we make &lt;span class="raw-html"&gt;\(k \)&lt;/span&gt; observations each with &lt;span class="raw-html"&gt;\(p \)&lt;/span&gt; variables; the
sampling distribution for the covariance matrix of these data if the population is multivariate normal is
Wishart and has probability density function&lt;/p&gt;
&lt;p&gt;&lt;span class="raw-html"&gt;$$ f_{\mathcal{W}_p(k,\boldsymbol{\Sigma})}(\boldsymbol{V}) = \frac{\mathrm{det}(\boldsymbol{V})^{\frac{k - p - 1}{2}}}{2^{ \frac{k p}{2} } \mathrm{det}(\boldsymbol{\Sigma})^\frac{k}{2} \Gamma_p\!\left(\frac{k}{2} \right)} \exp\left( -\frac12 \mathrm{Tr}(\boldsymbol{\Sigma}^{-1} \boldsymbol{V}) \right) . $$&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;In general, this cannot be visualised, but for the &lt;span class="raw-html"&gt;\(p=2 \)&lt;/span&gt; case, one option is to pick random
numbers from this distribution and then produce a three-dimensional scatter plot of these. The code and results
below show that this can be seen as behaving somewhat like the chi-squared distribution that it generalises as
the degrees of freedom &lt;span class="raw-html"&gt;\(k \)&lt;/span&gt; are increased.&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code ipython3"&gt;&lt;a id="rest_code_2a204a6d0b0b40ddb307802c80ca763c-1" name="rest_code_2a204a6d0b0b40ddb307802c80ca763c-1" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_2a204a6d0b0b40ddb307802c80ca763c-1"&gt;&lt;/a&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_2a204a6d0b0b40ddb307802c80ca763c-2" name="rest_code_2a204a6d0b0b40ddb307802c80ca763c-2" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_2a204a6d0b0b40ddb307802c80ca763c-2"&gt;&lt;/a&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_2a204a6d0b0b40ddb307802c80ca763c-3" name="rest_code_2a204a6d0b0b40ddb307802c80ca763c-3" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_2a204a6d0b0b40ddb307802c80ca763c-3"&gt;&lt;/a&gt;&lt;span class="n"&gt;z&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_2a204a6d0b0b40ddb307802c80ca763c-4" name="rest_code_2a204a6d0b0b40ddb307802c80ca763c-4" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_2a204a6d0b0b40ddb307802c80ca763c-4"&gt;&lt;/a&gt;&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_2a204a6d0b0b40ddb307802c80ca763c-5" name="rest_code_2a204a6d0b0b40ddb307802c80ca763c-5" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_2a204a6d0b0b40ddb307802c80ca763c-5"&gt;&lt;/a&gt;    &lt;span class="n"&gt;M&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;st&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;wishart&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;rvs&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;scale&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;Sig1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;size&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_2a204a6d0b0b40ddb307802c80ca763c-6" name="rest_code_2a204a6d0b0b40ddb307802c80ca763c-6" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_2a204a6d0b0b40ddb307802c80ca763c-6"&gt;&lt;/a&gt;    &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;M&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_2a204a6d0b0b40ddb307802c80ca763c-7" name="rest_code_2a204a6d0b0b40ddb307802c80ca763c-7" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_2a204a6d0b0b40ddb307802c80ca763c-7"&gt;&lt;/a&gt;    &lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;M&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_2a204a6d0b0b40ddb307802c80ca763c-8" name="rest_code_2a204a6d0b0b40ddb307802c80ca763c-8" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_2a204a6d0b0b40ddb307802c80ca763c-8"&gt;&lt;/a&gt;    &lt;span class="n"&gt;z&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;M&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_2a204a6d0b0b40ddb307802c80ca763c-9" name="rest_code_2a204a6d0b0b40ddb307802c80ca763c-9" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_2a204a6d0b0b40ddb307802c80ca763c-9"&gt;&lt;/a&gt;&lt;span class="n"&gt;fig&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;figure&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;figsize&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;8&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_2a204a6d0b0b40ddb307802c80ca763c-10" name="rest_code_2a204a6d0b0b40ddb307802c80ca763c-10" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_2a204a6d0b0b40ddb307802c80ca763c-10"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;fig&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;add_subplot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;111&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;projection&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'3d'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_2a204a6d0b0b40ddb307802c80ca763c-11" name="rest_code_2a204a6d0b0b40ddb307802c80ca763c-11" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_2a204a6d0b0b40ddb307802c80ca763c-11"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;scatter3D&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;z&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;marker&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'o'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;c&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;z&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;cmap&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'seismic'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_2a204a6d0b0b40ddb307802c80ca763c-12" name="rest_code_2a204a6d0b0b40ddb307802c80ca763c-12" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_2a204a6d0b0b40ddb307802c80ca763c-12"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_xlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'V11'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_2a204a6d0b0b40ddb307802c80ca763c-13" name="rest_code_2a204a6d0b0b40ddb307802c80ca763c-13" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_2a204a6d0b0b40ddb307802c80ca763c-13"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_ylabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'V22'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_2a204a6d0b0b40ddb307802c80ca763c-14" name="rest_code_2a204a6d0b0b40ddb307802c80ca763c-14" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_2a204a6d0b0b40ddb307802c80ca763c-14"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_zlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'V12=V21'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_2a204a6d0b0b40ddb307802c80ca763c-15" name="rest_code_2a204a6d0b0b40ddb307802c80ca763c-15" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_2a204a6d0b0b40ddb307802c80ca763c-15"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_xlim&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;30&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_2a204a6d0b0b40ddb307802c80ca763c-16" name="rest_code_2a204a6d0b0b40ddb307802c80ca763c-16" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_2a204a6d0b0b40ddb307802c80ca763c-16"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_ylim&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;70&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_2a204a6d0b0b40ddb307802c80ca763c-17" name="rest_code_2a204a6d0b0b40ddb307802c80ca763c-17" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_2a204a6d0b0b40ddb307802c80ca763c-17"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_zlim&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;30&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_2a204a6d0b0b40ddb307802c80ca763c-18" name="rest_code_2a204a6d0b0b40ddb307802c80ca763c-18" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_2a204a6d0b0b40ddb307802c80ca763c-18"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;tight_layout&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;img alt="../output_3_0.png" src="https://personalpages.manchester.ac.uk/staff/thomas.house/output_3_0.png"&gt;
&lt;div class="code"&gt;&lt;pre class="code ipython3"&gt;&lt;a id="rest_code_a676d237e9c8464d88906f5cf10f4924-1" name="rest_code_a676d237e9c8464d88906f5cf10f4924-1" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_a676d237e9c8464d88906f5cf10f4924-1"&gt;&lt;/a&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_a676d237e9c8464d88906f5cf10f4924-2" name="rest_code_a676d237e9c8464d88906f5cf10f4924-2" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_a676d237e9c8464d88906f5cf10f4924-2"&gt;&lt;/a&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_a676d237e9c8464d88906f5cf10f4924-3" name="rest_code_a676d237e9c8464d88906f5cf10f4924-3" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_a676d237e9c8464d88906f5cf10f4924-3"&gt;&lt;/a&gt;&lt;span class="n"&gt;z&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_a676d237e9c8464d88906f5cf10f4924-4" name="rest_code_a676d237e9c8464d88906f5cf10f4924-4" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_a676d237e9c8464d88906f5cf10f4924-4"&gt;&lt;/a&gt;&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_a676d237e9c8464d88906f5cf10f4924-5" name="rest_code_a676d237e9c8464d88906f5cf10f4924-5" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_a676d237e9c8464d88906f5cf10f4924-5"&gt;&lt;/a&gt;    &lt;span class="n"&gt;M&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;st&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;wishart&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;rvs&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;scale&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;Sig1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;size&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_a676d237e9c8464d88906f5cf10f4924-6" name="rest_code_a676d237e9c8464d88906f5cf10f4924-6" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_a676d237e9c8464d88906f5cf10f4924-6"&gt;&lt;/a&gt;    &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;M&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_a676d237e9c8464d88906f5cf10f4924-7" name="rest_code_a676d237e9c8464d88906f5cf10f4924-7" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_a676d237e9c8464d88906f5cf10f4924-7"&gt;&lt;/a&gt;    &lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;M&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_a676d237e9c8464d88906f5cf10f4924-8" name="rest_code_a676d237e9c8464d88906f5cf10f4924-8" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_a676d237e9c8464d88906f5cf10f4924-8"&gt;&lt;/a&gt;    &lt;span class="n"&gt;z&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;M&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_a676d237e9c8464d88906f5cf10f4924-9" name="rest_code_a676d237e9c8464d88906f5cf10f4924-9" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_a676d237e9c8464d88906f5cf10f4924-9"&gt;&lt;/a&gt;&lt;span class="n"&gt;fig&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;figure&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;figsize&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;8&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_a676d237e9c8464d88906f5cf10f4924-10" name="rest_code_a676d237e9c8464d88906f5cf10f4924-10" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_a676d237e9c8464d88906f5cf10f4924-10"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;fig&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;add_subplot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;111&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;projection&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'3d'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_a676d237e9c8464d88906f5cf10f4924-11" name="rest_code_a676d237e9c8464d88906f5cf10f4924-11" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_a676d237e9c8464d88906f5cf10f4924-11"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;scatter3D&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;z&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;marker&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'o'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;c&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;z&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;cmap&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'seismic'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_a676d237e9c8464d88906f5cf10f4924-12" name="rest_code_a676d237e9c8464d88906f5cf10f4924-12" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_a676d237e9c8464d88906f5cf10f4924-12"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_xlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'V11'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_a676d237e9c8464d88906f5cf10f4924-13" name="rest_code_a676d237e9c8464d88906f5cf10f4924-13" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_a676d237e9c8464d88906f5cf10f4924-13"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_ylabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'V22'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_a676d237e9c8464d88906f5cf10f4924-14" name="rest_code_a676d237e9c8464d88906f5cf10f4924-14" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_a676d237e9c8464d88906f5cf10f4924-14"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_zlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'V12=V21'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_a676d237e9c8464d88906f5cf10f4924-15" name="rest_code_a676d237e9c8464d88906f5cf10f4924-15" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_a676d237e9c8464d88906f5cf10f4924-15"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_xlim&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;30&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_a676d237e9c8464d88906f5cf10f4924-16" name="rest_code_a676d237e9c8464d88906f5cf10f4924-16" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_a676d237e9c8464d88906f5cf10f4924-16"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_ylim&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;70&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_a676d237e9c8464d88906f5cf10f4924-17" name="rest_code_a676d237e9c8464d88906f5cf10f4924-17" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_a676d237e9c8464d88906f5cf10f4924-17"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_zlim&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;30&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_a676d237e9c8464d88906f5cf10f4924-18" name="rest_code_a676d237e9c8464d88906f5cf10f4924-18" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_a676d237e9c8464d88906f5cf10f4924-18"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;tight_layout&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;img alt="../output_4_0.png" src="https://personalpages.manchester.ac.uk/staff/thomas.house/output_4_0.png"&gt;
&lt;div class="code"&gt;&lt;pre class="code ipython3"&gt;&lt;a id="rest_code_76116a44a2574bca8e27ed73d13dd183-1" name="rest_code_76116a44a2574bca8e27ed73d13dd183-1" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_76116a44a2574bca8e27ed73d13dd183-1"&gt;&lt;/a&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_76116a44a2574bca8e27ed73d13dd183-2" name="rest_code_76116a44a2574bca8e27ed73d13dd183-2" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_76116a44a2574bca8e27ed73d13dd183-2"&gt;&lt;/a&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_76116a44a2574bca8e27ed73d13dd183-3" name="rest_code_76116a44a2574bca8e27ed73d13dd183-3" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_76116a44a2574bca8e27ed73d13dd183-3"&gt;&lt;/a&gt;&lt;span class="n"&gt;z&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_76116a44a2574bca8e27ed73d13dd183-4" name="rest_code_76116a44a2574bca8e27ed73d13dd183-4" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_76116a44a2574bca8e27ed73d13dd183-4"&gt;&lt;/a&gt;&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_76116a44a2574bca8e27ed73d13dd183-5" name="rest_code_76116a44a2574bca8e27ed73d13dd183-5" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_76116a44a2574bca8e27ed73d13dd183-5"&gt;&lt;/a&gt;    &lt;span class="n"&gt;M&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;st&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;wishart&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;rvs&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;scale&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;Sig1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;size&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_76116a44a2574bca8e27ed73d13dd183-6" name="rest_code_76116a44a2574bca8e27ed73d13dd183-6" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_76116a44a2574bca8e27ed73d13dd183-6"&gt;&lt;/a&gt;    &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;M&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_76116a44a2574bca8e27ed73d13dd183-7" name="rest_code_76116a44a2574bca8e27ed73d13dd183-7" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_76116a44a2574bca8e27ed73d13dd183-7"&gt;&lt;/a&gt;    &lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;M&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_76116a44a2574bca8e27ed73d13dd183-8" name="rest_code_76116a44a2574bca8e27ed73d13dd183-8" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_76116a44a2574bca8e27ed73d13dd183-8"&gt;&lt;/a&gt;    &lt;span class="n"&gt;z&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;M&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_76116a44a2574bca8e27ed73d13dd183-9" name="rest_code_76116a44a2574bca8e27ed73d13dd183-9" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_76116a44a2574bca8e27ed73d13dd183-9"&gt;&lt;/a&gt;&lt;span class="n"&gt;fig&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;figure&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;figsize&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;8&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_76116a44a2574bca8e27ed73d13dd183-10" name="rest_code_76116a44a2574bca8e27ed73d13dd183-10" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_76116a44a2574bca8e27ed73d13dd183-10"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;fig&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;add_subplot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;111&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;projection&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'3d'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_76116a44a2574bca8e27ed73d13dd183-11" name="rest_code_76116a44a2574bca8e27ed73d13dd183-11" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_76116a44a2574bca8e27ed73d13dd183-11"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;scatter3D&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;z&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;marker&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'o'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;c&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;z&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;cmap&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'seismic'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_76116a44a2574bca8e27ed73d13dd183-12" name="rest_code_76116a44a2574bca8e27ed73d13dd183-12" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_76116a44a2574bca8e27ed73d13dd183-12"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_xlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'V11'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_76116a44a2574bca8e27ed73d13dd183-13" name="rest_code_76116a44a2574bca8e27ed73d13dd183-13" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_76116a44a2574bca8e27ed73d13dd183-13"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_ylabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'V22'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_76116a44a2574bca8e27ed73d13dd183-14" name="rest_code_76116a44a2574bca8e27ed73d13dd183-14" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_76116a44a2574bca8e27ed73d13dd183-14"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_zlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'V12=V21'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_76116a44a2574bca8e27ed73d13dd183-15" name="rest_code_76116a44a2574bca8e27ed73d13dd183-15" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_76116a44a2574bca8e27ed73d13dd183-15"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_xlim&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;30&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_76116a44a2574bca8e27ed73d13dd183-16" name="rest_code_76116a44a2574bca8e27ed73d13dd183-16" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_76116a44a2574bca8e27ed73d13dd183-16"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_ylim&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;70&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_76116a44a2574bca8e27ed73d13dd183-17" name="rest_code_76116a44a2574bca8e27ed73d13dd183-17" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_76116a44a2574bca8e27ed73d13dd183-17"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_zlim&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;30&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_76116a44a2574bca8e27ed73d13dd183-18" name="rest_code_76116a44a2574bca8e27ed73d13dd183-18" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_76116a44a2574bca8e27ed73d13dd183-18"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;tight_layout&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;img alt="../output_5_0.png" src="https://personalpages.manchester.ac.uk/staff/thomas.house/output_5_0.png"&gt;&lt;/body&gt;&lt;/html&gt;

&lt;div class="code"&gt;&lt;pre class="code ipython3"&gt;&lt;a id="rest_code_cc3ae6870b534a5eb55e0d2447174adb-1" name="rest_code_cc3ae6870b534a5eb55e0d2447174adb-1" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_cc3ae6870b534a5eb55e0d2447174adb-1"&gt;&lt;/a&gt;&lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;linspace&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1000&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_cc3ae6870b534a5eb55e0d2447174adb-2" name="rest_code_cc3ae6870b534a5eb55e0d2447174adb-2" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_cc3ae6870b534a5eb55e0d2447174adb-2"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;figure&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;figsize&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;8&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_cc3ae6870b534a5eb55e0d2447174adb-3" name="rest_code_cc3ae6870b534a5eb55e0d2447174adb-3" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_cc3ae6870b534a5eb55e0d2447174adb-3"&gt;&lt;/a&gt;&lt;span class="n"&gt;colors&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;cm&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Accent&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;linspace&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_cc3ae6870b534a5eb55e0d2447174adb-4" name="rest_code_cc3ae6870b534a5eb55e0d2447174adb-4" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_cc3ae6870b534a5eb55e0d2447174adb-4"&gt;&lt;/a&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;
&lt;a id="rest_code_cc3ae6870b534a5eb55e0d2447174adb-5" name="rest_code_cc3ae6870b534a5eb55e0d2447174adb-5" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_cc3ae6870b534a5eb55e0d2447174adb-5"&gt;&lt;/a&gt;&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;k&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_cc3ae6870b534a5eb55e0d2447174adb-6" name="rest_code_cc3ae6870b534a5eb55e0d2447174adb-6" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_cc3ae6870b534a5eb55e0d2447174adb-6"&gt;&lt;/a&gt;    &lt;span class="n"&gt;c&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;st&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;chi2&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;pdf&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;k&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;a id="rest_code_cc3ae6870b534a5eb55e0d2447174adb-7" name="rest_code_cc3ae6870b534a5eb55e0d2447174adb-7" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_cc3ae6870b534a5eb55e0d2447174adb-7"&gt;&lt;/a&gt;    &lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;plot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;c&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;label&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'k = '&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="nb"&gt;str&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;k&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;color&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;colors&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;&lt;span class="n"&gt;linewidth&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_cc3ae6870b534a5eb55e0d2447174adb-8" name="rest_code_cc3ae6870b534a5eb55e0d2447174adb-8" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_cc3ae6870b534a5eb55e0d2447174adb-8"&gt;&lt;/a&gt;    &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;+=&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;
&lt;a id="rest_code_cc3ae6870b534a5eb55e0d2447174adb-9" name="rest_code_cc3ae6870b534a5eb55e0d2447174adb-9" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_cc3ae6870b534a5eb55e0d2447174adb-9"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xlim&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_cc3ae6870b534a5eb55e0d2447174adb-10" name="rest_code_cc3ae6870b534a5eb55e0d2447174adb-10" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_cc3ae6870b534a5eb55e0d2447174adb-10"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ylim&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mf"&gt;0.5&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_cc3ae6870b534a5eb55e0d2447174adb-11" name="rest_code_cc3ae6870b534a5eb55e0d2447174adb-11" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_cc3ae6870b534a5eb55e0d2447174adb-11"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'x'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_cc3ae6870b534a5eb55e0d2447174adb-12" name="rest_code_cc3ae6870b534a5eb55e0d2447174adb-12" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_cc3ae6870b534a5eb55e0d2447174adb-12"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ylabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'f(x)'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_cc3ae6870b534a5eb55e0d2447174adb-13" name="rest_code_cc3ae6870b534a5eb55e0d2447174adb-13" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_cc3ae6870b534a5eb55e0d2447174adb-13"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;legend&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;img alt="../output_2_1.png" src="https://personalpages.manchester.ac.uk/staff/thomas.house/output_2_1.png"&gt;
&lt;p&gt;The Wishart emerges when we make &lt;span class="raw-html"&gt;\(k \)&lt;/span&gt; observations each with &lt;span class="raw-html"&gt;\(p \)&lt;/span&gt; variables; the
sampling distribution for the covariance matrix of these data if the population is multivariate normal is
Wishart and has probability density function&lt;/p&gt;
&lt;p&gt;&lt;span class="raw-html"&gt;$$ f_{\mathcal{W}_p(k,\boldsymbol{\Sigma})}(\boldsymbol{V}) = \frac{\mathrm{det}(\boldsymbol{V})^{\frac{k - p - 1}{2}}}{2^{ \frac{k p}{2} } \mathrm{det}(\boldsymbol{\Sigma})^\frac{k}{2} \Gamma_p\!\left(\frac{k}{2} \right)} \exp\left( -\frac12 \mathrm{Tr}(\boldsymbol{\Sigma}^{-1} \boldsymbol{V}) \right) . $$&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;In general, this cannot be visualised, but for the &lt;span class="raw-html"&gt;\(p=2 \)&lt;/span&gt; case, one option is to pick random
numbers from this distribution and then produce a three-dimensional scatter plot of these. The code and results
below show that this can be seen as behaving somewhat like the chi-squared distribution that it generalises as
the degrees of freedom &lt;span class="raw-html"&gt;\(k \)&lt;/span&gt; are increased.&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code ipython3"&gt;&lt;a id="rest_code_2a204a6d0b0b40ddb307802c80ca763c-1" name="rest_code_2a204a6d0b0b40ddb307802c80ca763c-1" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_2a204a6d0b0b40ddb307802c80ca763c-1"&gt;&lt;/a&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_2a204a6d0b0b40ddb307802c80ca763c-2" name="rest_code_2a204a6d0b0b40ddb307802c80ca763c-2" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_2a204a6d0b0b40ddb307802c80ca763c-2"&gt;&lt;/a&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_2a204a6d0b0b40ddb307802c80ca763c-3" name="rest_code_2a204a6d0b0b40ddb307802c80ca763c-3" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_2a204a6d0b0b40ddb307802c80ca763c-3"&gt;&lt;/a&gt;&lt;span class="n"&gt;z&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_2a204a6d0b0b40ddb307802c80ca763c-4" name="rest_code_2a204a6d0b0b40ddb307802c80ca763c-4" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_2a204a6d0b0b40ddb307802c80ca763c-4"&gt;&lt;/a&gt;&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_2a204a6d0b0b40ddb307802c80ca763c-5" name="rest_code_2a204a6d0b0b40ddb307802c80ca763c-5" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_2a204a6d0b0b40ddb307802c80ca763c-5"&gt;&lt;/a&gt;    &lt;span class="n"&gt;M&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;st&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;wishart&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;rvs&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;scale&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;Sig1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;size&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_2a204a6d0b0b40ddb307802c80ca763c-6" name="rest_code_2a204a6d0b0b40ddb307802c80ca763c-6" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_2a204a6d0b0b40ddb307802c80ca763c-6"&gt;&lt;/a&gt;    &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;M&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_2a204a6d0b0b40ddb307802c80ca763c-7" name="rest_code_2a204a6d0b0b40ddb307802c80ca763c-7" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_2a204a6d0b0b40ddb307802c80ca763c-7"&gt;&lt;/a&gt;    &lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;M&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_2a204a6d0b0b40ddb307802c80ca763c-8" name="rest_code_2a204a6d0b0b40ddb307802c80ca763c-8" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_2a204a6d0b0b40ddb307802c80ca763c-8"&gt;&lt;/a&gt;    &lt;span class="n"&gt;z&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;M&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_2a204a6d0b0b40ddb307802c80ca763c-9" name="rest_code_2a204a6d0b0b40ddb307802c80ca763c-9" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_2a204a6d0b0b40ddb307802c80ca763c-9"&gt;&lt;/a&gt;&lt;span class="n"&gt;fig&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;figure&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;figsize&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;8&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_2a204a6d0b0b40ddb307802c80ca763c-10" name="rest_code_2a204a6d0b0b40ddb307802c80ca763c-10" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_2a204a6d0b0b40ddb307802c80ca763c-10"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;fig&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;add_subplot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;111&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;projection&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'3d'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_2a204a6d0b0b40ddb307802c80ca763c-11" name="rest_code_2a204a6d0b0b40ddb307802c80ca763c-11" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_2a204a6d0b0b40ddb307802c80ca763c-11"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;scatter3D&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;z&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;marker&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'o'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;c&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;z&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;cmap&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'seismic'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_2a204a6d0b0b40ddb307802c80ca763c-12" name="rest_code_2a204a6d0b0b40ddb307802c80ca763c-12" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_2a204a6d0b0b40ddb307802c80ca763c-12"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_xlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'V11'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_2a204a6d0b0b40ddb307802c80ca763c-13" name="rest_code_2a204a6d0b0b40ddb307802c80ca763c-13" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_2a204a6d0b0b40ddb307802c80ca763c-13"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_ylabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'V22'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_2a204a6d0b0b40ddb307802c80ca763c-14" name="rest_code_2a204a6d0b0b40ddb307802c80ca763c-14" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_2a204a6d0b0b40ddb307802c80ca763c-14"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_zlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'V12=V21'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_2a204a6d0b0b40ddb307802c80ca763c-15" name="rest_code_2a204a6d0b0b40ddb307802c80ca763c-15" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_2a204a6d0b0b40ddb307802c80ca763c-15"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_xlim&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;30&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_2a204a6d0b0b40ddb307802c80ca763c-16" name="rest_code_2a204a6d0b0b40ddb307802c80ca763c-16" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_2a204a6d0b0b40ddb307802c80ca763c-16"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_ylim&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;70&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_2a204a6d0b0b40ddb307802c80ca763c-17" name="rest_code_2a204a6d0b0b40ddb307802c80ca763c-17" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_2a204a6d0b0b40ddb307802c80ca763c-17"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_zlim&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;30&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_2a204a6d0b0b40ddb307802c80ca763c-18" name="rest_code_2a204a6d0b0b40ddb307802c80ca763c-18" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_2a204a6d0b0b40ddb307802c80ca763c-18"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;tight_layout&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;img alt="../output_3_0.png" src="https://personalpages.manchester.ac.uk/staff/thomas.house/output_3_0.png"&gt;
&lt;div class="code"&gt;&lt;pre class="code ipython3"&gt;&lt;a id="rest_code_a676d237e9c8464d88906f5cf10f4924-1" name="rest_code_a676d237e9c8464d88906f5cf10f4924-1" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_a676d237e9c8464d88906f5cf10f4924-1"&gt;&lt;/a&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_a676d237e9c8464d88906f5cf10f4924-2" name="rest_code_a676d237e9c8464d88906f5cf10f4924-2" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_a676d237e9c8464d88906f5cf10f4924-2"&gt;&lt;/a&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_a676d237e9c8464d88906f5cf10f4924-3" name="rest_code_a676d237e9c8464d88906f5cf10f4924-3" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_a676d237e9c8464d88906f5cf10f4924-3"&gt;&lt;/a&gt;&lt;span class="n"&gt;z&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_a676d237e9c8464d88906f5cf10f4924-4" name="rest_code_a676d237e9c8464d88906f5cf10f4924-4" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_a676d237e9c8464d88906f5cf10f4924-4"&gt;&lt;/a&gt;&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_a676d237e9c8464d88906f5cf10f4924-5" name="rest_code_a676d237e9c8464d88906f5cf10f4924-5" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_a676d237e9c8464d88906f5cf10f4924-5"&gt;&lt;/a&gt;    &lt;span class="n"&gt;M&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;st&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;wishart&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;rvs&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;scale&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;Sig1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;size&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_a676d237e9c8464d88906f5cf10f4924-6" name="rest_code_a676d237e9c8464d88906f5cf10f4924-6" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_a676d237e9c8464d88906f5cf10f4924-6"&gt;&lt;/a&gt;    &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;M&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_a676d237e9c8464d88906f5cf10f4924-7" name="rest_code_a676d237e9c8464d88906f5cf10f4924-7" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_a676d237e9c8464d88906f5cf10f4924-7"&gt;&lt;/a&gt;    &lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;M&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_a676d237e9c8464d88906f5cf10f4924-8" name="rest_code_a676d237e9c8464d88906f5cf10f4924-8" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_a676d237e9c8464d88906f5cf10f4924-8"&gt;&lt;/a&gt;    &lt;span class="n"&gt;z&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;M&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_a676d237e9c8464d88906f5cf10f4924-9" name="rest_code_a676d237e9c8464d88906f5cf10f4924-9" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_a676d237e9c8464d88906f5cf10f4924-9"&gt;&lt;/a&gt;&lt;span class="n"&gt;fig&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;figure&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;figsize&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;8&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_a676d237e9c8464d88906f5cf10f4924-10" name="rest_code_a676d237e9c8464d88906f5cf10f4924-10" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_a676d237e9c8464d88906f5cf10f4924-10"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;fig&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;add_subplot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;111&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;projection&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'3d'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_a676d237e9c8464d88906f5cf10f4924-11" name="rest_code_a676d237e9c8464d88906f5cf10f4924-11" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_a676d237e9c8464d88906f5cf10f4924-11"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;scatter3D&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;z&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;marker&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'o'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;c&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;z&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;cmap&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'seismic'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_a676d237e9c8464d88906f5cf10f4924-12" name="rest_code_a676d237e9c8464d88906f5cf10f4924-12" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_a676d237e9c8464d88906f5cf10f4924-12"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_xlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'V11'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_a676d237e9c8464d88906f5cf10f4924-13" name="rest_code_a676d237e9c8464d88906f5cf10f4924-13" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_a676d237e9c8464d88906f5cf10f4924-13"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_ylabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'V22'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_a676d237e9c8464d88906f5cf10f4924-14" name="rest_code_a676d237e9c8464d88906f5cf10f4924-14" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_a676d237e9c8464d88906f5cf10f4924-14"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_zlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'V12=V21'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_a676d237e9c8464d88906f5cf10f4924-15" name="rest_code_a676d237e9c8464d88906f5cf10f4924-15" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_a676d237e9c8464d88906f5cf10f4924-15"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_xlim&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;30&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_a676d237e9c8464d88906f5cf10f4924-16" name="rest_code_a676d237e9c8464d88906f5cf10f4924-16" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_a676d237e9c8464d88906f5cf10f4924-16"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_ylim&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;70&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_a676d237e9c8464d88906f5cf10f4924-17" name="rest_code_a676d237e9c8464d88906f5cf10f4924-17" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_a676d237e9c8464d88906f5cf10f4924-17"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_zlim&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;30&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_a676d237e9c8464d88906f5cf10f4924-18" name="rest_code_a676d237e9c8464d88906f5cf10f4924-18" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_a676d237e9c8464d88906f5cf10f4924-18"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;tight_layout&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;img alt="../output_4_0.png" src="https://personalpages.manchester.ac.uk/staff/thomas.house/output_4_0.png"&gt;
&lt;div class="code"&gt;&lt;pre class="code ipython3"&gt;&lt;a id="rest_code_76116a44a2574bca8e27ed73d13dd183-1" name="rest_code_76116a44a2574bca8e27ed73d13dd183-1" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_76116a44a2574bca8e27ed73d13dd183-1"&gt;&lt;/a&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_76116a44a2574bca8e27ed73d13dd183-2" name="rest_code_76116a44a2574bca8e27ed73d13dd183-2" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_76116a44a2574bca8e27ed73d13dd183-2"&gt;&lt;/a&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_76116a44a2574bca8e27ed73d13dd183-3" name="rest_code_76116a44a2574bca8e27ed73d13dd183-3" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_76116a44a2574bca8e27ed73d13dd183-3"&gt;&lt;/a&gt;&lt;span class="n"&gt;z&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_76116a44a2574bca8e27ed73d13dd183-4" name="rest_code_76116a44a2574bca8e27ed73d13dd183-4" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_76116a44a2574bca8e27ed73d13dd183-4"&gt;&lt;/a&gt;&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_76116a44a2574bca8e27ed73d13dd183-5" name="rest_code_76116a44a2574bca8e27ed73d13dd183-5" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_76116a44a2574bca8e27ed73d13dd183-5"&gt;&lt;/a&gt;    &lt;span class="n"&gt;M&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;st&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;wishart&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;rvs&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;scale&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;Sig1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;size&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_76116a44a2574bca8e27ed73d13dd183-6" name="rest_code_76116a44a2574bca8e27ed73d13dd183-6" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_76116a44a2574bca8e27ed73d13dd183-6"&gt;&lt;/a&gt;    &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;M&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_76116a44a2574bca8e27ed73d13dd183-7" name="rest_code_76116a44a2574bca8e27ed73d13dd183-7" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_76116a44a2574bca8e27ed73d13dd183-7"&gt;&lt;/a&gt;    &lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;M&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_76116a44a2574bca8e27ed73d13dd183-8" name="rest_code_76116a44a2574bca8e27ed73d13dd183-8" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_76116a44a2574bca8e27ed73d13dd183-8"&gt;&lt;/a&gt;    &lt;span class="n"&gt;z&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;M&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_76116a44a2574bca8e27ed73d13dd183-9" name="rest_code_76116a44a2574bca8e27ed73d13dd183-9" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_76116a44a2574bca8e27ed73d13dd183-9"&gt;&lt;/a&gt;&lt;span class="n"&gt;fig&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;figure&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;figsize&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;8&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_76116a44a2574bca8e27ed73d13dd183-10" name="rest_code_76116a44a2574bca8e27ed73d13dd183-10" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_76116a44a2574bca8e27ed73d13dd183-10"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;fig&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;add_subplot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;111&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;projection&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'3d'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_76116a44a2574bca8e27ed73d13dd183-11" name="rest_code_76116a44a2574bca8e27ed73d13dd183-11" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_76116a44a2574bca8e27ed73d13dd183-11"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;scatter3D&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;z&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;marker&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'o'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;c&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;z&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;cmap&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'seismic'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_76116a44a2574bca8e27ed73d13dd183-12" name="rest_code_76116a44a2574bca8e27ed73d13dd183-12" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_76116a44a2574bca8e27ed73d13dd183-12"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_xlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'V11'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_76116a44a2574bca8e27ed73d13dd183-13" name="rest_code_76116a44a2574bca8e27ed73d13dd183-13" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_76116a44a2574bca8e27ed73d13dd183-13"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_ylabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'V22'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_76116a44a2574bca8e27ed73d13dd183-14" name="rest_code_76116a44a2574bca8e27ed73d13dd183-14" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_76116a44a2574bca8e27ed73d13dd183-14"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_zlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'V12=V21'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_76116a44a2574bca8e27ed73d13dd183-15" name="rest_code_76116a44a2574bca8e27ed73d13dd183-15" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_76116a44a2574bca8e27ed73d13dd183-15"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_xlim&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;30&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_76116a44a2574bca8e27ed73d13dd183-16" name="rest_code_76116a44a2574bca8e27ed73d13dd183-16" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_76116a44a2574bca8e27ed73d13dd183-16"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_ylim&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;70&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_76116a44a2574bca8e27ed73d13dd183-17" name="rest_code_76116a44a2574bca8e27ed73d13dd183-17" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_76116a44a2574bca8e27ed73d13dd183-17"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_zlim&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;30&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_76116a44a2574bca8e27ed73d13dd183-18" name="rest_code_76116a44a2574bca8e27ed73d13dd183-18" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_76116a44a2574bca8e27ed73d13dd183-18"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;tight_layout&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;img alt="../output_5_0.png" src="https://personalpages.manchester.ac.uk/staff/thomas.house/output_5_0.png"&gt;&lt;/body&gt;&lt;/html&gt;

&lt;img alt="../output_2_1.png" src="https://personalpages.manchester.ac.uk/staff/thomas.house/output_2_1.png"&gt;
&lt;p&gt;The Wishart emerges when we make &lt;span class="raw-html"&gt;\(k \)&lt;/span&gt; observations each with &lt;span class="raw-html"&gt;\(p \)&lt;/span&gt; variables; the
sampling distribution for the covariance matrix of these data if the population is multivariate normal is
Wishart and has probability density function&lt;/p&gt;
&lt;p&gt;&lt;span class="raw-html"&gt;$$ f_{\mathcal{W}_p(k,\boldsymbol{\Sigma})}(\boldsymbol{V}) = \frac{\mathrm{det}(\boldsymbol{V})^{\frac{k - p - 1}{2}}}{2^{ \frac{k p}{2} } \mathrm{det}(\boldsymbol{\Sigma})^\frac{k}{2} \Gamma_p\!\left(\frac{k}{2} \right)} \exp\left( -\frac12 \mathrm{Tr}(\boldsymbol{\Sigma}^{-1} \boldsymbol{V}) \right) . $$&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;In general, this cannot be visualised, but for the &lt;span class="raw-html"&gt;\(p=2 \)&lt;/span&gt; case, one option is to pick random
numbers from this distribution and then produce a three-dimensional scatter plot of these. The code and results
below show that this can be seen as behaving somewhat like the chi-squared distribution that it generalises as
the degrees of freedom &lt;span class="raw-html"&gt;\(k \)&lt;/span&gt; are increased.&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code ipython3"&gt;&lt;a id="rest_code_2a204a6d0b0b40ddb307802c80ca763c-1" name="rest_code_2a204a6d0b0b40ddb307802c80ca763c-1" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_2a204a6d0b0b40ddb307802c80ca763c-1"&gt;&lt;/a&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_2a204a6d0b0b40ddb307802c80ca763c-2" name="rest_code_2a204a6d0b0b40ddb307802c80ca763c-2" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_2a204a6d0b0b40ddb307802c80ca763c-2"&gt;&lt;/a&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_2a204a6d0b0b40ddb307802c80ca763c-3" name="rest_code_2a204a6d0b0b40ddb307802c80ca763c-3" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_2a204a6d0b0b40ddb307802c80ca763c-3"&gt;&lt;/a&gt;&lt;span class="n"&gt;z&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_2a204a6d0b0b40ddb307802c80ca763c-4" name="rest_code_2a204a6d0b0b40ddb307802c80ca763c-4" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_2a204a6d0b0b40ddb307802c80ca763c-4"&gt;&lt;/a&gt;&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_2a204a6d0b0b40ddb307802c80ca763c-5" name="rest_code_2a204a6d0b0b40ddb307802c80ca763c-5" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_2a204a6d0b0b40ddb307802c80ca763c-5"&gt;&lt;/a&gt;    &lt;span class="n"&gt;M&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;st&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;wishart&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;rvs&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;scale&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;Sig1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;size&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_2a204a6d0b0b40ddb307802c80ca763c-6" name="rest_code_2a204a6d0b0b40ddb307802c80ca763c-6" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_2a204a6d0b0b40ddb307802c80ca763c-6"&gt;&lt;/a&gt;    &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;M&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_2a204a6d0b0b40ddb307802c80ca763c-7" name="rest_code_2a204a6d0b0b40ddb307802c80ca763c-7" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_2a204a6d0b0b40ddb307802c80ca763c-7"&gt;&lt;/a&gt;    &lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;M&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_2a204a6d0b0b40ddb307802c80ca763c-8" name="rest_code_2a204a6d0b0b40ddb307802c80ca763c-8" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_2a204a6d0b0b40ddb307802c80ca763c-8"&gt;&lt;/a&gt;    &lt;span class="n"&gt;z&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;M&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_2a204a6d0b0b40ddb307802c80ca763c-9" name="rest_code_2a204a6d0b0b40ddb307802c80ca763c-9" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_2a204a6d0b0b40ddb307802c80ca763c-9"&gt;&lt;/a&gt;&lt;span class="n"&gt;fig&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;figure&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;figsize&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;8&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_2a204a6d0b0b40ddb307802c80ca763c-10" name="rest_code_2a204a6d0b0b40ddb307802c80ca763c-10" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_2a204a6d0b0b40ddb307802c80ca763c-10"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;fig&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;add_subplot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;111&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;projection&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'3d'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_2a204a6d0b0b40ddb307802c80ca763c-11" name="rest_code_2a204a6d0b0b40ddb307802c80ca763c-11" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_2a204a6d0b0b40ddb307802c80ca763c-11"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;scatter3D&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;z&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;marker&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'o'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;c&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;z&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;cmap&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'seismic'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_2a204a6d0b0b40ddb307802c80ca763c-12" name="rest_code_2a204a6d0b0b40ddb307802c80ca763c-12" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_2a204a6d0b0b40ddb307802c80ca763c-12"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_xlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'V11'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_2a204a6d0b0b40ddb307802c80ca763c-13" name="rest_code_2a204a6d0b0b40ddb307802c80ca763c-13" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_2a204a6d0b0b40ddb307802c80ca763c-13"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_ylabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'V22'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_2a204a6d0b0b40ddb307802c80ca763c-14" name="rest_code_2a204a6d0b0b40ddb307802c80ca763c-14" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_2a204a6d0b0b40ddb307802c80ca763c-14"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_zlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'V12=V21'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_2a204a6d0b0b40ddb307802c80ca763c-15" name="rest_code_2a204a6d0b0b40ddb307802c80ca763c-15" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_2a204a6d0b0b40ddb307802c80ca763c-15"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_xlim&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;30&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_2a204a6d0b0b40ddb307802c80ca763c-16" name="rest_code_2a204a6d0b0b40ddb307802c80ca763c-16" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_2a204a6d0b0b40ddb307802c80ca763c-16"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_ylim&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;70&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_2a204a6d0b0b40ddb307802c80ca763c-17" name="rest_code_2a204a6d0b0b40ddb307802c80ca763c-17" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_2a204a6d0b0b40ddb307802c80ca763c-17"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_zlim&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;30&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_2a204a6d0b0b40ddb307802c80ca763c-18" name="rest_code_2a204a6d0b0b40ddb307802c80ca763c-18" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_2a204a6d0b0b40ddb307802c80ca763c-18"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;tight_layout&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;img alt="../output_3_0.png" src="https://personalpages.manchester.ac.uk/staff/thomas.house/output_3_0.png"&gt;
&lt;div class="code"&gt;&lt;pre class="code ipython3"&gt;&lt;a id="rest_code_a676d237e9c8464d88906f5cf10f4924-1" name="rest_code_a676d237e9c8464d88906f5cf10f4924-1" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_a676d237e9c8464d88906f5cf10f4924-1"&gt;&lt;/a&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_a676d237e9c8464d88906f5cf10f4924-2" name="rest_code_a676d237e9c8464d88906f5cf10f4924-2" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_a676d237e9c8464d88906f5cf10f4924-2"&gt;&lt;/a&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_a676d237e9c8464d88906f5cf10f4924-3" name="rest_code_a676d237e9c8464d88906f5cf10f4924-3" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_a676d237e9c8464d88906f5cf10f4924-3"&gt;&lt;/a&gt;&lt;span class="n"&gt;z&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_a676d237e9c8464d88906f5cf10f4924-4" name="rest_code_a676d237e9c8464d88906f5cf10f4924-4" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_a676d237e9c8464d88906f5cf10f4924-4"&gt;&lt;/a&gt;&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_a676d237e9c8464d88906f5cf10f4924-5" name="rest_code_a676d237e9c8464d88906f5cf10f4924-5" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_a676d237e9c8464d88906f5cf10f4924-5"&gt;&lt;/a&gt;    &lt;span class="n"&gt;M&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;st&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;wishart&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;rvs&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;scale&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;Sig1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;size&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_a676d237e9c8464d88906f5cf10f4924-6" name="rest_code_a676d237e9c8464d88906f5cf10f4924-6" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_a676d237e9c8464d88906f5cf10f4924-6"&gt;&lt;/a&gt;    &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;M&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_a676d237e9c8464d88906f5cf10f4924-7" name="rest_code_a676d237e9c8464d88906f5cf10f4924-7" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_a676d237e9c8464d88906f5cf10f4924-7"&gt;&lt;/a&gt;    &lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;M&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_a676d237e9c8464d88906f5cf10f4924-8" name="rest_code_a676d237e9c8464d88906f5cf10f4924-8" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_a676d237e9c8464d88906f5cf10f4924-8"&gt;&lt;/a&gt;    &lt;span class="n"&gt;z&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;M&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_a676d237e9c8464d88906f5cf10f4924-9" name="rest_code_a676d237e9c8464d88906f5cf10f4924-9" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_a676d237e9c8464d88906f5cf10f4924-9"&gt;&lt;/a&gt;&lt;span class="n"&gt;fig&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;figure&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;figsize&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;8&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_a676d237e9c8464d88906f5cf10f4924-10" name="rest_code_a676d237e9c8464d88906f5cf10f4924-10" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_a676d237e9c8464d88906f5cf10f4924-10"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;fig&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;add_subplot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;111&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;projection&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'3d'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_a676d237e9c8464d88906f5cf10f4924-11" name="rest_code_a676d237e9c8464d88906f5cf10f4924-11" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_a676d237e9c8464d88906f5cf10f4924-11"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;scatter3D&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;z&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;marker&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'o'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;c&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;z&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;cmap&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'seismic'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_a676d237e9c8464d88906f5cf10f4924-12" name="rest_code_a676d237e9c8464d88906f5cf10f4924-12" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_a676d237e9c8464d88906f5cf10f4924-12"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_xlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'V11'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_a676d237e9c8464d88906f5cf10f4924-13" name="rest_code_a676d237e9c8464d88906f5cf10f4924-13" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_a676d237e9c8464d88906f5cf10f4924-13"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_ylabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'V22'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_a676d237e9c8464d88906f5cf10f4924-14" name="rest_code_a676d237e9c8464d88906f5cf10f4924-14" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_a676d237e9c8464d88906f5cf10f4924-14"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_zlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'V12=V21'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_a676d237e9c8464d88906f5cf10f4924-15" name="rest_code_a676d237e9c8464d88906f5cf10f4924-15" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_a676d237e9c8464d88906f5cf10f4924-15"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_xlim&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;30&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_a676d237e9c8464d88906f5cf10f4924-16" name="rest_code_a676d237e9c8464d88906f5cf10f4924-16" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_a676d237e9c8464d88906f5cf10f4924-16"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_ylim&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;70&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_a676d237e9c8464d88906f5cf10f4924-17" name="rest_code_a676d237e9c8464d88906f5cf10f4924-17" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_a676d237e9c8464d88906f5cf10f4924-17"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_zlim&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;30&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_a676d237e9c8464d88906f5cf10f4924-18" name="rest_code_a676d237e9c8464d88906f5cf10f4924-18" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_a676d237e9c8464d88906f5cf10f4924-18"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;tight_layout&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;img alt="../output_4_0.png" src="https://personalpages.manchester.ac.uk/staff/thomas.house/output_4_0.png"&gt;
&lt;div class="code"&gt;&lt;pre class="code ipython3"&gt;&lt;a id="rest_code_76116a44a2574bca8e27ed73d13dd183-1" name="rest_code_76116a44a2574bca8e27ed73d13dd183-1" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_76116a44a2574bca8e27ed73d13dd183-1"&gt;&lt;/a&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_76116a44a2574bca8e27ed73d13dd183-2" name="rest_code_76116a44a2574bca8e27ed73d13dd183-2" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_76116a44a2574bca8e27ed73d13dd183-2"&gt;&lt;/a&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_76116a44a2574bca8e27ed73d13dd183-3" name="rest_code_76116a44a2574bca8e27ed73d13dd183-3" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_76116a44a2574bca8e27ed73d13dd183-3"&gt;&lt;/a&gt;&lt;span class="n"&gt;z&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_76116a44a2574bca8e27ed73d13dd183-4" name="rest_code_76116a44a2574bca8e27ed73d13dd183-4" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_76116a44a2574bca8e27ed73d13dd183-4"&gt;&lt;/a&gt;&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_76116a44a2574bca8e27ed73d13dd183-5" name="rest_code_76116a44a2574bca8e27ed73d13dd183-5" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_76116a44a2574bca8e27ed73d13dd183-5"&gt;&lt;/a&gt;    &lt;span class="n"&gt;M&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;st&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;wishart&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;rvs&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;scale&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;Sig1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;size&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_76116a44a2574bca8e27ed73d13dd183-6" name="rest_code_76116a44a2574bca8e27ed73d13dd183-6" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_76116a44a2574bca8e27ed73d13dd183-6"&gt;&lt;/a&gt;    &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;M&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_76116a44a2574bca8e27ed73d13dd183-7" name="rest_code_76116a44a2574bca8e27ed73d13dd183-7" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_76116a44a2574bca8e27ed73d13dd183-7"&gt;&lt;/a&gt;    &lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;M&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_76116a44a2574bca8e27ed73d13dd183-8" name="rest_code_76116a44a2574bca8e27ed73d13dd183-8" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_76116a44a2574bca8e27ed73d13dd183-8"&gt;&lt;/a&gt;    &lt;span class="n"&gt;z&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;M&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_76116a44a2574bca8e27ed73d13dd183-9" name="rest_code_76116a44a2574bca8e27ed73d13dd183-9" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_76116a44a2574bca8e27ed73d13dd183-9"&gt;&lt;/a&gt;&lt;span class="n"&gt;fig&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;figure&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;figsize&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;8&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_76116a44a2574bca8e27ed73d13dd183-10" name="rest_code_76116a44a2574bca8e27ed73d13dd183-10" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_76116a44a2574bca8e27ed73d13dd183-10"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;fig&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;add_subplot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;111&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;projection&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'3d'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_76116a44a2574bca8e27ed73d13dd183-11" name="rest_code_76116a44a2574bca8e27ed73d13dd183-11" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_76116a44a2574bca8e27ed73d13dd183-11"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;scatter3D&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;z&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;marker&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'o'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;c&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;z&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;cmap&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'seismic'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_76116a44a2574bca8e27ed73d13dd183-12" name="rest_code_76116a44a2574bca8e27ed73d13dd183-12" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_76116a44a2574bca8e27ed73d13dd183-12"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_xlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'V11'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_76116a44a2574bca8e27ed73d13dd183-13" name="rest_code_76116a44a2574bca8e27ed73d13dd183-13" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_76116a44a2574bca8e27ed73d13dd183-13"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_ylabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'V22'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_76116a44a2574bca8e27ed73d13dd183-14" name="rest_code_76116a44a2574bca8e27ed73d13dd183-14" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_76116a44a2574bca8e27ed73d13dd183-14"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_zlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'V12=V21'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_76116a44a2574bca8e27ed73d13dd183-15" name="rest_code_76116a44a2574bca8e27ed73d13dd183-15" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_76116a44a2574bca8e27ed73d13dd183-15"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_xlim&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;30&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_76116a44a2574bca8e27ed73d13dd183-16" name="rest_code_76116a44a2574bca8e27ed73d13dd183-16" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_76116a44a2574bca8e27ed73d13dd183-16"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_ylim&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;70&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_76116a44a2574bca8e27ed73d13dd183-17" name="rest_code_76116a44a2574bca8e27ed73d13dd183-17" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_76116a44a2574bca8e27ed73d13dd183-17"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_zlim&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;30&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_76116a44a2574bca8e27ed73d13dd183-18" name="rest_code_76116a44a2574bca8e27ed73d13dd183-18" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_76116a44a2574bca8e27ed73d13dd183-18"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;tight_layout&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;img alt="../output_5_0.png" src="https://personalpages.manchester.ac.uk/staff/thomas.house/output_5_0.png"&gt;&lt;/body&gt;&lt;/html&gt;

&lt;p&gt;&lt;span class="raw-html"&gt;$$ f_{\mathcal{W}_p(k,\boldsymbol{\Sigma})}(\boldsymbol{V}) = \frac{\mathrm{det}(\boldsymbol{V})^{\frac{k - p - 1}{2}}}{2^{ \frac{k p}{2} } \mathrm{det}(\boldsymbol{\Sigma})^\frac{k}{2} \Gamma_p\!\left(\frac{k}{2} \right)} \exp\left( -\frac12 \mathrm{Tr}(\boldsymbol{\Sigma}^{-1} \boldsymbol{V}) \right) . $$&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;In general, this cannot be visualised, but for the &lt;span class="raw-html"&gt;\(p=2 \)&lt;/span&gt; case, one option is to pick random
numbers from this distribution and then produce a three-dimensional scatter plot of these. The code and results
below show that this can be seen as behaving somewhat like the chi-squared distribution that it generalises as
the degrees of freedom &lt;span class="raw-html"&gt;\(k \)&lt;/span&gt; are increased.&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code ipython3"&gt;&lt;a id="rest_code_2a204a6d0b0b40ddb307802c80ca763c-1" name="rest_code_2a204a6d0b0b40ddb307802c80ca763c-1" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_2a204a6d0b0b40ddb307802c80ca763c-1"&gt;&lt;/a&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_2a204a6d0b0b40ddb307802c80ca763c-2" name="rest_code_2a204a6d0b0b40ddb307802c80ca763c-2" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_2a204a6d0b0b40ddb307802c80ca763c-2"&gt;&lt;/a&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_2a204a6d0b0b40ddb307802c80ca763c-3" name="rest_code_2a204a6d0b0b40ddb307802c80ca763c-3" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_2a204a6d0b0b40ddb307802c80ca763c-3"&gt;&lt;/a&gt;&lt;span class="n"&gt;z&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_2a204a6d0b0b40ddb307802c80ca763c-4" name="rest_code_2a204a6d0b0b40ddb307802c80ca763c-4" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_2a204a6d0b0b40ddb307802c80ca763c-4"&gt;&lt;/a&gt;&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_2a204a6d0b0b40ddb307802c80ca763c-5" name="rest_code_2a204a6d0b0b40ddb307802c80ca763c-5" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_2a204a6d0b0b40ddb307802c80ca763c-5"&gt;&lt;/a&gt;    &lt;span class="n"&gt;M&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;st&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;wishart&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;rvs&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;scale&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;Sig1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;size&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_2a204a6d0b0b40ddb307802c80ca763c-6" name="rest_code_2a204a6d0b0b40ddb307802c80ca763c-6" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_2a204a6d0b0b40ddb307802c80ca763c-6"&gt;&lt;/a&gt;    &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;M&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_2a204a6d0b0b40ddb307802c80ca763c-7" name="rest_code_2a204a6d0b0b40ddb307802c80ca763c-7" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_2a204a6d0b0b40ddb307802c80ca763c-7"&gt;&lt;/a&gt;    &lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;M&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_2a204a6d0b0b40ddb307802c80ca763c-8" name="rest_code_2a204a6d0b0b40ddb307802c80ca763c-8" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_2a204a6d0b0b40ddb307802c80ca763c-8"&gt;&lt;/a&gt;    &lt;span class="n"&gt;z&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;M&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_2a204a6d0b0b40ddb307802c80ca763c-9" name="rest_code_2a204a6d0b0b40ddb307802c80ca763c-9" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_2a204a6d0b0b40ddb307802c80ca763c-9"&gt;&lt;/a&gt;&lt;span class="n"&gt;fig&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;figure&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;figsize&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;8&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_2a204a6d0b0b40ddb307802c80ca763c-10" name="rest_code_2a204a6d0b0b40ddb307802c80ca763c-10" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_2a204a6d0b0b40ddb307802c80ca763c-10"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;fig&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;add_subplot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;111&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;projection&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'3d'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_2a204a6d0b0b40ddb307802c80ca763c-11" name="rest_code_2a204a6d0b0b40ddb307802c80ca763c-11" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_2a204a6d0b0b40ddb307802c80ca763c-11"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;scatter3D&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;z&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;marker&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'o'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;c&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;z&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;cmap&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'seismic'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_2a204a6d0b0b40ddb307802c80ca763c-12" name="rest_code_2a204a6d0b0b40ddb307802c80ca763c-12" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_2a204a6d0b0b40ddb307802c80ca763c-12"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_xlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'V11'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_2a204a6d0b0b40ddb307802c80ca763c-13" name="rest_code_2a204a6d0b0b40ddb307802c80ca763c-13" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_2a204a6d0b0b40ddb307802c80ca763c-13"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_ylabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'V22'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_2a204a6d0b0b40ddb307802c80ca763c-14" name="rest_code_2a204a6d0b0b40ddb307802c80ca763c-14" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_2a204a6d0b0b40ddb307802c80ca763c-14"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_zlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'V12=V21'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_2a204a6d0b0b40ddb307802c80ca763c-15" name="rest_code_2a204a6d0b0b40ddb307802c80ca763c-15" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_2a204a6d0b0b40ddb307802c80ca763c-15"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_xlim&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;30&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_2a204a6d0b0b40ddb307802c80ca763c-16" name="rest_code_2a204a6d0b0b40ddb307802c80ca763c-16" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_2a204a6d0b0b40ddb307802c80ca763c-16"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_ylim&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;70&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_2a204a6d0b0b40ddb307802c80ca763c-17" name="rest_code_2a204a6d0b0b40ddb307802c80ca763c-17" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_2a204a6d0b0b40ddb307802c80ca763c-17"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_zlim&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;30&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_2a204a6d0b0b40ddb307802c80ca763c-18" name="rest_code_2a204a6d0b0b40ddb307802c80ca763c-18" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_2a204a6d0b0b40ddb307802c80ca763c-18"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;tight_layout&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;img alt="../output_3_0.png" src="https://personalpages.manchester.ac.uk/staff/thomas.house/output_3_0.png"&gt;
&lt;div class="code"&gt;&lt;pre class="code ipython3"&gt;&lt;a id="rest_code_a676d237e9c8464d88906f5cf10f4924-1" name="rest_code_a676d237e9c8464d88906f5cf10f4924-1" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_a676d237e9c8464d88906f5cf10f4924-1"&gt;&lt;/a&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_a676d237e9c8464d88906f5cf10f4924-2" name="rest_code_a676d237e9c8464d88906f5cf10f4924-2" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_a676d237e9c8464d88906f5cf10f4924-2"&gt;&lt;/a&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_a676d237e9c8464d88906f5cf10f4924-3" name="rest_code_a676d237e9c8464d88906f5cf10f4924-3" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_a676d237e9c8464d88906f5cf10f4924-3"&gt;&lt;/a&gt;&lt;span class="n"&gt;z&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_a676d237e9c8464d88906f5cf10f4924-4" name="rest_code_a676d237e9c8464d88906f5cf10f4924-4" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_a676d237e9c8464d88906f5cf10f4924-4"&gt;&lt;/a&gt;&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_a676d237e9c8464d88906f5cf10f4924-5" name="rest_code_a676d237e9c8464d88906f5cf10f4924-5" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_a676d237e9c8464d88906f5cf10f4924-5"&gt;&lt;/a&gt;    &lt;span class="n"&gt;M&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;st&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;wishart&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;rvs&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;scale&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;Sig1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;size&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_a676d237e9c8464d88906f5cf10f4924-6" name="rest_code_a676d237e9c8464d88906f5cf10f4924-6" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_a676d237e9c8464d88906f5cf10f4924-6"&gt;&lt;/a&gt;    &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;M&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_a676d237e9c8464d88906f5cf10f4924-7" name="rest_code_a676d237e9c8464d88906f5cf10f4924-7" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_a676d237e9c8464d88906f5cf10f4924-7"&gt;&lt;/a&gt;    &lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;M&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_a676d237e9c8464d88906f5cf10f4924-8" name="rest_code_a676d237e9c8464d88906f5cf10f4924-8" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_a676d237e9c8464d88906f5cf10f4924-8"&gt;&lt;/a&gt;    &lt;span class="n"&gt;z&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;M&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_a676d237e9c8464d88906f5cf10f4924-9" name="rest_code_a676d237e9c8464d88906f5cf10f4924-9" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_a676d237e9c8464d88906f5cf10f4924-9"&gt;&lt;/a&gt;&lt;span class="n"&gt;fig&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;figure&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;figsize&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;8&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_a676d237e9c8464d88906f5cf10f4924-10" name="rest_code_a676d237e9c8464d88906f5cf10f4924-10" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_a676d237e9c8464d88906f5cf10f4924-10"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;fig&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;add_subplot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;111&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;projection&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'3d'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_a676d237e9c8464d88906f5cf10f4924-11" name="rest_code_a676d237e9c8464d88906f5cf10f4924-11" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_a676d237e9c8464d88906f5cf10f4924-11"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;scatter3D&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;z&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;marker&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'o'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;c&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;z&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;cmap&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'seismic'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_a676d237e9c8464d88906f5cf10f4924-12" name="rest_code_a676d237e9c8464d88906f5cf10f4924-12" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_a676d237e9c8464d88906f5cf10f4924-12"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_xlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'V11'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_a676d237e9c8464d88906f5cf10f4924-13" name="rest_code_a676d237e9c8464d88906f5cf10f4924-13" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_a676d237e9c8464d88906f5cf10f4924-13"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_ylabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'V22'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_a676d237e9c8464d88906f5cf10f4924-14" name="rest_code_a676d237e9c8464d88906f5cf10f4924-14" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_a676d237e9c8464d88906f5cf10f4924-14"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_zlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'V12=V21'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_a676d237e9c8464d88906f5cf10f4924-15" name="rest_code_a676d237e9c8464d88906f5cf10f4924-15" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_a676d237e9c8464d88906f5cf10f4924-15"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_xlim&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;30&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_a676d237e9c8464d88906f5cf10f4924-16" name="rest_code_a676d237e9c8464d88906f5cf10f4924-16" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_a676d237e9c8464d88906f5cf10f4924-16"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_ylim&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;70&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_a676d237e9c8464d88906f5cf10f4924-17" name="rest_code_a676d237e9c8464d88906f5cf10f4924-17" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_a676d237e9c8464d88906f5cf10f4924-17"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_zlim&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;30&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_a676d237e9c8464d88906f5cf10f4924-18" name="rest_code_a676d237e9c8464d88906f5cf10f4924-18" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_a676d237e9c8464d88906f5cf10f4924-18"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;tight_layout&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;img alt="../output_4_0.png" src="https://personalpages.manchester.ac.uk/staff/thomas.house/output_4_0.png"&gt;
&lt;div class="code"&gt;&lt;pre class="code ipython3"&gt;&lt;a id="rest_code_76116a44a2574bca8e27ed73d13dd183-1" name="rest_code_76116a44a2574bca8e27ed73d13dd183-1" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_76116a44a2574bca8e27ed73d13dd183-1"&gt;&lt;/a&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_76116a44a2574bca8e27ed73d13dd183-2" name="rest_code_76116a44a2574bca8e27ed73d13dd183-2" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_76116a44a2574bca8e27ed73d13dd183-2"&gt;&lt;/a&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_76116a44a2574bca8e27ed73d13dd183-3" name="rest_code_76116a44a2574bca8e27ed73d13dd183-3" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_76116a44a2574bca8e27ed73d13dd183-3"&gt;&lt;/a&gt;&lt;span class="n"&gt;z&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_76116a44a2574bca8e27ed73d13dd183-4" name="rest_code_76116a44a2574bca8e27ed73d13dd183-4" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_76116a44a2574bca8e27ed73d13dd183-4"&gt;&lt;/a&gt;&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_76116a44a2574bca8e27ed73d13dd183-5" name="rest_code_76116a44a2574bca8e27ed73d13dd183-5" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_76116a44a2574bca8e27ed73d13dd183-5"&gt;&lt;/a&gt;    &lt;span class="n"&gt;M&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;st&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;wishart&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;rvs&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;scale&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;Sig1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;size&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_76116a44a2574bca8e27ed73d13dd183-6" name="rest_code_76116a44a2574bca8e27ed73d13dd183-6" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_76116a44a2574bca8e27ed73d13dd183-6"&gt;&lt;/a&gt;    &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;M&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_76116a44a2574bca8e27ed73d13dd183-7" name="rest_code_76116a44a2574bca8e27ed73d13dd183-7" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_76116a44a2574bca8e27ed73d13dd183-7"&gt;&lt;/a&gt;    &lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;M&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_76116a44a2574bca8e27ed73d13dd183-8" name="rest_code_76116a44a2574bca8e27ed73d13dd183-8" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_76116a44a2574bca8e27ed73d13dd183-8"&gt;&lt;/a&gt;    &lt;span class="n"&gt;z&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;M&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_76116a44a2574bca8e27ed73d13dd183-9" name="rest_code_76116a44a2574bca8e27ed73d13dd183-9" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_76116a44a2574bca8e27ed73d13dd183-9"&gt;&lt;/a&gt;&lt;span class="n"&gt;fig&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;figure&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;figsize&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;8&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_76116a44a2574bca8e27ed73d13dd183-10" name="rest_code_76116a44a2574bca8e27ed73d13dd183-10" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_76116a44a2574bca8e27ed73d13dd183-10"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;fig&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;add_subplot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;111&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;projection&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'3d'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_76116a44a2574bca8e27ed73d13dd183-11" name="rest_code_76116a44a2574bca8e27ed73d13dd183-11" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_76116a44a2574bca8e27ed73d13dd183-11"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;scatter3D&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;z&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;marker&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'o'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;c&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;z&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;cmap&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'seismic'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_76116a44a2574bca8e27ed73d13dd183-12" name="rest_code_76116a44a2574bca8e27ed73d13dd183-12" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_76116a44a2574bca8e27ed73d13dd183-12"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_xlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'V11'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_76116a44a2574bca8e27ed73d13dd183-13" name="rest_code_76116a44a2574bca8e27ed73d13dd183-13" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_76116a44a2574bca8e27ed73d13dd183-13"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_ylabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'V22'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_76116a44a2574bca8e27ed73d13dd183-14" name="rest_code_76116a44a2574bca8e27ed73d13dd183-14" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_76116a44a2574bca8e27ed73d13dd183-14"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_zlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'V12=V21'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_76116a44a2574bca8e27ed73d13dd183-15" name="rest_code_76116a44a2574bca8e27ed73d13dd183-15" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_76116a44a2574bca8e27ed73d13dd183-15"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_xlim&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;30&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_76116a44a2574bca8e27ed73d13dd183-16" name="rest_code_76116a44a2574bca8e27ed73d13dd183-16" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_76116a44a2574bca8e27ed73d13dd183-16"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_ylim&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;70&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_76116a44a2574bca8e27ed73d13dd183-17" name="rest_code_76116a44a2574bca8e27ed73d13dd183-17" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_76116a44a2574bca8e27ed73d13dd183-17"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_zlim&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;30&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_76116a44a2574bca8e27ed73d13dd183-18" name="rest_code_76116a44a2574bca8e27ed73d13dd183-18" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_76116a44a2574bca8e27ed73d13dd183-18"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;tight_layout&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;img alt="../output_5_0.png" src="https://personalpages.manchester.ac.uk/staff/thomas.house/output_5_0.png"&gt;&lt;/body&gt;&lt;/html&gt;

&lt;p&gt;In general, this cannot be visualised, but for the &lt;span class="raw-html"&gt;\(p=2 \)&lt;/span&gt; case, one option is to pick random
numbers from this distribution and then produce a three-dimensional scatter plot of these. The code and results
below show that this can be seen as behaving somewhat like the chi-squared distribution that it generalises as
the degrees of freedom &lt;span class="raw-html"&gt;\(k \)&lt;/span&gt; are increased.&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code ipython3"&gt;&lt;a id="rest_code_2a204a6d0b0b40ddb307802c80ca763c-1" name="rest_code_2a204a6d0b0b40ddb307802c80ca763c-1" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_2a204a6d0b0b40ddb307802c80ca763c-1"&gt;&lt;/a&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_2a204a6d0b0b40ddb307802c80ca763c-2" name="rest_code_2a204a6d0b0b40ddb307802c80ca763c-2" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_2a204a6d0b0b40ddb307802c80ca763c-2"&gt;&lt;/a&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_2a204a6d0b0b40ddb307802c80ca763c-3" name="rest_code_2a204a6d0b0b40ddb307802c80ca763c-3" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_2a204a6d0b0b40ddb307802c80ca763c-3"&gt;&lt;/a&gt;&lt;span class="n"&gt;z&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_2a204a6d0b0b40ddb307802c80ca763c-4" name="rest_code_2a204a6d0b0b40ddb307802c80ca763c-4" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_2a204a6d0b0b40ddb307802c80ca763c-4"&gt;&lt;/a&gt;&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_2a204a6d0b0b40ddb307802c80ca763c-5" name="rest_code_2a204a6d0b0b40ddb307802c80ca763c-5" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_2a204a6d0b0b40ddb307802c80ca763c-5"&gt;&lt;/a&gt;    &lt;span class="n"&gt;M&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;st&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;wishart&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;rvs&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;scale&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;Sig1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;size&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_2a204a6d0b0b40ddb307802c80ca763c-6" name="rest_code_2a204a6d0b0b40ddb307802c80ca763c-6" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_2a204a6d0b0b40ddb307802c80ca763c-6"&gt;&lt;/a&gt;    &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;M&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_2a204a6d0b0b40ddb307802c80ca763c-7" name="rest_code_2a204a6d0b0b40ddb307802c80ca763c-7" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_2a204a6d0b0b40ddb307802c80ca763c-7"&gt;&lt;/a&gt;    &lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;M&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_2a204a6d0b0b40ddb307802c80ca763c-8" name="rest_code_2a204a6d0b0b40ddb307802c80ca763c-8" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_2a204a6d0b0b40ddb307802c80ca763c-8"&gt;&lt;/a&gt;    &lt;span class="n"&gt;z&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;M&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_2a204a6d0b0b40ddb307802c80ca763c-9" name="rest_code_2a204a6d0b0b40ddb307802c80ca763c-9" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_2a204a6d0b0b40ddb307802c80ca763c-9"&gt;&lt;/a&gt;&lt;span class="n"&gt;fig&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;figure&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;figsize&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;8&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_2a204a6d0b0b40ddb307802c80ca763c-10" name="rest_code_2a204a6d0b0b40ddb307802c80ca763c-10" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_2a204a6d0b0b40ddb307802c80ca763c-10"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;fig&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;add_subplot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;111&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;projection&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'3d'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_2a204a6d0b0b40ddb307802c80ca763c-11" name="rest_code_2a204a6d0b0b40ddb307802c80ca763c-11" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_2a204a6d0b0b40ddb307802c80ca763c-11"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;scatter3D&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;z&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;marker&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'o'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;c&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;z&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;cmap&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'seismic'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_2a204a6d0b0b40ddb307802c80ca763c-12" name="rest_code_2a204a6d0b0b40ddb307802c80ca763c-12" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_2a204a6d0b0b40ddb307802c80ca763c-12"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_xlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'V11'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_2a204a6d0b0b40ddb307802c80ca763c-13" name="rest_code_2a204a6d0b0b40ddb307802c80ca763c-13" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_2a204a6d0b0b40ddb307802c80ca763c-13"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_ylabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'V22'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_2a204a6d0b0b40ddb307802c80ca763c-14" name="rest_code_2a204a6d0b0b40ddb307802c80ca763c-14" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_2a204a6d0b0b40ddb307802c80ca763c-14"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_zlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'V12=V21'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_2a204a6d0b0b40ddb307802c80ca763c-15" name="rest_code_2a204a6d0b0b40ddb307802c80ca763c-15" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_2a204a6d0b0b40ddb307802c80ca763c-15"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_xlim&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;30&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_2a204a6d0b0b40ddb307802c80ca763c-16" name="rest_code_2a204a6d0b0b40ddb307802c80ca763c-16" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_2a204a6d0b0b40ddb307802c80ca763c-16"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_ylim&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;70&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_2a204a6d0b0b40ddb307802c80ca763c-17" name="rest_code_2a204a6d0b0b40ddb307802c80ca763c-17" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_2a204a6d0b0b40ddb307802c80ca763c-17"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_zlim&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;30&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_2a204a6d0b0b40ddb307802c80ca763c-18" name="rest_code_2a204a6d0b0b40ddb307802c80ca763c-18" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_2a204a6d0b0b40ddb307802c80ca763c-18"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;tight_layout&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;img alt="../output_3_0.png" src="https://personalpages.manchester.ac.uk/staff/thomas.house/output_3_0.png"&gt;
&lt;div class="code"&gt;&lt;pre class="code ipython3"&gt;&lt;a id="rest_code_a676d237e9c8464d88906f5cf10f4924-1" name="rest_code_a676d237e9c8464d88906f5cf10f4924-1" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_a676d237e9c8464d88906f5cf10f4924-1"&gt;&lt;/a&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_a676d237e9c8464d88906f5cf10f4924-2" name="rest_code_a676d237e9c8464d88906f5cf10f4924-2" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_a676d237e9c8464d88906f5cf10f4924-2"&gt;&lt;/a&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_a676d237e9c8464d88906f5cf10f4924-3" name="rest_code_a676d237e9c8464d88906f5cf10f4924-3" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_a676d237e9c8464d88906f5cf10f4924-3"&gt;&lt;/a&gt;&lt;span class="n"&gt;z&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_a676d237e9c8464d88906f5cf10f4924-4" name="rest_code_a676d237e9c8464d88906f5cf10f4924-4" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_a676d237e9c8464d88906f5cf10f4924-4"&gt;&lt;/a&gt;&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_a676d237e9c8464d88906f5cf10f4924-5" name="rest_code_a676d237e9c8464d88906f5cf10f4924-5" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_a676d237e9c8464d88906f5cf10f4924-5"&gt;&lt;/a&gt;    &lt;span class="n"&gt;M&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;st&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;wishart&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;rvs&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;scale&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;Sig1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;size&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_a676d237e9c8464d88906f5cf10f4924-6" name="rest_code_a676d237e9c8464d88906f5cf10f4924-6" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_a676d237e9c8464d88906f5cf10f4924-6"&gt;&lt;/a&gt;    &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;M&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_a676d237e9c8464d88906f5cf10f4924-7" name="rest_code_a676d237e9c8464d88906f5cf10f4924-7" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_a676d237e9c8464d88906f5cf10f4924-7"&gt;&lt;/a&gt;    &lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;M&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_a676d237e9c8464d88906f5cf10f4924-8" name="rest_code_a676d237e9c8464d88906f5cf10f4924-8" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_a676d237e9c8464d88906f5cf10f4924-8"&gt;&lt;/a&gt;    &lt;span class="n"&gt;z&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;M&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_a676d237e9c8464d88906f5cf10f4924-9" name="rest_code_a676d237e9c8464d88906f5cf10f4924-9" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_a676d237e9c8464d88906f5cf10f4924-9"&gt;&lt;/a&gt;&lt;span class="n"&gt;fig&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;figure&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;figsize&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;8&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_a676d237e9c8464d88906f5cf10f4924-10" name="rest_code_a676d237e9c8464d88906f5cf10f4924-10" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_a676d237e9c8464d88906f5cf10f4924-10"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;fig&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;add_subplot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;111&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;projection&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'3d'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_a676d237e9c8464d88906f5cf10f4924-11" name="rest_code_a676d237e9c8464d88906f5cf10f4924-11" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_a676d237e9c8464d88906f5cf10f4924-11"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;scatter3D&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;z&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;marker&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'o'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;c&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;z&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;cmap&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'seismic'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_a676d237e9c8464d88906f5cf10f4924-12" name="rest_code_a676d237e9c8464d88906f5cf10f4924-12" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_a676d237e9c8464d88906f5cf10f4924-12"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_xlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'V11'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_a676d237e9c8464d88906f5cf10f4924-13" name="rest_code_a676d237e9c8464d88906f5cf10f4924-13" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_a676d237e9c8464d88906f5cf10f4924-13"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_ylabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'V22'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_a676d237e9c8464d88906f5cf10f4924-14" name="rest_code_a676d237e9c8464d88906f5cf10f4924-14" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_a676d237e9c8464d88906f5cf10f4924-14"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_zlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'V12=V21'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_a676d237e9c8464d88906f5cf10f4924-15" name="rest_code_a676d237e9c8464d88906f5cf10f4924-15" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_a676d237e9c8464d88906f5cf10f4924-15"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_xlim&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;30&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_a676d237e9c8464d88906f5cf10f4924-16" name="rest_code_a676d237e9c8464d88906f5cf10f4924-16" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_a676d237e9c8464d88906f5cf10f4924-16"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_ylim&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;70&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_a676d237e9c8464d88906f5cf10f4924-17" name="rest_code_a676d237e9c8464d88906f5cf10f4924-17" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_a676d237e9c8464d88906f5cf10f4924-17"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_zlim&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;30&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_a676d237e9c8464d88906f5cf10f4924-18" name="rest_code_a676d237e9c8464d88906f5cf10f4924-18" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_a676d237e9c8464d88906f5cf10f4924-18"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;tight_layout&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;img alt="../output_4_0.png" src="https://personalpages.manchester.ac.uk/staff/thomas.house/output_4_0.png"&gt;
&lt;div class="code"&gt;&lt;pre class="code ipython3"&gt;&lt;a id="rest_code_76116a44a2574bca8e27ed73d13dd183-1" name="rest_code_76116a44a2574bca8e27ed73d13dd183-1" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_76116a44a2574bca8e27ed73d13dd183-1"&gt;&lt;/a&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_76116a44a2574bca8e27ed73d13dd183-2" name="rest_code_76116a44a2574bca8e27ed73d13dd183-2" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_76116a44a2574bca8e27ed73d13dd183-2"&gt;&lt;/a&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_76116a44a2574bca8e27ed73d13dd183-3" name="rest_code_76116a44a2574bca8e27ed73d13dd183-3" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_76116a44a2574bca8e27ed73d13dd183-3"&gt;&lt;/a&gt;&lt;span class="n"&gt;z&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_76116a44a2574bca8e27ed73d13dd183-4" name="rest_code_76116a44a2574bca8e27ed73d13dd183-4" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_76116a44a2574bca8e27ed73d13dd183-4"&gt;&lt;/a&gt;&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_76116a44a2574bca8e27ed73d13dd183-5" name="rest_code_76116a44a2574bca8e27ed73d13dd183-5" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_76116a44a2574bca8e27ed73d13dd183-5"&gt;&lt;/a&gt;    &lt;span class="n"&gt;M&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;st&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;wishart&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;rvs&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;scale&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;Sig1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;size&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_76116a44a2574bca8e27ed73d13dd183-6" name="rest_code_76116a44a2574bca8e27ed73d13dd183-6" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_76116a44a2574bca8e27ed73d13dd183-6"&gt;&lt;/a&gt;    &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;M&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_76116a44a2574bca8e27ed73d13dd183-7" name="rest_code_76116a44a2574bca8e27ed73d13dd183-7" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_76116a44a2574bca8e27ed73d13dd183-7"&gt;&lt;/a&gt;    &lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;M&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_76116a44a2574bca8e27ed73d13dd183-8" name="rest_code_76116a44a2574bca8e27ed73d13dd183-8" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_76116a44a2574bca8e27ed73d13dd183-8"&gt;&lt;/a&gt;    &lt;span class="n"&gt;z&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;M&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_76116a44a2574bca8e27ed73d13dd183-9" name="rest_code_76116a44a2574bca8e27ed73d13dd183-9" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_76116a44a2574bca8e27ed73d13dd183-9"&gt;&lt;/a&gt;&lt;span class="n"&gt;fig&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;figure&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;figsize&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;8&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_76116a44a2574bca8e27ed73d13dd183-10" name="rest_code_76116a44a2574bca8e27ed73d13dd183-10" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_76116a44a2574bca8e27ed73d13dd183-10"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;fig&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;add_subplot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;111&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;projection&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'3d'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_76116a44a2574bca8e27ed73d13dd183-11" name="rest_code_76116a44a2574bca8e27ed73d13dd183-11" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_76116a44a2574bca8e27ed73d13dd183-11"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;scatter3D&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;z&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;marker&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'o'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;c&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;z&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;cmap&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'seismic'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_76116a44a2574bca8e27ed73d13dd183-12" name="rest_code_76116a44a2574bca8e27ed73d13dd183-12" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_76116a44a2574bca8e27ed73d13dd183-12"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_xlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'V11'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_76116a44a2574bca8e27ed73d13dd183-13" name="rest_code_76116a44a2574bca8e27ed73d13dd183-13" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_76116a44a2574bca8e27ed73d13dd183-13"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_ylabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'V22'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_76116a44a2574bca8e27ed73d13dd183-14" name="rest_code_76116a44a2574bca8e27ed73d13dd183-14" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_76116a44a2574bca8e27ed73d13dd183-14"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_zlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'V12=V21'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_76116a44a2574bca8e27ed73d13dd183-15" name="rest_code_76116a44a2574bca8e27ed73d13dd183-15" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_76116a44a2574bca8e27ed73d13dd183-15"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_xlim&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;30&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_76116a44a2574bca8e27ed73d13dd183-16" name="rest_code_76116a44a2574bca8e27ed73d13dd183-16" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_76116a44a2574bca8e27ed73d13dd183-16"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_ylim&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;70&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_76116a44a2574bca8e27ed73d13dd183-17" name="rest_code_76116a44a2574bca8e27ed73d13dd183-17" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_76116a44a2574bca8e27ed73d13dd183-17"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_zlim&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;30&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_76116a44a2574bca8e27ed73d13dd183-18" name="rest_code_76116a44a2574bca8e27ed73d13dd183-18" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_76116a44a2574bca8e27ed73d13dd183-18"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;tight_layout&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;img alt="../output_5_0.png" src="https://personalpages.manchester.ac.uk/staff/thomas.house/output_5_0.png"&gt;&lt;/body&gt;&lt;/html&gt;

&lt;div class="code"&gt;&lt;pre class="code ipython3"&gt;&lt;a id="rest_code_2a204a6d0b0b40ddb307802c80ca763c-1" name="rest_code_2a204a6d0b0b40ddb307802c80ca763c-1" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_2a204a6d0b0b40ddb307802c80ca763c-1"&gt;&lt;/a&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_2a204a6d0b0b40ddb307802c80ca763c-2" name="rest_code_2a204a6d0b0b40ddb307802c80ca763c-2" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_2a204a6d0b0b40ddb307802c80ca763c-2"&gt;&lt;/a&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_2a204a6d0b0b40ddb307802c80ca763c-3" name="rest_code_2a204a6d0b0b40ddb307802c80ca763c-3" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_2a204a6d0b0b40ddb307802c80ca763c-3"&gt;&lt;/a&gt;&lt;span class="n"&gt;z&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_2a204a6d0b0b40ddb307802c80ca763c-4" name="rest_code_2a204a6d0b0b40ddb307802c80ca763c-4" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_2a204a6d0b0b40ddb307802c80ca763c-4"&gt;&lt;/a&gt;&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_2a204a6d0b0b40ddb307802c80ca763c-5" name="rest_code_2a204a6d0b0b40ddb307802c80ca763c-5" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_2a204a6d0b0b40ddb307802c80ca763c-5"&gt;&lt;/a&gt;    &lt;span class="n"&gt;M&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;st&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;wishart&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;rvs&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;scale&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;Sig1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;size&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_2a204a6d0b0b40ddb307802c80ca763c-6" name="rest_code_2a204a6d0b0b40ddb307802c80ca763c-6" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_2a204a6d0b0b40ddb307802c80ca763c-6"&gt;&lt;/a&gt;    &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;M&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_2a204a6d0b0b40ddb307802c80ca763c-7" name="rest_code_2a204a6d0b0b40ddb307802c80ca763c-7" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_2a204a6d0b0b40ddb307802c80ca763c-7"&gt;&lt;/a&gt;    &lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;M&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_2a204a6d0b0b40ddb307802c80ca763c-8" name="rest_code_2a204a6d0b0b40ddb307802c80ca763c-8" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_2a204a6d0b0b40ddb307802c80ca763c-8"&gt;&lt;/a&gt;    &lt;span class="n"&gt;z&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;M&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_2a204a6d0b0b40ddb307802c80ca763c-9" name="rest_code_2a204a6d0b0b40ddb307802c80ca763c-9" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_2a204a6d0b0b40ddb307802c80ca763c-9"&gt;&lt;/a&gt;&lt;span class="n"&gt;fig&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;figure&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;figsize&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;8&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_2a204a6d0b0b40ddb307802c80ca763c-10" name="rest_code_2a204a6d0b0b40ddb307802c80ca763c-10" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_2a204a6d0b0b40ddb307802c80ca763c-10"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;fig&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;add_subplot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;111&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;projection&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'3d'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_2a204a6d0b0b40ddb307802c80ca763c-11" name="rest_code_2a204a6d0b0b40ddb307802c80ca763c-11" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_2a204a6d0b0b40ddb307802c80ca763c-11"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;scatter3D&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;z&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;marker&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'o'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;c&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;z&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;cmap&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'seismic'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_2a204a6d0b0b40ddb307802c80ca763c-12" name="rest_code_2a204a6d0b0b40ddb307802c80ca763c-12" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_2a204a6d0b0b40ddb307802c80ca763c-12"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_xlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'V11'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_2a204a6d0b0b40ddb307802c80ca763c-13" name="rest_code_2a204a6d0b0b40ddb307802c80ca763c-13" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_2a204a6d0b0b40ddb307802c80ca763c-13"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_ylabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'V22'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_2a204a6d0b0b40ddb307802c80ca763c-14" name="rest_code_2a204a6d0b0b40ddb307802c80ca763c-14" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_2a204a6d0b0b40ddb307802c80ca763c-14"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_zlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'V12=V21'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_2a204a6d0b0b40ddb307802c80ca763c-15" name="rest_code_2a204a6d0b0b40ddb307802c80ca763c-15" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_2a204a6d0b0b40ddb307802c80ca763c-15"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_xlim&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;30&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_2a204a6d0b0b40ddb307802c80ca763c-16" name="rest_code_2a204a6d0b0b40ddb307802c80ca763c-16" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_2a204a6d0b0b40ddb307802c80ca763c-16"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_ylim&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;70&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_2a204a6d0b0b40ddb307802c80ca763c-17" name="rest_code_2a204a6d0b0b40ddb307802c80ca763c-17" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_2a204a6d0b0b40ddb307802c80ca763c-17"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_zlim&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;30&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_2a204a6d0b0b40ddb307802c80ca763c-18" name="rest_code_2a204a6d0b0b40ddb307802c80ca763c-18" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_2a204a6d0b0b40ddb307802c80ca763c-18"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;tight_layout&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;img alt="../output_3_0.png" src="https://personalpages.manchester.ac.uk/staff/thomas.house/output_3_0.png"&gt;
&lt;div class="code"&gt;&lt;pre class="code ipython3"&gt;&lt;a id="rest_code_a676d237e9c8464d88906f5cf10f4924-1" name="rest_code_a676d237e9c8464d88906f5cf10f4924-1" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_a676d237e9c8464d88906f5cf10f4924-1"&gt;&lt;/a&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_a676d237e9c8464d88906f5cf10f4924-2" name="rest_code_a676d237e9c8464d88906f5cf10f4924-2" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_a676d237e9c8464d88906f5cf10f4924-2"&gt;&lt;/a&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_a676d237e9c8464d88906f5cf10f4924-3" name="rest_code_a676d237e9c8464d88906f5cf10f4924-3" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_a676d237e9c8464d88906f5cf10f4924-3"&gt;&lt;/a&gt;&lt;span class="n"&gt;z&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_a676d237e9c8464d88906f5cf10f4924-4" name="rest_code_a676d237e9c8464d88906f5cf10f4924-4" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_a676d237e9c8464d88906f5cf10f4924-4"&gt;&lt;/a&gt;&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_a676d237e9c8464d88906f5cf10f4924-5" name="rest_code_a676d237e9c8464d88906f5cf10f4924-5" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_a676d237e9c8464d88906f5cf10f4924-5"&gt;&lt;/a&gt;    &lt;span class="n"&gt;M&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;st&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;wishart&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;rvs&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;scale&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;Sig1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;size&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_a676d237e9c8464d88906f5cf10f4924-6" name="rest_code_a676d237e9c8464d88906f5cf10f4924-6" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_a676d237e9c8464d88906f5cf10f4924-6"&gt;&lt;/a&gt;    &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;M&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_a676d237e9c8464d88906f5cf10f4924-7" name="rest_code_a676d237e9c8464d88906f5cf10f4924-7" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_a676d237e9c8464d88906f5cf10f4924-7"&gt;&lt;/a&gt;    &lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;M&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_a676d237e9c8464d88906f5cf10f4924-8" name="rest_code_a676d237e9c8464d88906f5cf10f4924-8" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_a676d237e9c8464d88906f5cf10f4924-8"&gt;&lt;/a&gt;    &lt;span class="n"&gt;z&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;M&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_a676d237e9c8464d88906f5cf10f4924-9" name="rest_code_a676d237e9c8464d88906f5cf10f4924-9" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_a676d237e9c8464d88906f5cf10f4924-9"&gt;&lt;/a&gt;&lt;span class="n"&gt;fig&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;figure&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;figsize&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;8&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_a676d237e9c8464d88906f5cf10f4924-10" name="rest_code_a676d237e9c8464d88906f5cf10f4924-10" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_a676d237e9c8464d88906f5cf10f4924-10"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;fig&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;add_subplot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;111&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;projection&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'3d'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_a676d237e9c8464d88906f5cf10f4924-11" name="rest_code_a676d237e9c8464d88906f5cf10f4924-11" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_a676d237e9c8464d88906f5cf10f4924-11"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;scatter3D&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;z&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;marker&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'o'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;c&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;z&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;cmap&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'seismic'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_a676d237e9c8464d88906f5cf10f4924-12" name="rest_code_a676d237e9c8464d88906f5cf10f4924-12" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_a676d237e9c8464d88906f5cf10f4924-12"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_xlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'V11'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_a676d237e9c8464d88906f5cf10f4924-13" name="rest_code_a676d237e9c8464d88906f5cf10f4924-13" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_a676d237e9c8464d88906f5cf10f4924-13"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_ylabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'V22'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_a676d237e9c8464d88906f5cf10f4924-14" name="rest_code_a676d237e9c8464d88906f5cf10f4924-14" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_a676d237e9c8464d88906f5cf10f4924-14"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_zlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'V12=V21'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_a676d237e9c8464d88906f5cf10f4924-15" name="rest_code_a676d237e9c8464d88906f5cf10f4924-15" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_a676d237e9c8464d88906f5cf10f4924-15"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_xlim&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;30&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_a676d237e9c8464d88906f5cf10f4924-16" name="rest_code_a676d237e9c8464d88906f5cf10f4924-16" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_a676d237e9c8464d88906f5cf10f4924-16"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_ylim&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;70&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_a676d237e9c8464d88906f5cf10f4924-17" name="rest_code_a676d237e9c8464d88906f5cf10f4924-17" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_a676d237e9c8464d88906f5cf10f4924-17"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_zlim&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;30&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_a676d237e9c8464d88906f5cf10f4924-18" name="rest_code_a676d237e9c8464d88906f5cf10f4924-18" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_a676d237e9c8464d88906f5cf10f4924-18"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;tight_layout&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;img alt="../output_4_0.png" src="https://personalpages.manchester.ac.uk/staff/thomas.house/output_4_0.png"&gt;
&lt;div class="code"&gt;&lt;pre class="code ipython3"&gt;&lt;a id="rest_code_76116a44a2574bca8e27ed73d13dd183-1" name="rest_code_76116a44a2574bca8e27ed73d13dd183-1" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_76116a44a2574bca8e27ed73d13dd183-1"&gt;&lt;/a&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_76116a44a2574bca8e27ed73d13dd183-2" name="rest_code_76116a44a2574bca8e27ed73d13dd183-2" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_76116a44a2574bca8e27ed73d13dd183-2"&gt;&lt;/a&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_76116a44a2574bca8e27ed73d13dd183-3" name="rest_code_76116a44a2574bca8e27ed73d13dd183-3" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_76116a44a2574bca8e27ed73d13dd183-3"&gt;&lt;/a&gt;&lt;span class="n"&gt;z&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_76116a44a2574bca8e27ed73d13dd183-4" name="rest_code_76116a44a2574bca8e27ed73d13dd183-4" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_76116a44a2574bca8e27ed73d13dd183-4"&gt;&lt;/a&gt;&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_76116a44a2574bca8e27ed73d13dd183-5" name="rest_code_76116a44a2574bca8e27ed73d13dd183-5" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_76116a44a2574bca8e27ed73d13dd183-5"&gt;&lt;/a&gt;    &lt;span class="n"&gt;M&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;st&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;wishart&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;rvs&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;scale&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;Sig1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;size&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_76116a44a2574bca8e27ed73d13dd183-6" name="rest_code_76116a44a2574bca8e27ed73d13dd183-6" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_76116a44a2574bca8e27ed73d13dd183-6"&gt;&lt;/a&gt;    &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;M&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_76116a44a2574bca8e27ed73d13dd183-7" name="rest_code_76116a44a2574bca8e27ed73d13dd183-7" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_76116a44a2574bca8e27ed73d13dd183-7"&gt;&lt;/a&gt;    &lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;M&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_76116a44a2574bca8e27ed73d13dd183-8" name="rest_code_76116a44a2574bca8e27ed73d13dd183-8" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_76116a44a2574bca8e27ed73d13dd183-8"&gt;&lt;/a&gt;    &lt;span class="n"&gt;z&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;M&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_76116a44a2574bca8e27ed73d13dd183-9" name="rest_code_76116a44a2574bca8e27ed73d13dd183-9" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_76116a44a2574bca8e27ed73d13dd183-9"&gt;&lt;/a&gt;&lt;span class="n"&gt;fig&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;figure&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;figsize&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;8&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_76116a44a2574bca8e27ed73d13dd183-10" name="rest_code_76116a44a2574bca8e27ed73d13dd183-10" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_76116a44a2574bca8e27ed73d13dd183-10"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;fig&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;add_subplot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;111&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;projection&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'3d'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_76116a44a2574bca8e27ed73d13dd183-11" name="rest_code_76116a44a2574bca8e27ed73d13dd183-11" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_76116a44a2574bca8e27ed73d13dd183-11"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;scatter3D&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;z&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;marker&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'o'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;c&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;z&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;cmap&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'seismic'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_76116a44a2574bca8e27ed73d13dd183-12" name="rest_code_76116a44a2574bca8e27ed73d13dd183-12" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_76116a44a2574bca8e27ed73d13dd183-12"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_xlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'V11'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_76116a44a2574bca8e27ed73d13dd183-13" name="rest_code_76116a44a2574bca8e27ed73d13dd183-13" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_76116a44a2574bca8e27ed73d13dd183-13"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_ylabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'V22'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_76116a44a2574bca8e27ed73d13dd183-14" name="rest_code_76116a44a2574bca8e27ed73d13dd183-14" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_76116a44a2574bca8e27ed73d13dd183-14"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_zlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'V12=V21'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_76116a44a2574bca8e27ed73d13dd183-15" name="rest_code_76116a44a2574bca8e27ed73d13dd183-15" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_76116a44a2574bca8e27ed73d13dd183-15"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_xlim&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;30&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_76116a44a2574bca8e27ed73d13dd183-16" name="rest_code_76116a44a2574bca8e27ed73d13dd183-16" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_76116a44a2574bca8e27ed73d13dd183-16"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_ylim&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;70&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_76116a44a2574bca8e27ed73d13dd183-17" name="rest_code_76116a44a2574bca8e27ed73d13dd183-17" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_76116a44a2574bca8e27ed73d13dd183-17"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_zlim&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;30&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_76116a44a2574bca8e27ed73d13dd183-18" name="rest_code_76116a44a2574bca8e27ed73d13dd183-18" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_76116a44a2574bca8e27ed73d13dd183-18"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;tight_layout&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;img alt="../output_5_0.png" src="https://personalpages.manchester.ac.uk/staff/thomas.house/output_5_0.png"&gt;&lt;/body&gt;&lt;/html&gt;

&lt;img alt="../output_3_0.png" src="https://personalpages.manchester.ac.uk/staff/thomas.house/output_3_0.png"&gt;
&lt;div class="code"&gt;&lt;pre class="code ipython3"&gt;&lt;a id="rest_code_a676d237e9c8464d88906f5cf10f4924-1" name="rest_code_a676d237e9c8464d88906f5cf10f4924-1" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_a676d237e9c8464d88906f5cf10f4924-1"&gt;&lt;/a&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_a676d237e9c8464d88906f5cf10f4924-2" name="rest_code_a676d237e9c8464d88906f5cf10f4924-2" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_a676d237e9c8464d88906f5cf10f4924-2"&gt;&lt;/a&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_a676d237e9c8464d88906f5cf10f4924-3" name="rest_code_a676d237e9c8464d88906f5cf10f4924-3" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_a676d237e9c8464d88906f5cf10f4924-3"&gt;&lt;/a&gt;&lt;span class="n"&gt;z&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_a676d237e9c8464d88906f5cf10f4924-4" name="rest_code_a676d237e9c8464d88906f5cf10f4924-4" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_a676d237e9c8464d88906f5cf10f4924-4"&gt;&lt;/a&gt;&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_a676d237e9c8464d88906f5cf10f4924-5" name="rest_code_a676d237e9c8464d88906f5cf10f4924-5" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_a676d237e9c8464d88906f5cf10f4924-5"&gt;&lt;/a&gt;    &lt;span class="n"&gt;M&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;st&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;wishart&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;rvs&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;scale&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;Sig1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;size&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_a676d237e9c8464d88906f5cf10f4924-6" name="rest_code_a676d237e9c8464d88906f5cf10f4924-6" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_a676d237e9c8464d88906f5cf10f4924-6"&gt;&lt;/a&gt;    &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;M&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_a676d237e9c8464d88906f5cf10f4924-7" name="rest_code_a676d237e9c8464d88906f5cf10f4924-7" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_a676d237e9c8464d88906f5cf10f4924-7"&gt;&lt;/a&gt;    &lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;M&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_a676d237e9c8464d88906f5cf10f4924-8" name="rest_code_a676d237e9c8464d88906f5cf10f4924-8" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_a676d237e9c8464d88906f5cf10f4924-8"&gt;&lt;/a&gt;    &lt;span class="n"&gt;z&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;M&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_a676d237e9c8464d88906f5cf10f4924-9" name="rest_code_a676d237e9c8464d88906f5cf10f4924-9" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_a676d237e9c8464d88906f5cf10f4924-9"&gt;&lt;/a&gt;&lt;span class="n"&gt;fig&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;figure&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;figsize&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;8&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_a676d237e9c8464d88906f5cf10f4924-10" name="rest_code_a676d237e9c8464d88906f5cf10f4924-10" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_a676d237e9c8464d88906f5cf10f4924-10"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;fig&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;add_subplot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;111&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;projection&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'3d'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_a676d237e9c8464d88906f5cf10f4924-11" name="rest_code_a676d237e9c8464d88906f5cf10f4924-11" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_a676d237e9c8464d88906f5cf10f4924-11"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;scatter3D&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;z&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;marker&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'o'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;c&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;z&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;cmap&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'seismic'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_a676d237e9c8464d88906f5cf10f4924-12" name="rest_code_a676d237e9c8464d88906f5cf10f4924-12" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_a676d237e9c8464d88906f5cf10f4924-12"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_xlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'V11'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_a676d237e9c8464d88906f5cf10f4924-13" name="rest_code_a676d237e9c8464d88906f5cf10f4924-13" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_a676d237e9c8464d88906f5cf10f4924-13"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_ylabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'V22'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_a676d237e9c8464d88906f5cf10f4924-14" name="rest_code_a676d237e9c8464d88906f5cf10f4924-14" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_a676d237e9c8464d88906f5cf10f4924-14"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_zlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'V12=V21'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_a676d237e9c8464d88906f5cf10f4924-15" name="rest_code_a676d237e9c8464d88906f5cf10f4924-15" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_a676d237e9c8464d88906f5cf10f4924-15"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_xlim&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;30&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_a676d237e9c8464d88906f5cf10f4924-16" name="rest_code_a676d237e9c8464d88906f5cf10f4924-16" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_a676d237e9c8464d88906f5cf10f4924-16"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_ylim&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;70&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_a676d237e9c8464d88906f5cf10f4924-17" name="rest_code_a676d237e9c8464d88906f5cf10f4924-17" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_a676d237e9c8464d88906f5cf10f4924-17"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_zlim&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;30&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_a676d237e9c8464d88906f5cf10f4924-18" name="rest_code_a676d237e9c8464d88906f5cf10f4924-18" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_a676d237e9c8464d88906f5cf10f4924-18"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;tight_layout&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;img alt="../output_4_0.png" src="https://personalpages.manchester.ac.uk/staff/thomas.house/output_4_0.png"&gt;
&lt;div class="code"&gt;&lt;pre class="code ipython3"&gt;&lt;a id="rest_code_76116a44a2574bca8e27ed73d13dd183-1" name="rest_code_76116a44a2574bca8e27ed73d13dd183-1" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_76116a44a2574bca8e27ed73d13dd183-1"&gt;&lt;/a&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_76116a44a2574bca8e27ed73d13dd183-2" name="rest_code_76116a44a2574bca8e27ed73d13dd183-2" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_76116a44a2574bca8e27ed73d13dd183-2"&gt;&lt;/a&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_76116a44a2574bca8e27ed73d13dd183-3" name="rest_code_76116a44a2574bca8e27ed73d13dd183-3" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_76116a44a2574bca8e27ed73d13dd183-3"&gt;&lt;/a&gt;&lt;span class="n"&gt;z&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_76116a44a2574bca8e27ed73d13dd183-4" name="rest_code_76116a44a2574bca8e27ed73d13dd183-4" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_76116a44a2574bca8e27ed73d13dd183-4"&gt;&lt;/a&gt;&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_76116a44a2574bca8e27ed73d13dd183-5" name="rest_code_76116a44a2574bca8e27ed73d13dd183-5" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_76116a44a2574bca8e27ed73d13dd183-5"&gt;&lt;/a&gt;    &lt;span class="n"&gt;M&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;st&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;wishart&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;rvs&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;scale&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;Sig1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;size&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_76116a44a2574bca8e27ed73d13dd183-6" name="rest_code_76116a44a2574bca8e27ed73d13dd183-6" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_76116a44a2574bca8e27ed73d13dd183-6"&gt;&lt;/a&gt;    &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;M&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_76116a44a2574bca8e27ed73d13dd183-7" name="rest_code_76116a44a2574bca8e27ed73d13dd183-7" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_76116a44a2574bca8e27ed73d13dd183-7"&gt;&lt;/a&gt;    &lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;M&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_76116a44a2574bca8e27ed73d13dd183-8" name="rest_code_76116a44a2574bca8e27ed73d13dd183-8" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_76116a44a2574bca8e27ed73d13dd183-8"&gt;&lt;/a&gt;    &lt;span class="n"&gt;z&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;M&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_76116a44a2574bca8e27ed73d13dd183-9" name="rest_code_76116a44a2574bca8e27ed73d13dd183-9" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_76116a44a2574bca8e27ed73d13dd183-9"&gt;&lt;/a&gt;&lt;span class="n"&gt;fig&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;figure&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;figsize&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;8&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_76116a44a2574bca8e27ed73d13dd183-10" name="rest_code_76116a44a2574bca8e27ed73d13dd183-10" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_76116a44a2574bca8e27ed73d13dd183-10"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;fig&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;add_subplot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;111&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;projection&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'3d'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_76116a44a2574bca8e27ed73d13dd183-11" name="rest_code_76116a44a2574bca8e27ed73d13dd183-11" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_76116a44a2574bca8e27ed73d13dd183-11"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;scatter3D&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;z&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;marker&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'o'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;c&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;z&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;cmap&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'seismic'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_76116a44a2574bca8e27ed73d13dd183-12" name="rest_code_76116a44a2574bca8e27ed73d13dd183-12" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_76116a44a2574bca8e27ed73d13dd183-12"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_xlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'V11'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_76116a44a2574bca8e27ed73d13dd183-13" name="rest_code_76116a44a2574bca8e27ed73d13dd183-13" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_76116a44a2574bca8e27ed73d13dd183-13"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_ylabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'V22'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_76116a44a2574bca8e27ed73d13dd183-14" name="rest_code_76116a44a2574bca8e27ed73d13dd183-14" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_76116a44a2574bca8e27ed73d13dd183-14"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_zlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'V12=V21'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_76116a44a2574bca8e27ed73d13dd183-15" name="rest_code_76116a44a2574bca8e27ed73d13dd183-15" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_76116a44a2574bca8e27ed73d13dd183-15"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_xlim&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;30&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_76116a44a2574bca8e27ed73d13dd183-16" name="rest_code_76116a44a2574bca8e27ed73d13dd183-16" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_76116a44a2574bca8e27ed73d13dd183-16"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_ylim&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;70&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_76116a44a2574bca8e27ed73d13dd183-17" name="rest_code_76116a44a2574bca8e27ed73d13dd183-17" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_76116a44a2574bca8e27ed73d13dd183-17"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_zlim&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;30&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_76116a44a2574bca8e27ed73d13dd183-18" name="rest_code_76116a44a2574bca8e27ed73d13dd183-18" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_76116a44a2574bca8e27ed73d13dd183-18"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;tight_layout&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;img alt="../output_5_0.png" src="https://personalpages.manchester.ac.uk/staff/thomas.house/output_5_0.png"&gt;&lt;/body&gt;&lt;/html&gt;

&lt;img alt="../output_4_0.png" src="https://personalpages.manchester.ac.uk/staff/thomas.house/output_4_0.png"&gt;
&lt;div class="code"&gt;&lt;pre class="code ipython3"&gt;&lt;a id="rest_code_76116a44a2574bca8e27ed73d13dd183-1" name="rest_code_76116a44a2574bca8e27ed73d13dd183-1" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_76116a44a2574bca8e27ed73d13dd183-1"&gt;&lt;/a&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_76116a44a2574bca8e27ed73d13dd183-2" name="rest_code_76116a44a2574bca8e27ed73d13dd183-2" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_76116a44a2574bca8e27ed73d13dd183-2"&gt;&lt;/a&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_76116a44a2574bca8e27ed73d13dd183-3" name="rest_code_76116a44a2574bca8e27ed73d13dd183-3" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_76116a44a2574bca8e27ed73d13dd183-3"&gt;&lt;/a&gt;&lt;span class="n"&gt;z&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_76116a44a2574bca8e27ed73d13dd183-4" name="rest_code_76116a44a2574bca8e27ed73d13dd183-4" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_76116a44a2574bca8e27ed73d13dd183-4"&gt;&lt;/a&gt;&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_76116a44a2574bca8e27ed73d13dd183-5" name="rest_code_76116a44a2574bca8e27ed73d13dd183-5" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_76116a44a2574bca8e27ed73d13dd183-5"&gt;&lt;/a&gt;    &lt;span class="n"&gt;M&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;st&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;wishart&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;rvs&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;scale&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;Sig1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;size&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_76116a44a2574bca8e27ed73d13dd183-6" name="rest_code_76116a44a2574bca8e27ed73d13dd183-6" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_76116a44a2574bca8e27ed73d13dd183-6"&gt;&lt;/a&gt;    &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;M&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_76116a44a2574bca8e27ed73d13dd183-7" name="rest_code_76116a44a2574bca8e27ed73d13dd183-7" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_76116a44a2574bca8e27ed73d13dd183-7"&gt;&lt;/a&gt;    &lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;M&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_76116a44a2574bca8e27ed73d13dd183-8" name="rest_code_76116a44a2574bca8e27ed73d13dd183-8" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_76116a44a2574bca8e27ed73d13dd183-8"&gt;&lt;/a&gt;    &lt;span class="n"&gt;z&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;M&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_76116a44a2574bca8e27ed73d13dd183-9" name="rest_code_76116a44a2574bca8e27ed73d13dd183-9" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_76116a44a2574bca8e27ed73d13dd183-9"&gt;&lt;/a&gt;&lt;span class="n"&gt;fig&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;figure&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;figsize&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;8&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_76116a44a2574bca8e27ed73d13dd183-10" name="rest_code_76116a44a2574bca8e27ed73d13dd183-10" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_76116a44a2574bca8e27ed73d13dd183-10"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;fig&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;add_subplot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;111&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;projection&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'3d'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_76116a44a2574bca8e27ed73d13dd183-11" name="rest_code_76116a44a2574bca8e27ed73d13dd183-11" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_76116a44a2574bca8e27ed73d13dd183-11"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;scatter3D&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;z&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;marker&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'o'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;c&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;z&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;cmap&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'seismic'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_76116a44a2574bca8e27ed73d13dd183-12" name="rest_code_76116a44a2574bca8e27ed73d13dd183-12" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_76116a44a2574bca8e27ed73d13dd183-12"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_xlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'V11'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_76116a44a2574bca8e27ed73d13dd183-13" name="rest_code_76116a44a2574bca8e27ed73d13dd183-13" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_76116a44a2574bca8e27ed73d13dd183-13"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_ylabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'V22'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_76116a44a2574bca8e27ed73d13dd183-14" name="rest_code_76116a44a2574bca8e27ed73d13dd183-14" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_76116a44a2574bca8e27ed73d13dd183-14"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_zlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'V12=V21'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_76116a44a2574bca8e27ed73d13dd183-15" name="rest_code_76116a44a2574bca8e27ed73d13dd183-15" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_76116a44a2574bca8e27ed73d13dd183-15"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_xlim&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;30&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_76116a44a2574bca8e27ed73d13dd183-16" name="rest_code_76116a44a2574bca8e27ed73d13dd183-16" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_76116a44a2574bca8e27ed73d13dd183-16"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_ylim&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;70&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_76116a44a2574bca8e27ed73d13dd183-17" name="rest_code_76116a44a2574bca8e27ed73d13dd183-17" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_76116a44a2574bca8e27ed73d13dd183-17"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_zlim&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;30&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_76116a44a2574bca8e27ed73d13dd183-18" name="rest_code_76116a44a2574bca8e27ed73d13dd183-18" href="https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html#rest_code_76116a44a2574bca8e27ed73d13dd183-18"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;tight_layout&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;img alt="../output_5_0.png" src="https://personalpages.manchester.ac.uk/staff/thomas.house/output_5_0.png"&gt;&lt;/body&gt;&lt;/html&gt;

&lt;img alt="../output_5_0.png" src="https://personalpages.manchester.ac.uk/staff/thomas.house/output_5_0.png"&gt;</description><guid>https://personalpages.manchester.ac.uk/staff/thomas.house/posts/visualising-the-wishart-distribution.html</guid><pubDate>Fri, 08 Dec 2017 12:08:22 GMT</pubDate></item><item><title>Mathematics of Memes</title><link>https://personalpages.manchester.ac.uk/staff/thomas.house/posts/mathematics-of-memes.html</link><dc:creator>Thomas House</dc:creator><description>&lt;p&gt;Models of epidemics can be adapted to consider the spread of internet Memes - for more information see
the University &lt;a class="reference external" href="http://www.manchester.ac.uk/discover/news/the-maths-behind-memes-why-numbers-could-help-us-predict-an-internet-sensation/"&gt;Press Release&lt;/a&gt;.
Below is a figure showing some of these Memes 'in the wild'! We hope that the work will be possible to extend
to more substantial health-related behaviours, but Memes provide a relatively pure signal of the kind
of social influence that must be accounted for in such contexts, and as such are a good way to develop methods.&lt;/p&gt;
&lt;figure style="width: 480px"&gt;
&lt;img alt="Memes considered in the paper" src="https://personalpages.manchester.ac.uk/staff/thomas.house/fig1.png"&gt;
&lt;/figure&gt;
&lt;p&gt;I also recently gave a talk at the local Galois Group (undergraduate mathematics) on the work:&lt;/p&gt;
&lt;p&gt;&lt;span class="raw-html"&gt;&lt;iframe src="//www.slideshare.net/slideshow/embed_code/key/oXVVGDFwrTNyQv" width="595" height="485" frameborder="0" marginwidth="0" marginheight="0" scrolling="no" style="border:1px solid #CCC; border-width:1px; margin-bottom:5px; max-width: 100%;" allowfullscreen&gt; &lt;/iframe&gt; &lt;div style="margin-bottom:5px"&gt; &lt;strong&gt; &lt;a href="//www.slideshare.net/secret/oXVVGDFwrTNyQv" title="The Mathematics of Memes" target="_blank"&gt;The Mathematics of Memes&lt;/a&gt; &lt;/strong&gt; from &lt;strong&gt;&lt;a href="https://www.slideshare.net/ThomasHouse5" target="_blank"&gt;Thomas House&lt;/a&gt;&lt;/strong&gt; &lt;/div&gt;&lt;/span&gt;&lt;/p&gt;&lt;/body&gt;&lt;/html&gt;

&lt;figure style="width: 480px"&gt;
&lt;img alt="Memes considered in the paper" src="https://personalpages.manchester.ac.uk/staff/thomas.house/fig1.png"&gt;
&lt;/figure&gt;
&lt;p&gt;I also recently gave a talk at the local Galois Group (undergraduate mathematics) on the work:&lt;/p&gt;
&lt;p&gt;&lt;span class="raw-html"&gt;&lt;iframe src="//www.slideshare.net/slideshow/embed_code/key/oXVVGDFwrTNyQv" width="595" height="485" frameborder="0" marginwidth="0" marginheight="0" scrolling="no" style="border:1px solid #CCC; border-width:1px; margin-bottom:5px; max-width: 100%;" allowfullscreen&gt; &lt;/iframe&gt; &lt;div style="margin-bottom:5px"&gt; &lt;strong&gt; &lt;a href="//www.slideshare.net/secret/oXVVGDFwrTNyQv" title="The Mathematics of Memes" target="_blank"&gt;The Mathematics of Memes&lt;/a&gt; &lt;/strong&gt; from &lt;strong&gt;&lt;a href="https://www.slideshare.net/ThomasHouse5" target="_blank"&gt;Thomas House&lt;/a&gt;&lt;/strong&gt; &lt;/div&gt;&lt;/span&gt;&lt;/p&gt;&lt;/body&gt;&lt;/html&gt;

&lt;p&gt;I also recently gave a talk at the local Galois Group (undergraduate mathematics) on the work:&lt;/p&gt;
&lt;p&gt;&lt;span class="raw-html"&gt;&lt;iframe src="//www.slideshare.net/slideshow/embed_code/key/oXVVGDFwrTNyQv" width="595" height="485" frameborder="0" marginwidth="0" marginheight="0" scrolling="no" style="border:1px solid #CCC; border-width:1px; margin-bottom:5px; max-width: 100%;" allowfullscreen&gt; &lt;/iframe&gt; &lt;div style="margin-bottom:5px"&gt; &lt;strong&gt; &lt;a href="//www.slideshare.net/secret/oXVVGDFwrTNyQv" title="The Mathematics of Memes" target="_blank"&gt;The Mathematics of Memes&lt;/a&gt; &lt;/strong&gt; from &lt;strong&gt;&lt;a href="https://www.slideshare.net/ThomasHouse5" target="_blank"&gt;Thomas House&lt;/a&gt;&lt;/strong&gt; &lt;/div&gt;&lt;/span&gt;&lt;/p&gt;&lt;/body&gt;&lt;/html&gt;

&lt;p&gt;&lt;span class="raw-html"&gt;&lt;iframe src="//www.slideshare.net/slideshow/embed_code/key/oXVVGDFwrTNyQv" width="595" height="485" frameborder="0" marginwidth="0" marginheight="0" scrolling="no" style="border:1px solid #CCC; border-width:1px; margin-bottom:5px; max-width: 100%;" allowfullscreen&gt; &lt;/iframe&gt; &lt;div style="margin-bottom:5px"&gt; &lt;strong&gt; &lt;a href="//www.slideshare.net/secret/oXVVGDFwrTNyQv" title="The Mathematics of Memes" target="_blank"&gt;The Mathematics of Memes&lt;/a&gt; &lt;/strong&gt; from &lt;strong&gt;&lt;a href="https://www.slideshare.net/ThomasHouse5" target="_blank"&gt;Thomas House&lt;/a&gt;&lt;/strong&gt; &lt;/div&gt;&lt;/span&gt;&lt;/p&gt;&lt;/body&gt;&lt;/html&gt;
</description><guid>https://personalpages.manchester.ac.uk/staff/thomas.house/posts/mathematics-of-memes.html</guid><pubDate>Wed, 20 Sep 2017 12:38:56 GMT</pubDate></item><item><title>Operationalising Modern Mathematical Epidemiology</title><link>https://personalpages.manchester.ac.uk/staff/thomas.house/posts/operationalising-modern-mathematical-epidemiology.html</link><dc:creator>Thomas House</dc:creator><description>&lt;p&gt;This month Liz Buckingham-Jeffery is joining me and Tim Kinyanjui to complete
the team for the EPSRC-funded project &lt;em&gt;Operationalising Modern Mathematical
Epidemiology&lt;/em&gt;, which is a Healthcare Technologies Impact Fellowship I hold
(picture of us all below). The project is about development of some recent
ideas at developed by mathematical scientists to generate benefits in the
healthcare system.  We have non-academic partners from three major Manchester
hospitals (Central Manchester, North Manchester and the Christie), Public
Health England's national Real-time Syndromic Surveillance group, and a data
analytics firm Spectra Analytics. The first papers from this project are
starting be be submitted, and we have an ambitious programme of research and
impact-related activity over the next couple of years to ensure that the
potential benefits to population health from theoretical developments are
realised.&lt;/p&gt;
&lt;img alt="Me, Liz and Tim" src="https://personalpages.manchester.ac.uk/staff/thomas.house/th_ebj_tmk.jpg" style="width: 600px;"&gt;&lt;/body&gt;&lt;/html&gt;

&lt;img alt="Me, Liz and Tim" src="https://personalpages.manchester.ac.uk/staff/thomas.house/th_ebj_tmk.jpg" style="width: 600px;"&gt;</description><guid>https://personalpages.manchester.ac.uk/staff/thomas.house/posts/operationalising-modern-mathematical-epidemiology.html</guid><pubDate>Wed, 08 Mar 2017 10:36:43 GMT</pubDate></item><item><title>IDM journal</title><link>https://personalpages.manchester.ac.uk/staff/thomas.house/posts/idm-journal.html</link><dc:creator>Thomas House</dc:creator><description>&lt;a class="reference external image-reference" href="http://keaipublishing.com/IDM/"&gt;&lt;img alt="Journal flyer" src="https://personalpages.manchester.ac.uk/staff/thomas.house/IDM.png" style="width: 240px;"&gt;&lt;/a&gt;
&lt;p&gt;International cooperation is a good thing in science; so it's nice to be able
to announce a new journal &lt;a class="reference external" href="http://keaipublishing.com/IDM/"&gt;Infectious Disease Modelling&lt;/a&gt;, which I'm helping to edit.&lt;/p&gt;&lt;/body&gt;&lt;/html&gt;

&lt;p&gt;International cooperation is a good thing in science; so it's nice to be able
to announce a new journal &lt;a class="reference external" href="http://keaipublishing.com/IDM/"&gt;Infectious Disease Modelling&lt;/a&gt;, which I'm helping to edit.&lt;/p&gt;&lt;/body&gt;&lt;/html&gt;
</description><guid>https://personalpages.manchester.ac.uk/staff/thomas.house/posts/idm-journal.html</guid><pubDate>Fri, 20 Jan 2017 16:04:18 GMT</pubDate></item></channel></rss>